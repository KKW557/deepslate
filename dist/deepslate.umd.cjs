(function(u,Rt){typeof exports=="object"&&typeof module<"u"?Rt(exports):typeof define=="function"&&define.amd?define(["exports"],Rt):(u=typeof globalThis<"u"?globalThis:u||self,Rt(u.deepslate={}))})(this,function(u){"use strict";var Mu=Object.defineProperty;var Ru=(u,Rt,Ee)=>Rt in u?Mu(u,Rt,{enumerable:!0,configurable:!0,writable:!0,value:Ee}):u[Rt]=Ee;var _=(u,Rt,Ee)=>(Ru(u,typeof Rt!="symbol"?Rt+"":Rt,Ee),Ee);function Rt(n){var t=n.slice(0,2);return t.length===2&&t[0]===31&&t[1]===139}function Ee(n){const t=n.slice(0,2);return t.length===2&&t[0]===120&&(t[1]===1||t[1]===94||t[1]===156||t[2]===218)}function ia(n){const t=n.slice(0,8),e=new DataView(t.buffer,t.byteOffset),r=e.getUint32(0,!0),i=e.getUint32(4,!0);if(t.length===8&&r>0&&r<100&&i===n.byteLength-8)return r}function sa(n){var t=[],e,r;for(e=0;e<n.length;e++)r=n.charCodeAt(e),r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|r&63)):r<65536?(t.push(224|r>>12),t.push(128|r>>6&63),t.push(128|r&63)):(t.push(240|r>>18&7),t.push(128|r>>12&63),t.push(128|r>>6&63),t.push(128|r&63));return t}function aa(n){var t=[],e;for(e=0;e<n.length;e++)(n[e]&128)===0?t.push(n[e]&127):e+1<n.length&&(n[e]&224)===192&&(n[e+1]&192)===128?t.push((n[e]&31)<<6|n[e+1]&63):e+2<n.length&&(n[e]&240)===224&&(n[e+1]&192)===128&&(n[e+2]&192)===128?t.push((n[e]&15)<<12|(n[e+1]&63)<<6|n[e+2]&63):e+3<n.length&&(n[e]&248)===240&&(n[e+1]&192)===128&&(n[e+2]&192)===128&&(n[e+3]&192)===128&&t.push((n[e]&7)<<18|(n[e+1]&63)<<12|(n[e+2]&63)<<6|n[e+3]&63);return String.fromCharCode.apply(null,t)}class ui{constructor(t,e){_(this,"littleEndian");_(this,"offset");_(this,"array");_(this,"view");_(this,"readByte",this.readNumber.bind(this,"getInt8",1));_(this,"readShort",this.readNumber.bind(this,"getInt16",2));_(this,"readInt",this.readNumber.bind(this,"getInt32",4));_(this,"readFloat",this.readNumber.bind(this,"getFloat32",4));_(this,"readDouble",this.readNumber.bind(this,"getFloat64",8));var r,i;this.littleEndian=(r=e==null?void 0:e.littleEndian)!=null?r:!1,this.offset=(i=e==null?void 0:e.offset)!=null?i:0,this.array=t instanceof Uint8Array?t:new Uint8Array(t),this.view=new DataView(this.array.buffer,this.array.byteOffset)}readNumber(t,e){const r=this.view[t](this.offset,this.littleEndian);return this.offset+=e,r}readBytes(t){const e=this.array.slice(this.offset,this.offset+t);return this.offset+=t,e}readString(){const t=this.readShort(),e=this.readBytes(t);return aa(e)}}class hi{constructor(t){_(this,"littleEndian");_(this,"offset");_(this,"buffer");_(this,"array");_(this,"view");_(this,"writeByte",this.writeNumber.bind(this,"setInt8",1));_(this,"writeShort",this.writeNumber.bind(this,"setInt16",2));_(this,"writeInt",this.writeNumber.bind(this,"setInt32",4));_(this,"writeFloat",this.writeNumber.bind(this,"setFloat32",4));_(this,"writeDouble",this.writeNumber.bind(this,"setFloat64",8));var e,r,i;this.littleEndian=(e=t==null?void 0:t.littleEndian)!=null?e:!1,this.offset=(r=t==null?void 0:t.offset)!=null?r:0,this.buffer=new ArrayBuffer((i=t==null?void 0:t.initialSize)!=null?i:1024),this.array=new Uint8Array(this.buffer),this.view=new DataView(this.buffer)}accommodate(t){const e=this.offset+t;if(this.buffer.byteLength>=e)return;let r=this.buffer.byteLength;for(;r<e;)r*=2;const i=new ArrayBuffer(r),s=new Uint8Array(i);s.set(this.array),this.offset>this.buffer.byteLength&&s.fill(0,this.buffer.byteLength,this.offset),this.buffer=i,this.view=new DataView(i),this.array=s}writeNumber(t,e,r){this.accommodate(e),this.view[t](this.offset,r,this.littleEndian),this.offset+=e}writeBytes(t){this.accommodate(t.length),this.array.set(t,this.offset),this.offset+=t.length}writeString(t){const e=sa(t);this.writeShort(e.length),this.writeBytes(e)}getData(){return this.accommodate(0),this.array.slice(0,this.offset)}}u.Json=void 0,(n=>{function t(h){return typeof h=="number"?h:void 0}n.readNumber=t;function e(h){return typeof h=="number"?Math.floor(h):void 0}n.readInt=e;function r(h){return typeof h=="string"?h:void 0}n.readString=r;function i(h){return typeof h=="boolean"?h:void 0}n.readBoolean=i;function s(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)?h:void 0}n.readObject=s;function a(h,d){if(!!Array.isArray(h))return d?h.map(f=>d(f)):h}n.readArray=a;function o(h,d){if(!!Array.isArray(h))return[0,1].map(f=>d(h[f]))}n.readPair=o;function g(h,d){var w;const f=(w=s(h))!=null?w:{};return Object.fromEntries(Object.entries(f).map(([v,m])=>[v,d(m)]))}n.readMap=g;function c(h,d,f){const w=d(h);return w?f(w):void 0}n.compose=c;function l(h,d){return typeof h!="string"?d[0]:d.includes(h)?h:d[0]}n.readEnum=l})(u.Json||(u.Json={})),u.Color=void 0,(n=>{function t(i){const s=u.Json.readNumber(i);if(s)return r(s);const a=u.Json.readArray(i,o=>{var g;return(g=u.Json.readNumber(o))!=null?g:0});if(!(a===void 0||a.length!==3))return a}n.fromJson=t;function e(i){if(i.isNumber())return r(i.getAsNumber());if(!i.isListOrArray())return;const s=i.getItems();if(!(s.length<3))return s.map(a=>a.getAsNumber())}n.fromNbt=e;function r(i){const s=i>>16&255,a=i>>8&255,o=i&255;return[s/255,a/255,o/255]}n.intToRgb=r})(u.Color||(u.Color={}));class It{constructor(t){_(this,"source");_(this,"cursor");this.source=t,this.cursor=0}get remainingLength(){return this.source.length-this.cursor}get totalLength(){return this.source.length}getRead(t=0){return this.source.substring(t,this.cursor)}getRemaining(){return this.source.substring(this.cursor)}canRead(t=1){return this.cursor+t<=this.source.length}peek(t=0){return this.source.charAt(this.cursor+t)}read(){return this.source.charAt(this.cursor++)}skip(){this.cursor+=1}skipWhitespace(){for(;this.canRead()&&It.isWhitespace(this.peek());)this.skip()}expect(t,e=!1){if(e&&this.skipWhitespace(),!this.canRead()||this.peek()!==t)throw this.createError(`Expected '${t}'`);this.skip()}readInt(){const t=this.cursor;for(;this.canRead()&&It.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(e.length===0)throw this.createError("Expected integer");try{const r=Number(e);if(isNaN(r)||!Number.isInteger(r))throw new Error;return r}catch{throw this.cursor=t,this.createError(`Invalid integer '${e}'`)}}readFloat(){const t=this.cursor;for(;this.canRead()&&It.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(e.length===0)throw this.createError("Expected float");try{const r=Number(e);if(isNaN(r))throw new Error;return r}catch{throw this.cursor=t,this.createError(`Invalid float '${e}'`)}}readUnquotedString(){const t=this.cursor;for(;this.canRead()&&It.isAllowedInUnquotedString(this.peek());)this.skip();return this.getRead(t)}readQuotedString(){if(!this.canRead())return"";const t=this.peek();if(!It.isQuotedStringStart(t))throw this.createError("Expected quote to start a string");return this.skip(),this.readStringUntil(t)}readString(){if(!this.canRead())return"";const t=this.peek();return It.isQuotedStringStart(t)?(this.skip(),this.readStringUntil(t)):this.readUnquotedString()}readStringUntil(t){const e=[];let r=!1;for(;this.canRead();){const i=this.read();if(r)if(i===t||i==="\\")e.push(i),r=!1;else throw this.cursor-=1,this.createError(`Invalid escape sequence '${i}' in quoted string`);else if(i==="\\")r=!0;else{if(i===t)return e.join("");e.push(i)}}throw this.createError("Unclosed quoted string")}readBoolean(){const t=this.cursor,e=this.readUnquotedString();if(e.length===0)throw this.createError("Expected bool");if(e==="true")return!0;if(e==="false")return!1;throw this.cursor=t,this.createError(`Invalid bool, expected true or false but found '${e}'`)}static isAllowedInNumber(t){return t>="0"&&t<="9"||t==="."||t==="-"}static isAllowedInUnquotedString(t){return t>="0"&&t<="9"||t>="A"&&t<="Z"||t>="a"&&t<="z"||t==="_"||t==="-"||t==="."||t==="+"}static isQuotedStringStart(t){return t==="'"||t==='"'}static isWhitespace(t){return t===" "||t==="	"||t===`
`||t==="\r"}createError(t){const e=Math.min(this.source.length,this.cursor),r=(e>10?"...":"")+this.source.substring(Math.max(0,e-10),e);return new Error(`${t} at position ${this.cursor}: ${r}<--[HERE]`)}}function an(n){let t=null;return()=>(t==null&&(t=n()),t)}function Ie(n,t,e){const r=n.get(t);if(r!==void 0)return r;const i=e(t);return n.set(t,i),i}function vr(n,t,e,r){const i=n.get(t),s=i!=null?i:e;return r(s,t),n.set(t,s),s}/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const oa=4,fi=0,di=1,ca=2;function Ve(n){let t=n.length;for(;--t>=0;)n[t]=0}const la=0,gi=1,ua=2,ha=3,fa=258,_r=29,on=256,cn=on+1+_r,Ye=30,br=19,mi=2*cn+1,ke=15,yr=16,da=7,Sr=256,wi=16,pi=17,vi=18,Er=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),zn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ga=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),_i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ma=512,Kt=new Array((cn+2)*2);Ve(Kt);const ln=new Array(Ye*2);Ve(ln);const un=new Array(ma);Ve(un);const hn=new Array(fa-ha+1);Ve(hn);const Ir=new Array(_r);Ve(Ir);const Dn=new Array(Ye);Ve(Dn);function kr(n,t,e,r,i){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=r,this.max_length=i,this.has_stree=n&&n.length}let bi,yi,Si;function Ar(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}const Ei=n=>n<256?un[n]:un[256+(n>>>7)],fn=(n,t)=>{n.pending_buf[n.pending++]=t&255,n.pending_buf[n.pending++]=t>>>8&255},kt=(n,t,e)=>{n.bi_valid>yr-e?(n.bi_buf|=t<<n.bi_valid&65535,fn(n,n.bi_buf),n.bi_buf=t>>yr-n.bi_valid,n.bi_valid+=e-yr):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},Gt=(n,t,e)=>{kt(n,e[t*2],e[t*2+1])},Ii=(n,t)=>{let e=0;do e|=n&1,n>>>=1,e<<=1;while(--t>0);return e>>>1},wa=n=>{n.bi_valid===16?(fn(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)},pa=(n,t)=>{const e=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,g=t.stat_desc.max_length;let c,l,h,d,f,w,v=0;for(d=0;d<=ke;d++)n.bl_count[d]=0;for(e[n.heap[n.heap_max]*2+1]=0,c=n.heap_max+1;c<mi;c++)l=n.heap[c],d=e[e[l*2+1]*2+1]+1,d>g&&(d=g,v++),e[l*2+1]=d,!(l>r)&&(n.bl_count[d]++,f=0,l>=o&&(f=a[l-o]),w=e[l*2],n.opt_len+=w*(d+f),s&&(n.static_len+=w*(i[l*2+1]+f)));if(v!==0){do{for(d=g-1;n.bl_count[d]===0;)d--;n.bl_count[d]--,n.bl_count[d+1]+=2,n.bl_count[g]--,v-=2}while(v>0);for(d=g;d!==0;d--)for(l=n.bl_count[d];l!==0;)h=n.heap[--c],!(h>r)&&(e[h*2+1]!==d&&(n.opt_len+=(d-e[h*2+1])*e[h*2],e[h*2+1]=d),l--)}},ki=(n,t,e)=>{const r=new Array(ke+1);let i=0,s,a;for(s=1;s<=ke;s++)r[s]=i=i+e[s-1]<<1;for(a=0;a<=t;a++){let o=n[a*2+1];o!==0&&(n[a*2]=Ii(r[o]++,o))}},va=()=>{let n,t,e,r,i;const s=new Array(ke+1);for(e=0,r=0;r<_r-1;r++)for(Ir[r]=e,n=0;n<1<<Er[r];n++)hn[e++]=r;for(hn[e-1]=r,i=0,r=0;r<16;r++)for(Dn[r]=i,n=0;n<1<<zn[r];n++)un[i++]=r;for(i>>=7;r<Ye;r++)for(Dn[r]=i<<7,n=0;n<1<<zn[r]-7;n++)un[256+i++]=r;for(t=0;t<=ke;t++)s[t]=0;for(n=0;n<=143;)Kt[n*2+1]=8,n++,s[8]++;for(;n<=255;)Kt[n*2+1]=9,n++,s[9]++;for(;n<=279;)Kt[n*2+1]=7,n++,s[7]++;for(;n<=287;)Kt[n*2+1]=8,n++,s[8]++;for(ki(Kt,cn+1,s),n=0;n<Ye;n++)ln[n*2+1]=5,ln[n*2]=Ii(n,5);bi=new kr(Kt,Er,on+1,cn,ke),yi=new kr(ln,zn,0,Ye,ke),Si=new kr(new Array(0),ga,0,br,da)},Ai=n=>{let t;for(t=0;t<cn;t++)n.dyn_ltree[t*2]=0;for(t=0;t<Ye;t++)n.dyn_dtree[t*2]=0;for(t=0;t<br;t++)n.bl_tree[t*2]=0;n.dyn_ltree[Sr*2]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0},Mi=n=>{n.bi_valid>8?fn(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},_a=(n,t,e,r)=>{Mi(n),r&&(fn(n,e),fn(n,~e)),n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e},Ri=(n,t,e,r)=>{const i=t*2,s=e*2;return n[i]<n[s]||n[i]===n[s]&&r[t]<=r[e]},Mr=(n,t,e)=>{const r=n.heap[e];let i=e<<1;for(;i<=n.heap_len&&(i<n.heap_len&&Ri(t,n.heap[i+1],n.heap[i],n.depth)&&i++,!Ri(t,r,n.heap[i],n.depth));)n.heap[e]=n.heap[i],e=i,i<<=1;n.heap[e]=r},xi=(n,t,e)=>{let r,i,s=0,a,o;if(n.last_lit!==0)do r=n.pending_buf[n.d_buf+s*2]<<8|n.pending_buf[n.d_buf+s*2+1],i=n.pending_buf[n.l_buf+s],s++,r===0?Gt(n,i,t):(a=hn[i],Gt(n,a+on+1,t),o=Er[a],o!==0&&(i-=Ir[a],kt(n,i,o)),r--,a=Ei(r),Gt(n,a,e),o=zn[a],o!==0&&(r-=Dn[a],kt(n,r,o)));while(s<n.last_lit);Gt(n,Sr,t)},Rr=(n,t)=>{const e=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let a,o,g=-1,c;for(n.heap_len=0,n.heap_max=mi,a=0;a<s;a++)e[a*2]!==0?(n.heap[++n.heap_len]=g=a,n.depth[a]=0):e[a*2+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=g<2?++g:0,e[c*2]=1,n.depth[c]=0,n.opt_len--,i&&(n.static_len-=r[c*2+1]);for(t.max_code=g,a=n.heap_len>>1;a>=1;a--)Mr(n,e,a);c=s;do a=n.heap[1],n.heap[1]=n.heap[n.heap_len--],Mr(n,e,1),o=n.heap[1],n.heap[--n.heap_max]=a,n.heap[--n.heap_max]=o,e[c*2]=e[a*2]+e[o*2],n.depth[c]=(n.depth[a]>=n.depth[o]?n.depth[a]:n.depth[o])+1,e[a*2+1]=e[o*2+1]=c,n.heap[1]=c++,Mr(n,e,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],pa(n,t),ki(e,g,n.bl_count)},Ci=(n,t,e)=>{let r,i=-1,s,a=t[0*2+1],o=0,g=7,c=4;for(a===0&&(g=138,c=3),t[(e+1)*2+1]=65535,r=0;r<=e;r++)s=a,a=t[(r+1)*2+1],!(++o<g&&s===a)&&(o<c?n.bl_tree[s*2]+=o:s!==0?(s!==i&&n.bl_tree[s*2]++,n.bl_tree[wi*2]++):o<=10?n.bl_tree[pi*2]++:n.bl_tree[vi*2]++,o=0,i=s,a===0?(g=138,c=3):s===a?(g=6,c=3):(g=7,c=4))},Ni=(n,t,e)=>{let r,i=-1,s,a=t[0*2+1],o=0,g=7,c=4;for(a===0&&(g=138,c=3),r=0;r<=e;r++)if(s=a,a=t[(r+1)*2+1],!(++o<g&&s===a)){if(o<c)do Gt(n,s,n.bl_tree);while(--o!==0);else s!==0?(s!==i&&(Gt(n,s,n.bl_tree),o--),Gt(n,wi,n.bl_tree),kt(n,o-3,2)):o<=10?(Gt(n,pi,n.bl_tree),kt(n,o-3,3)):(Gt(n,vi,n.bl_tree),kt(n,o-11,7));o=0,i=s,a===0?(g=138,c=3):s===a?(g=6,c=3):(g=7,c=4)}},ba=n=>{let t;for(Ci(n,n.dyn_ltree,n.l_desc.max_code),Ci(n,n.dyn_dtree,n.d_desc.max_code),Rr(n,n.bl_desc),t=br-1;t>=3&&n.bl_tree[_i[t]*2+1]===0;t--);return n.opt_len+=3*(t+1)+5+5+4,t},ya=(n,t,e,r)=>{let i;for(kt(n,t-257,5),kt(n,e-1,5),kt(n,r-4,4),i=0;i<r;i++)kt(n,n.bl_tree[_i[i]*2+1],3);Ni(n,n.dyn_ltree,t-1),Ni(n,n.dyn_dtree,e-1)},Sa=n=>{let t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&n.dyn_ltree[e*2]!==0)return fi;if(n.dyn_ltree[9*2]!==0||n.dyn_ltree[10*2]!==0||n.dyn_ltree[13*2]!==0)return di;for(e=32;e<on;e++)if(n.dyn_ltree[e*2]!==0)return di;return fi};let Bi=!1;const Ea=n=>{Bi||(va(),Bi=!0),n.l_desc=new Ar(n.dyn_ltree,bi),n.d_desc=new Ar(n.dyn_dtree,yi),n.bl_desc=new Ar(n.bl_tree,Si),n.bi_buf=0,n.bi_valid=0,Ai(n)},Ti=(n,t,e,r)=>{kt(n,(la<<1)+(r?1:0),3),_a(n,t,e,!0)},Ia=n=>{kt(n,gi<<1,3),Gt(n,Sr,Kt),wa(n)},ka=(n,t,e,r)=>{let i,s,a=0;n.level>0?(n.strm.data_type===ca&&(n.strm.data_type=Sa(n)),Rr(n,n.l_desc),Rr(n,n.d_desc),a=ba(n),i=n.opt_len+3+7>>>3,s=n.static_len+3+7>>>3,s<=i&&(i=s)):i=s=e+5,e+4<=i&&t!==-1?Ti(n,t,e,r):n.strategy===oa||s===i?(kt(n,(gi<<1)+(r?1:0),3),xi(n,Kt,ln)):(kt(n,(ua<<1)+(r?1:0),3),ya(n,n.l_desc.max_code+1,n.d_desc.max_code+1,a+1),xi(n,n.dyn_ltree,n.dyn_dtree)),Ai(n),r&&Mi(n)},Aa=(n,t,e)=>(n.pending_buf[n.d_buf+n.last_lit*2]=t>>>8&255,n.pending_buf[n.d_buf+n.last_lit*2+1]=t&255,n.pending_buf[n.l_buf+n.last_lit]=e&255,n.last_lit++,t===0?n.dyn_ltree[e*2]++:(n.matches++,t--,n.dyn_ltree[(hn[e]+on+1)*2]++,n.dyn_dtree[Ei(t)*2]++),n.last_lit===n.lit_bufsize-1);var Ma=Ea,Ra=Ti,xa=ka,Ca=Aa,Na=Ia,Ba={_tr_init:Ma,_tr_stored_block:Ra,_tr_flush_block:xa,_tr_tally:Ca,_tr_align:Na},dn=(n,t,e,r)=>{let i=n&65535|0,s=n>>>16&65535|0,a=0;for(;e!==0;){a=e>2e3?2e3:e,e-=a;do i=i+t[r++]|0,s=s+i|0;while(--a);i%=65521,s%=65521}return i|s<<16|0};const Ta=()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;t[e]=n}return t},La=new Uint32Array(Ta());var gt=(n,t,e,r)=>{const i=La,s=r+e;n^=-1;for(let a=r;a<s;a++)n=n>>>8^i[(n^t[a])&255];return n^-1},Ae={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Me={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Pa,_tr_stored_block:Oa,_tr_flush_block:Ja,_tr_tally:ce,_tr_align:za}=Ba,{Z_NO_FLUSH:Re,Z_PARTIAL_FLUSH:Da,Z_FULL_FLUSH:Fa,Z_FINISH:le,Z_BLOCK:Li,Z_OK:$t,Z_STREAM_END:Pi,Z_STREAM_ERROR:Tt,Z_DATA_ERROR:Ua,Z_BUF_ERROR:xr,Z_DEFAULT_COMPRESSION:Ha,Z_FILTERED:Za,Z_HUFFMAN_ONLY:Fn,Z_RLE:Ga,Z_FIXED:$a,Z_DEFAULT_STRATEGY:Va,Z_UNKNOWN:Ya,Z_DEFLATED:Un}=Me,qa=9,Wa=15,Xa=8,ja=29,Cr=256+1+ja,Ka=30,Qa=19,to=2*Cr+1,eo=15,Q=3,ue=258,Dt=ue+Q+1,no=32,Hn=42,Nr=69,Zn=73,Gn=91,$n=103,xe=113,gn=666,ft=1,mn=2,Ce=3,qe=4,ro=3,he=(n,t)=>(n.msg=Ae[t],t),Oi=n=>(n<<1)-(n>4?9:0),fe=n=>{let t=n.length;for(;--t>=0;)n[t]=0};let de=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const ge=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),e!==0&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},wt=(n,t)=>{Ja(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,ge(n.strm)},tt=(n,t)=>{n.pending_buf[n.pending++]=t},wn=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=t&255},io=(n,t,e,r)=>{let i=n.avail_in;return i>r&&(i=r),i===0?0:(n.avail_in-=i,t.set(n.input.subarray(n.next_in,n.next_in+i),e),n.state.wrap===1?n.adler=dn(n.adler,t,i,e):n.state.wrap===2&&(n.adler=gt(n.adler,t,i,e)),n.next_in+=i,n.total_in+=i,i)},Ji=(n,t)=>{let e=n.max_chain_length,r=n.strstart,i,s,a=n.prev_length,o=n.nice_match;const g=n.strstart>n.w_size-Dt?n.strstart-(n.w_size-Dt):0,c=n.window,l=n.w_mask,h=n.prev,d=n.strstart+ue;let f=c[r+a-1],w=c[r+a];n.prev_length>=n.good_match&&(e>>=2),o>n.lookahead&&(o=n.lookahead);do if(i=t,!(c[i+a]!==w||c[i+a-1]!==f||c[i]!==c[r]||c[++i]!==c[r+1])){r+=2,i++;do;while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<d);if(s=ue-(d-r),r=d-ue,s>a){if(n.match_start=t,a=s,s>=o)break;f=c[r+a-1],w=c[r+a]}}while((t=h[t&l])>g&&--e!==0);return a<=n.lookahead?a:n.lookahead},Ne=n=>{const t=n.w_size;let e,r,i,s,a;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-Dt)){n.window.set(n.window.subarray(t,t+t),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,r=n.hash_size,e=r;do i=n.head[--e],n.head[e]=i>=t?i-t:0;while(--r);r=t,e=r;do i=n.prev[--e],n.prev[e]=i>=t?i-t:0;while(--r);s+=t}if(n.strm.avail_in===0)break;if(r=io(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=r,n.lookahead+n.insert>=Q)for(a=n.strstart-n.insert,n.ins_h=n.window[a],n.ins_h=de(n,n.ins_h,n.window[a+1]);n.insert&&(n.ins_h=de(n,n.ins_h,n.window[a+Q-1]),n.prev[a&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=a,a++,n.insert--,!(n.lookahead+n.insert<Q)););}while(n.lookahead<Dt&&n.strm.avail_in!==0)},so=(n,t)=>{let e=65535;for(e>n.pending_buf_size-5&&(e=n.pending_buf_size-5);;){if(n.lookahead<=1){if(Ne(n),n.lookahead===0&&t===Re)return ft;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;const r=n.block_start+e;if((n.strstart===0||n.strstart>=r)&&(n.lookahead=n.strstart-r,n.strstart=r,wt(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-Dt&&(wt(n,!1),n.strm.avail_out===0))return ft}return n.insert=0,t===le?(wt(n,!0),n.strm.avail_out===0?Ce:qe):(n.strstart>n.block_start&&(wt(n,!1),n.strm.avail_out===0),ft)},Br=(n,t)=>{let e,r;for(;;){if(n.lookahead<Dt){if(Ne(n),n.lookahead<Dt&&t===Re)return ft;if(n.lookahead===0)break}if(e=0,n.lookahead>=Q&&(n.ins_h=de(n,n.ins_h,n.window[n.strstart+Q-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),e!==0&&n.strstart-e<=n.w_size-Dt&&(n.match_length=Ji(n,e)),n.match_length>=Q)if(r=ce(n,n.strstart-n.match_start,n.match_length-Q),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=Q){n.match_length--;do n.strstart++,n.ins_h=de(n,n.ins_h,n.window[n.strstart+Q-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=de(n,n.ins_h,n.window[n.strstart+1]);else r=ce(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(r&&(wt(n,!1),n.strm.avail_out===0))return ft}return n.insert=n.strstart<Q-1?n.strstart:Q-1,t===le?(wt(n,!0),n.strm.avail_out===0?Ce:qe):n.last_lit&&(wt(n,!1),n.strm.avail_out===0)?ft:mn},We=(n,t)=>{let e,r,i;for(;;){if(n.lookahead<Dt){if(Ne(n),n.lookahead<Dt&&t===Re)return ft;if(n.lookahead===0)break}if(e=0,n.lookahead>=Q&&(n.ins_h=de(n,n.ins_h,n.window[n.strstart+Q-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=Q-1,e!==0&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-Dt&&(n.match_length=Ji(n,e),n.match_length<=5&&(n.strategy===Za||n.match_length===Q&&n.strstart-n.match_start>4096)&&(n.match_length=Q-1)),n.prev_length>=Q&&n.match_length<=n.prev_length){i=n.strstart+n.lookahead-Q,r=ce(n,n.strstart-1-n.prev_match,n.prev_length-Q),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=i&&(n.ins_h=de(n,n.ins_h,n.window[n.strstart+Q-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=Q-1,n.strstart++,r&&(wt(n,!1),n.strm.avail_out===0))return ft}else if(n.match_available){if(r=ce(n,0,n.window[n.strstart-1]),r&&wt(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return ft}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(r=ce(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<Q-1?n.strstart:Q-1,t===le?(wt(n,!0),n.strm.avail_out===0?Ce:qe):n.last_lit&&(wt(n,!1),n.strm.avail_out===0)?ft:mn},ao=(n,t)=>{let e,r,i,s;const a=n.window;for(;;){if(n.lookahead<=ue){if(Ne(n),n.lookahead<=ue&&t===Re)return ft;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=Q&&n.strstart>0&&(i=n.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){s=n.strstart+ue;do;while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);n.match_length=ue-(s-i),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=Q?(e=ce(n,1,n.match_length-Q),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(e=ce(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),e&&(wt(n,!1),n.strm.avail_out===0))return ft}return n.insert=0,t===le?(wt(n,!0),n.strm.avail_out===0?Ce:qe):n.last_lit&&(wt(n,!1),n.strm.avail_out===0)?ft:mn},oo=(n,t)=>{let e;for(;;){if(n.lookahead===0&&(Ne(n),n.lookahead===0)){if(t===Re)return ft;break}if(n.match_length=0,e=ce(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,e&&(wt(n,!1),n.strm.avail_out===0))return ft}return n.insert=0,t===le?(wt(n,!0),n.strm.avail_out===0?Ce:qe):n.last_lit&&(wt(n,!1),n.strm.avail_out===0)?ft:mn};function Vt(n,t,e,r,i){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=r,this.func=i}const pn=[new Vt(0,0,0,0,so),new Vt(4,4,8,4,Br),new Vt(4,5,16,8,Br),new Vt(4,6,32,32,Br),new Vt(4,4,16,16,We),new Vt(8,16,32,32,We),new Vt(8,16,128,128,We),new Vt(8,32,128,256,We),new Vt(32,128,258,1024,We),new Vt(32,258,258,4096,We)],co=n=>{n.window_size=2*n.w_size,fe(n.head),n.max_lazy_match=pn[n.level].max_lazy,n.good_match=pn[n.level].good_length,n.nice_match=pn[n.level].nice_length,n.max_chain_length=pn[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=Q-1,n.match_available=0,n.ins_h=0};function lo(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Un,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(to*2),this.dyn_dtree=new Uint16Array((2*Ka+1)*2),this.bl_tree=new Uint16Array((2*Qa+1)*2),fe(this.dyn_ltree),fe(this.dyn_dtree),fe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(eo+1),this.heap=new Uint16Array(2*Cr+1),fe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Cr+1),fe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const zi=n=>{if(!n||!n.state)return he(n,Tt);n.total_in=n.total_out=0,n.data_type=Ya;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Hn:xe,n.adler=t.wrap===2?0:1,t.last_flush=Re,Pa(t),$t},Di=n=>{const t=zi(n);return t===$t&&co(n.state),t},uo=(n,t)=>!n||!n.state||n.state.wrap!==2?Tt:(n.state.gzhead=t,$t),Fi=(n,t,e,r,i,s)=>{if(!n)return Tt;let a=1;if(t===Ha&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>qa||e!==Un||r<8||r>15||t<0||t>9||s<0||s>$a)return he(n,Tt);r===8&&(r=9);const o=new lo;return n.state=o,o.strm=n,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Q-1)/Q),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=t,o.strategy=s,o.method=e,Di(n)},ho=(n,t)=>Fi(n,t,Un,Wa,Xa,Va),fo=(n,t)=>{let e,r;if(!n||!n.state||t>Li||t<0)return n?he(n,Tt):Tt;const i=n.state;if(!n.output||!n.input&&n.avail_in!==0||i.status===gn&&t!==le)return he(n,n.avail_out===0?xr:Tt);i.strm=n;const s=i.last_flush;if(i.last_flush=t,i.status===Hn)if(i.wrap===2)n.adler=0,tt(i,31),tt(i,139),tt(i,8),i.gzhead?(tt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),tt(i,i.gzhead.time&255),tt(i,i.gzhead.time>>8&255),tt(i,i.gzhead.time>>16&255),tt(i,i.gzhead.time>>24&255),tt(i,i.level===9?2:i.strategy>=Fn||i.level<2?4:0),tt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(tt(i,i.gzhead.extra.length&255),tt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=gt(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Nr):(tt(i,0),tt(i,0),tt(i,0),tt(i,0),tt(i,0),tt(i,i.level===9?2:i.strategy>=Fn||i.level<2?4:0),tt(i,ro),i.status=xe);else{let a=Un+(i.w_bits-8<<4)<<8,o=-1;i.strategy>=Fn||i.level<2?o=0:i.level<6?o=1:i.level===6?o=2:o=3,a|=o<<6,i.strstart!==0&&(a|=no),a+=31-a%31,i.status=xe,wn(i,a),i.strstart!==0&&(wn(i,n.adler>>>16),wn(i,n.adler&65535)),n.adler=1}if(i.status===Nr)if(i.gzhead.extra){for(e=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=gt(n.adler,i.pending_buf,i.pending-e,e)),ge(n),e=i.pending,i.pending===i.pending_buf_size));)tt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>e&&(n.adler=gt(n.adler,i.pending_buf,i.pending-e,e)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Zn)}else i.status=Zn;if(i.status===Zn)if(i.gzhead.name){e=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=gt(n.adler,i.pending_buf,i.pending-e,e)),ge(n),e=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.name.length?r=i.gzhead.name.charCodeAt(i.gzindex++)&255:r=0,tt(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>e&&(n.adler=gt(n.adler,i.pending_buf,i.pending-e,e)),r===0&&(i.gzindex=0,i.status=Gn)}else i.status=Gn;if(i.status===Gn)if(i.gzhead.comment){e=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=gt(n.adler,i.pending_buf,i.pending-e,e)),ge(n),e=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.comment.length?r=i.gzhead.comment.charCodeAt(i.gzindex++)&255:r=0,tt(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>e&&(n.adler=gt(n.adler,i.pending_buf,i.pending-e,e)),r===0&&(i.status=$n)}else i.status=$n;if(i.status===$n&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&ge(n),i.pending+2<=i.pending_buf_size&&(tt(i,n.adler&255),tt(i,n.adler>>8&255),n.adler=0,i.status=xe)):i.status=xe),i.pending!==0){if(ge(n),n.avail_out===0)return i.last_flush=-1,$t}else if(n.avail_in===0&&Oi(t)<=Oi(s)&&t!==le)return he(n,xr);if(i.status===gn&&n.avail_in!==0)return he(n,xr);if(n.avail_in!==0||i.lookahead!==0||t!==Re&&i.status!==gn){let a=i.strategy===Fn?oo(i,t):i.strategy===Ga?ao(i,t):pn[i.level].func(i,t);if((a===Ce||a===qe)&&(i.status=gn),a===ft||a===Ce)return n.avail_out===0&&(i.last_flush=-1),$t;if(a===mn&&(t===Da?za(i):t!==Li&&(Oa(i,0,0,!1),t===Fa&&(fe(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),ge(n),n.avail_out===0))return i.last_flush=-1,$t}return t!==le?$t:i.wrap<=0?Pi:(i.wrap===2?(tt(i,n.adler&255),tt(i,n.adler>>8&255),tt(i,n.adler>>16&255),tt(i,n.adler>>24&255),tt(i,n.total_in&255),tt(i,n.total_in>>8&255),tt(i,n.total_in>>16&255),tt(i,n.total_in>>24&255)):(wn(i,n.adler>>>16),wn(i,n.adler&65535)),ge(n),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?$t:Pi)},go=n=>{if(!n||!n.state)return Tt;const t=n.state.status;return t!==Hn&&t!==Nr&&t!==Zn&&t!==Gn&&t!==$n&&t!==xe&&t!==gn?he(n,Tt):(n.state=null,t===xe?he(n,Ua):$t)},mo=(n,t)=>{let e=t.length;if(!n||!n.state)return Tt;const r=n.state,i=r.wrap;if(i===2||i===1&&r.status!==Hn||r.lookahead)return Tt;if(i===1&&(n.adler=dn(n.adler,t,e,0)),r.wrap=0,e>=r.w_size){i===0&&(fe(r.head),r.strstart=0,r.block_start=0,r.insert=0);let g=new Uint8Array(r.w_size);g.set(t.subarray(e-r.w_size,e),0),t=g,e=r.w_size}const s=n.avail_in,a=n.next_in,o=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,Ne(r);r.lookahead>=Q;){let g=r.strstart,c=r.lookahead-(Q-1);do r.ins_h=de(r,r.ins_h,r.window[g+Q-1]),r.prev[g&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=g,g++;while(--c);r.strstart=g,r.lookahead=Q-1,Ne(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Q-1,r.match_available=0,n.next_in=a,n.input=o,n.avail_in=s,r.wrap=i,$t};var wo=ho,po=Fi,vo=Di,_o=zi,bo=uo,yo=fo,So=go,Eo=mo,Io="pako deflate (from Nodeca project)",vn={deflateInit:wo,deflateInit2:po,deflateReset:vo,deflateResetKeep:_o,deflateSetHeader:bo,deflate:yo,deflateEnd:So,deflateSetDictionary:Eo,deflateInfo:Io};const ko=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Ao=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(!!e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const r in e)ko(e,r)&&(n[r]=e[r])}}return n},Mo=n=>{let t=0;for(let r=0,i=n.length;r<i;r++)t+=n[r].length;const e=new Uint8Array(t);for(let r=0,i=0,s=n.length;r<s;r++){let a=n[r];e.set(a,i),i+=a.length}return e},Vn={assign:Ao,flattenChunks:Mo};let Ui=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ui=!1}const _n=new Uint8Array(256);for(let n=0;n<256;n++)_n[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;_n[254]=_n[254]=1;var Ro=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let t,e,r,i,s,a=n.length,o=0;for(i=0;i<a;i++)e=n.charCodeAt(i),(e&64512)===55296&&i+1<a&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),o+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)e=n.charCodeAt(i),(e&64512)===55296&&i+1<a&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),e<128?t[s++]=e:e<2048?(t[s++]=192|e>>>6,t[s++]=128|e&63):e<65536?(t[s++]=224|e>>>12,t[s++]=128|e>>>6&63,t[s++]=128|e&63):(t[s++]=240|e>>>18,t[s++]=128|e>>>12&63,t[s++]=128|e>>>6&63,t[s++]=128|e&63);return t};const xo=(n,t)=>{if(t<65534&&n.subarray&&Ui)return String.fromCharCode.apply(null,n.length===t?n:n.subarray(0,t));let e="";for(let r=0;r<t;r++)e+=String.fromCharCode(n[r]);return e};var Co=(n,t)=>{const e=t||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,t));let r,i;const s=new Array(e*2);for(i=0,r=0;r<e;){let a=n[r++];if(a<128){s[i++]=a;continue}let o=_n[a];if(o>4){s[i++]=65533,r+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&r<e;)a=a<<6|n[r++]&63,o--;if(o>1){s[i++]=65533;continue}a<65536?s[i++]=a:(a-=65536,s[i++]=55296|a>>10&1023,s[i++]=56320|a&1023)}return xo(s,i)},No=(n,t)=>{t=t||n.length,t>n.length&&(t=n.length);let e=t-1;for(;e>=0&&(n[e]&192)===128;)e--;return e<0||e===0?t:e+_n[n[e]]>t?e:t},bn={string2buf:Ro,buf2string:Co,utf8border:No};function Bo(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Hi=Bo;const Zi=Object.prototype.toString,{Z_NO_FLUSH:To,Z_SYNC_FLUSH:Lo,Z_FULL_FLUSH:Po,Z_FINISH:Oo,Z_OK:Yn,Z_STREAM_END:Jo,Z_DEFAULT_COMPRESSION:zo,Z_DEFAULT_STRATEGY:Do,Z_DEFLATED:Fo}=Me;function yn(n){this.options=Vn.assign({level:zo,method:Fo,chunkSize:16384,windowBits:15,memLevel:8,strategy:Do},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Hi,this.strm.avail_out=0;let e=vn.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==Yn)throw new Error(Ae[e]);if(t.header&&vn.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=bn.string2buf(t.dictionary):Zi.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,e=vn.deflateSetDictionary(this.strm,r),e!==Yn)throw new Error(Ae[e]);this._dict_set=!0}}yn.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?Oo:To,typeof n=="string"?e.input=bn.string2buf(n):Zi.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),(s===Lo||s===Po)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(i=vn.deflate(e,s),i===Jo)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),i=vn.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Yn;if(e.avail_out===0){this.onData(e.output);continue}if(s>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0},yn.prototype.onData=function(n){this.chunks.push(n)},yn.prototype.onEnd=function(n){n===Yn&&(this.result=Vn.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Tr(n,t){const e=new yn(t);if(e.push(n,!0),e.err)throw e.msg||Ae[e.err];return e.result}function Uo(n,t){return t=t||{},t.raw=!0,Tr(n,t)}function Ho(n,t){return t=t||{},t.gzip=!0,Tr(n,t)}var Zo=yn,Go=Tr,$o=Uo,Vo=Ho,Yo=Me,qo={Deflate:Zo,deflate:Go,deflateRaw:$o,gzip:Vo,constants:Yo};const qn=30,Wo=12;var Xo=function(t,e){let r,i,s,a,o,g,c,l,h,d,f,w,v,m,p,S,E,y,x,A,I,R,C,M;const N=t.state;r=t.next_in,C=t.input,i=r+(t.avail_in-5),s=t.next_out,M=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),g=N.dmax,c=N.wsize,l=N.whave,h=N.wnext,d=N.window,f=N.hold,w=N.bits,v=N.lencode,m=N.distcode,p=(1<<N.lenbits)-1,S=(1<<N.distbits)-1;t:do{w<15&&(f+=C[r++]<<w,w+=8,f+=C[r++]<<w,w+=8),E=v[f&p];e:for(;;){if(y=E>>>24,f>>>=y,w-=y,y=E>>>16&255,y===0)M[s++]=E&65535;else if(y&16){x=E&65535,y&=15,y&&(w<y&&(f+=C[r++]<<w,w+=8),x+=f&(1<<y)-1,f>>>=y,w-=y),w<15&&(f+=C[r++]<<w,w+=8,f+=C[r++]<<w,w+=8),E=m[f&S];n:for(;;){if(y=E>>>24,f>>>=y,w-=y,y=E>>>16&255,y&16){if(A=E&65535,y&=15,w<y&&(f+=C[r++]<<w,w+=8,w<y&&(f+=C[r++]<<w,w+=8)),A+=f&(1<<y)-1,A>g){t.msg="invalid distance too far back",N.mode=qn;break t}if(f>>>=y,w-=y,y=s-a,A>y){if(y=A-y,y>l&&N.sane){t.msg="invalid distance too far back",N.mode=qn;break t}if(I=0,R=d,h===0){if(I+=c-y,y<x){x-=y;do M[s++]=d[I++];while(--y);I=s-A,R=M}}else if(h<y){if(I+=c+h-y,y-=h,y<x){x-=y;do M[s++]=d[I++];while(--y);if(I=0,h<x){y=h,x-=y;do M[s++]=d[I++];while(--y);I=s-A,R=M}}}else if(I+=h-y,y<x){x-=y;do M[s++]=d[I++];while(--y);I=s-A,R=M}for(;x>2;)M[s++]=R[I++],M[s++]=R[I++],M[s++]=R[I++],x-=3;x&&(M[s++]=R[I++],x>1&&(M[s++]=R[I++]))}else{I=s-A;do M[s++]=M[I++],M[s++]=M[I++],M[s++]=M[I++],x-=3;while(x>2);x&&(M[s++]=M[I++],x>1&&(M[s++]=M[I++]))}}else if((y&64)===0){E=m[(E&65535)+(f&(1<<y)-1)];continue n}else{t.msg="invalid distance code",N.mode=qn;break t}break}}else if((y&64)===0){E=v[(E&65535)+(f&(1<<y)-1)];continue e}else if(y&32){N.mode=Wo;break t}else{t.msg="invalid literal/length code",N.mode=qn;break t}break}}while(r<i&&s<o);x=w>>3,r-=x,w-=x<<3,f&=(1<<w)-1,t.next_in=r,t.next_out=s,t.avail_in=r<i?5+(i-r):5-(r-i),t.avail_out=s<o?257+(o-s):257-(s-o),N.hold=f,N.bits=w};const Xe=15,Gi=852,$i=592,Vi=0,Lr=1,Yi=2,jo=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ko=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Qo=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),tc=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Sn=(n,t,e,r,i,s,a,o)=>{const g=o.bits;let c=0,l=0,h=0,d=0,f=0,w=0,v=0,m=0,p=0,S=0,E,y,x,A,I,R=null,C=0,M;const N=new Uint16Array(Xe+1),L=new Uint16Array(Xe+1);let F=null,U=0,T,O,G;for(c=0;c<=Xe;c++)N[c]=0;for(l=0;l<r;l++)N[t[e+l]]++;for(f=g,d=Xe;d>=1&&N[d]===0;d--);if(f>d&&(f=d),d===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<d&&N[h]===0;h++);for(f<h&&(f=h),m=1,c=1;c<=Xe;c++)if(m<<=1,m-=N[c],m<0)return-1;if(m>0&&(n===Vi||d!==1))return-1;for(L[1]=0,c=1;c<Xe;c++)L[c+1]=L[c]+N[c];for(l=0;l<r;l++)t[e+l]!==0&&(a[L[t[e+l]]++]=l);if(n===Vi?(R=F=a,M=19):n===Lr?(R=jo,C-=257,F=Ko,U-=257,M=256):(R=Qo,F=tc,M=-1),S=0,l=0,c=h,I=s,w=f,v=0,x=-1,p=1<<f,A=p-1,n===Lr&&p>Gi||n===Yi&&p>$i)return 1;for(;;){T=c-v,a[l]<M?(O=0,G=a[l]):a[l]>M?(O=F[U+a[l]],G=R[C+a[l]]):(O=32+64,G=0),E=1<<c-v,y=1<<w,h=y;do y-=E,i[I+(S>>v)+y]=T<<24|O<<16|G|0;while(y!==0);for(E=1<<c-1;S&E;)E>>=1;if(E!==0?(S&=E-1,S+=E):S=0,l++,--N[c]===0){if(c===d)break;c=t[e+a[l]]}if(c>f&&(S&A)!==x){for(v===0&&(v=f),I+=h,w=c-v,m=1<<w;w+v<d&&(m-=N[w+v],!(m<=0));)w++,m<<=1;if(p+=1<<w,n===Lr&&p>Gi||n===Yi&&p>$i)return 1;x=S&A,i[x]=f<<24|w<<16|I-s|0}}return S!==0&&(i[I+S]=c-v<<24|64<<16|0),o.bits=f,0};const ec=0,qi=1,Wi=2,{Z_FINISH:Xi,Z_BLOCK:nc,Z_TREES:Wn,Z_OK:Be,Z_STREAM_END:rc,Z_NEED_DICT:ic,Z_STREAM_ERROR:Lt,Z_DATA_ERROR:ji,Z_MEM_ERROR:Ki,Z_BUF_ERROR:sc,Z_DEFLATED:Qi}=Me,ts=1,es=2,ns=3,rs=4,is=5,ss=6,as=7,os=8,cs=9,ls=10,Xn=11,Qt=12,Pr=13,us=14,Or=15,hs=16,fs=17,ds=18,gs=19,jn=20,Kn=21,ms=22,ws=23,ps=24,vs=25,_s=26,Jr=27,bs=28,ys=29,st=30,Ss=31,ac=32,oc=852,cc=592,lc=15,Es=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function uc(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Is=n=>{if(!n||!n.state)return Lt;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=t.wrap&1),t.mode=ts,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(oc),t.distcode=t.distdyn=new Int32Array(cc),t.sane=1,t.back=-1,Be},ks=n=>{if(!n||!n.state)return Lt;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,Is(n)},As=(n,t)=>{let e;if(!n||!n.state)return Lt;const r=n.state;return t<0?(e=0,t=-t):(e=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?Lt:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=e,r.wbits=t,ks(n))},Ms=(n,t)=>{if(!n)return Lt;const e=new uc;n.state=e,e.window=null;const r=As(n,t);return r!==Be&&(n.state=null),r},hc=n=>Ms(n,lc);let Rs=!0,zr,Dr;const fc=n=>{if(Rs){zr=new Int32Array(512),Dr=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(Sn(qi,n.lens,0,288,zr,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;Sn(Wi,n.lens,0,32,Dr,0,n.work,{bits:5}),Rs=!1}n.lencode=zr,n.lenbits=9,n.distcode=Dr,n.distbits=5},xs=(n,t,e,r)=>{let i;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(e-r,e-r+i),s.wnext),r-=i,r?(s.window.set(t.subarray(e-r,e),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},dc=(n,t)=>{let e,r,i,s,a,o,g,c,l,h,d,f,w,v,m=0,p,S,E,y,x,A,I,R;const C=new Uint8Array(4);let M,N;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!n||!n.state||!n.output||!n.input&&n.avail_in!==0)return Lt;e=n.state,e.mode===Qt&&(e.mode=Pr),a=n.next_out,i=n.output,g=n.avail_out,s=n.next_in,r=n.input,o=n.avail_in,c=e.hold,l=e.bits,h=o,d=g,R=Be;t:for(;;)switch(e.mode){case ts:if(e.wrap===0){e.mode=Pr;break}for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(e.wrap&2&&c===35615){e.check=0,C[0]=c&255,C[1]=c>>>8&255,e.check=gt(e.check,C,2,0),c=0,l=0,e.mode=es;break}if(e.flags=0,e.head&&(e.head.done=!1),!(e.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",e.mode=st;break}if((c&15)!==Qi){n.msg="unknown compression method",e.mode=st;break}if(c>>>=4,l-=4,I=(c&15)+8,e.wbits===0)e.wbits=I;else if(I>e.wbits){n.msg="invalid window size",e.mode=st;break}e.dmax=1<<e.wbits,n.adler=e.check=1,e.mode=c&512?ls:Qt,c=0,l=0;break;case es:for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(e.flags=c,(e.flags&255)!==Qi){n.msg="unknown compression method",e.mode=st;break}if(e.flags&57344){n.msg="unknown header flags set",e.mode=st;break}e.head&&(e.head.text=c>>8&1),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,e.check=gt(e.check,C,2,0)),c=0,l=0,e.mode=ns;case ns:for(;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.head&&(e.head.time=c),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,e.check=gt(e.check,C,4,0)),c=0,l=0,e.mode=rs;case rs:for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.head&&(e.head.xflags=c&255,e.head.os=c>>8),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,e.check=gt(e.check,C,2,0)),c=0,l=0,e.mode=is;case is:if(e.flags&1024){for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.length=c,e.head&&(e.head.extra_len=c),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,e.check=gt(e.check,C,2,0)),c=0,l=0}else e.head&&(e.head.extra=null);e.mode=ss;case ss:if(e.flags&1024&&(f=e.length,f>o&&(f=o),f&&(e.head&&(I=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(r.subarray(s,s+f),I)),e.flags&512&&(e.check=gt(e.check,r,f,s)),o-=f,s+=f,e.length-=f),e.length))break t;e.length=0,e.mode=as;case as:if(e.flags&2048){if(o===0)break t;f=0;do I=r[s+f++],e.head&&I&&e.length<65536&&(e.head.name+=String.fromCharCode(I));while(I&&f<o);if(e.flags&512&&(e.check=gt(e.check,r,f,s)),o-=f,s+=f,I)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=os;case os:if(e.flags&4096){if(o===0)break t;f=0;do I=r[s+f++],e.head&&I&&e.length<65536&&(e.head.comment+=String.fromCharCode(I));while(I&&f<o);if(e.flags&512&&(e.check=gt(e.check,r,f,s)),o-=f,s+=f,I)break t}else e.head&&(e.head.comment=null);e.mode=cs;case cs:if(e.flags&512){for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(c!==(e.check&65535)){n.msg="header crc mismatch",e.mode=st;break}c=0,l=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=Qt;break;case ls:for(;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}n.adler=e.check=Es(c),c=0,l=0,e.mode=Xn;case Xn:if(e.havedict===0)return n.next_out=a,n.avail_out=g,n.next_in=s,n.avail_in=o,e.hold=c,e.bits=l,ic;n.adler=e.check=1,e.mode=Qt;case Qt:if(t===nc||t===Wn)break t;case Pr:if(e.last){c>>>=l&7,l-=l&7,e.mode=Jr;break}for(;l<3;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}switch(e.last=c&1,c>>>=1,l-=1,c&3){case 0:e.mode=us;break;case 1:if(fc(e),e.mode=jn,t===Wn){c>>>=2,l-=2;break t}break;case 2:e.mode=fs;break;case 3:n.msg="invalid block type",e.mode=st}c>>>=2,l-=2;break;case us:for(c>>>=l&7,l-=l&7;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",e.mode=st;break}if(e.length=c&65535,c=0,l=0,e.mode=Or,t===Wn)break t;case Or:e.mode=hs;case hs:if(f=e.length,f){if(f>o&&(f=o),f>g&&(f=g),f===0)break t;i.set(r.subarray(s,s+f),a),o-=f,s+=f,g-=f,a+=f,e.length-=f;break}e.mode=Qt;break;case fs:for(;l<14;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(e.nlen=(c&31)+257,c>>>=5,l-=5,e.ndist=(c&31)+1,c>>>=5,l-=5,e.ncode=(c&15)+4,c>>>=4,l-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=st;break}e.have=0,e.mode=ds;case ds:for(;e.have<e.ncode;){for(;l<3;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.lens[L[e.have++]]=c&7,c>>>=3,l-=3}for(;e.have<19;)e.lens[L[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,M={bits:e.lenbits},R=Sn(ec,e.lens,0,19,e.lencode,0,e.work,M),e.lenbits=M.bits,R){n.msg="invalid code lengths set",e.mode=st;break}e.have=0,e.mode=gs;case gs:for(;e.have<e.nlen+e.ndist;){for(;m=e.lencode[c&(1<<e.lenbits)-1],p=m>>>24,S=m>>>16&255,E=m&65535,!(p<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(E<16)c>>>=p,l-=p,e.lens[e.have++]=E;else{if(E===16){for(N=p+2;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(c>>>=p,l-=p,e.have===0){n.msg="invalid bit length repeat",e.mode=st;break}I=e.lens[e.have-1],f=3+(c&3),c>>>=2,l-=2}else if(E===17){for(N=p+3;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=p,l-=p,I=0,f=3+(c&7),c>>>=3,l-=3}else{for(N=p+7;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=p,l-=p,I=0,f=11+(c&127),c>>>=7,l-=7}if(e.have+f>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=st;break}for(;f--;)e.lens[e.have++]=I}}if(e.mode===st)break;if(e.lens[256]===0){n.msg="invalid code -- missing end-of-block",e.mode=st;break}if(e.lenbits=9,M={bits:e.lenbits},R=Sn(qi,e.lens,0,e.nlen,e.lencode,0,e.work,M),e.lenbits=M.bits,R){n.msg="invalid literal/lengths set",e.mode=st;break}if(e.distbits=6,e.distcode=e.distdyn,M={bits:e.distbits},R=Sn(Wi,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,M),e.distbits=M.bits,R){n.msg="invalid distances set",e.mode=st;break}if(e.mode=jn,t===Wn)break t;case jn:e.mode=Kn;case Kn:if(o>=6&&g>=258){n.next_out=a,n.avail_out=g,n.next_in=s,n.avail_in=o,e.hold=c,e.bits=l,Xo(n,d),a=n.next_out,i=n.output,g=n.avail_out,s=n.next_in,r=n.input,o=n.avail_in,c=e.hold,l=e.bits,e.mode===Qt&&(e.back=-1);break}for(e.back=0;m=e.lencode[c&(1<<e.lenbits)-1],p=m>>>24,S=m>>>16&255,E=m&65535,!(p<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(S&&(S&240)===0){for(y=p,x=S,A=E;m=e.lencode[A+((c&(1<<y+x)-1)>>y)],p=m>>>24,S=m>>>16&255,E=m&65535,!(y+p<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=y,l-=y,e.back+=y}if(c>>>=p,l-=p,e.back+=p,e.length=E,S===0){e.mode=_s;break}if(S&32){e.back=-1,e.mode=Qt;break}if(S&64){n.msg="invalid literal/length code",e.mode=st;break}e.extra=S&15,e.mode=ms;case ms:if(e.extra){for(N=e.extra;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,l-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=ws;case ws:for(;m=e.distcode[c&(1<<e.distbits)-1],p=m>>>24,S=m>>>16&255,E=m&65535,!(p<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if((S&240)===0){for(y=p,x=S,A=E;m=e.distcode[A+((c&(1<<y+x)-1)>>y)],p=m>>>24,S=m>>>16&255,E=m&65535,!(y+p<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=y,l-=y,e.back+=y}if(c>>>=p,l-=p,e.back+=p,S&64){n.msg="invalid distance code",e.mode=st;break}e.offset=E,e.extra=S&15,e.mode=ps;case ps:if(e.extra){for(N=e.extra;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,l-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=st;break}e.mode=vs;case vs:if(g===0)break t;if(f=d-g,e.offset>f){if(f=e.offset-f,f>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=st;break}f>e.wnext?(f-=e.wnext,w=e.wsize-f):w=e.wnext-f,f>e.length&&(f=e.length),v=e.window}else v=i,w=a-e.offset,f=e.length;f>g&&(f=g),g-=f,e.length-=f;do i[a++]=v[w++];while(--f);e.length===0&&(e.mode=Kn);break;case _s:if(g===0)break t;i[a++]=e.length,g--,e.mode=Kn;break;case Jr:if(e.wrap){for(;l<32;){if(o===0)break t;o--,c|=r[s++]<<l,l+=8}if(d-=g,n.total_out+=d,e.total+=d,d&&(n.adler=e.check=e.flags?gt(e.check,i,d,a-d):dn(e.check,i,d,a-d)),d=g,(e.flags?c:Es(c))!==e.check){n.msg="incorrect data check",e.mode=st;break}c=0,l=0}e.mode=bs;case bs:if(e.wrap&&e.flags){for(;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(c!==(e.total&4294967295)){n.msg="incorrect length check",e.mode=st;break}c=0,l=0}e.mode=ys;case ys:R=rc;break t;case st:R=ji;break t;case Ss:return Ki;case ac:default:return Lt}return n.next_out=a,n.avail_out=g,n.next_in=s,n.avail_in=o,e.hold=c,e.bits=l,(e.wsize||d!==n.avail_out&&e.mode<st&&(e.mode<Jr||t!==Xi))&&xs(n,n.output,n.next_out,d-n.avail_out),h-=n.avail_in,d-=n.avail_out,n.total_in+=h,n.total_out+=d,e.total+=d,e.wrap&&d&&(n.adler=e.check=e.flags?gt(e.check,i,d,n.next_out-d):dn(e.check,i,d,n.next_out-d)),n.data_type=e.bits+(e.last?64:0)+(e.mode===Qt?128:0)+(e.mode===jn||e.mode===Or?256:0),(h===0&&d===0||t===Xi)&&R===Be&&(R=sc),R},gc=n=>{if(!n||!n.state)return Lt;let t=n.state;return t.window&&(t.window=null),n.state=null,Be},mc=(n,t)=>{if(!n||!n.state)return Lt;const e=n.state;return(e.wrap&2)===0?Lt:(e.head=t,t.done=!1,Be)},wc=(n,t)=>{const e=t.length;let r,i,s;return!n||!n.state||(r=n.state,r.wrap!==0&&r.mode!==Xn)?Lt:r.mode===Xn&&(i=1,i=dn(i,t,e,0),i!==r.check)?ji:(s=xs(n,t,e,e),s?(r.mode=Ss,Ki):(r.havedict=1,Be))};var pc=ks,vc=As,_c=Is,bc=hc,yc=Ms,Sc=dc,Ec=gc,Ic=mc,kc=wc,Ac="pako inflate (from Nodeca project)",te={inflateReset:pc,inflateReset2:vc,inflateResetKeep:_c,inflateInit:bc,inflateInit2:yc,inflate:Sc,inflateEnd:Ec,inflateGetHeader:Ic,inflateSetDictionary:kc,inflateInfo:Ac};function Mc(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Rc=Mc;const Cs=Object.prototype.toString,{Z_NO_FLUSH:xc,Z_FINISH:Cc,Z_OK:En,Z_STREAM_END:Fr,Z_NEED_DICT:Ur,Z_STREAM_ERROR:Nc,Z_DATA_ERROR:Ns,Z_MEM_ERROR:Bc}=Me;function In(n){this.options=Vn.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Hi,this.strm.avail_out=0;let e=te.inflateInit2(this.strm,t.windowBits);if(e!==En)throw new Error(Ae[e]);if(this.header=new Rc,te.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=bn.string2buf(t.dictionary):Cs.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=te.inflateSetDictionary(this.strm,t.dictionary),e!==En)))throw new Error(Ae[e])}In.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?Cc:xc,Cs.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),s=te.inflate(e,a),s===Ur&&i&&(s=te.inflateSetDictionary(e,i),s===En?s=te.inflate(e,a):s===Ns&&(s=Ur));e.avail_in>0&&s===Fr&&e.state.wrap>0&&n[e.next_in]!==0;)te.inflateReset(e),s=te.inflate(e,a);switch(s){case Nc:case Ns:case Ur:case Bc:return this.onEnd(s),this.ended=!0,!1}if(o=e.avail_out,e.next_out&&(e.avail_out===0||s===Fr))if(this.options.to==="string"){let g=bn.utf8border(e.output,e.next_out),c=e.next_out-g,l=bn.buf2string(e.output,g);e.next_out=c,e.avail_out=r-c,c&&e.output.set(e.output.subarray(g,g+c),0),this.onData(l)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(s===En&&o===0)){if(s===Fr)return s=te.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},In.prototype.onData=function(n){this.chunks.push(n)},In.prototype.onEnd=function(n){n===En&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Vn.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Hr(n,t){const e=new In(t);if(e.push(n),e.err)throw e.msg||Ae[e.err];return e.result}function Tc(n,t){return t=t||{},t.raw=!0,Hr(n,t)}var Lc=In,Pc=Hr,Oc=Tc,Jc=Hr,zc=Me,Dc={Inflate:Lc,inflate:Pc,inflateRaw:Oc,ungzip:Jc,constants:zc};const{Deflate:Fc,deflate:Uc,deflateRaw:Hc,gzip:Zc}=qo,{Inflate:Gc,inflate:$c,inflateRaw:Vc,ungzip:Yc}=Dc;var qc=Fc,Wc=Uc,Xc=Hc,jc=Zc,Kc=Gc,Qc=$c,tl=Vc,el=Yc,nl=Me,Zr={Deflate:qc,deflate:Wc,deflateRaw:Xc,gzip:jc,Inflate:Kc,inflate:Qc,inflateRaw:tl,ungzip:el,constants:nl},D=(n=>(n[n.End=0]="End",n[n.Byte=1]="Byte",n[n.Short=2]="Short",n[n.Int=3]="Int",n[n.Long=4]="Long",n[n.Float=5]="Float",n[n.Double=6]="Double",n[n.ByteArray=7]="ByteArray",n[n.String=8]="String",n[n.List=9]="List",n[n.Compound=10]="Compound",n[n.IntArray=11]="IntArray",n[n.LongArray=12]="LongArray",n))(D||{});const wr=class{static register(t,e){const r=e.create().getId();if(r!==t)throw new Error(`Registered factory ${D[r]} does not match type ${D[t]}`);wr.FACTORIES.set(t,e)}isEnd(){return this.getId()===D.End}isByte(){return this.getId()===D.Byte}isShort(){return this.getId()===D.Short}isInt(){return this.getId()===D.Int}isLong(){return this.getId()===D.Long}isFloat(){return this.getId()===D.Float}isDouble(){return this.getId()===D.Double}isByteArray(){return this.getId()===D.ByteArray}isString(){return this.getId()===D.String}isList(){return this.getId()===D.List}isCompound(){return this.getId()===D.Compound}isIntArray(){return this.getId()===D.IntArray}isLongArray(){return this.getId()===D.LongArray}isNumber(){return this.isByte()||this.isShort()||this.isInt()||this.isLong()||this.isFloat()||this.isDouble()}isArray(){return this.isByteArray()||this.isIntArray()||this.isLongArray()}isListOrArray(){return this.isList()||this.isArray()}getAsNumber(){return 0}getAsString(){return""}toJsonWithId(){return{type:this.getId(),value:this.toJson()}}static getFactory(t){const e=this.FACTORIES.get(t);if(!e)throw new Error(`Invalid tag id ${t}`);return e}static create(t){return this.getFactory(t).create()}static fromString(t){const e=typeof t=="string"?new It(t):t;return this.getFactory(D.Compound).fromString(e)}static fromJson(t,e=D.Compound){return this.getFactory(e).fromJson(t)}static fromJsonWithId(t){var i,s,a;const e=(i=u.Json.readObject(t))!=null?i:{},r=(s=u.Json.readInt(e.type))!=null?s:0;return wr.fromJson((a=e.value)!=null?a:{},r)}static fromBytes(t,e=D.Compound){return this.getFactory(e).fromBytes(t)}};let et=wr;_(et,"FACTORIES",new Map);const Ze=class extends et{constructor(e){super();_(this,"value");this.value=typeof e=="number"?e:e?1:0}getId(){return D.Byte}equals(e){return e.isByte()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"b"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeByte(this.value)}static create(){return Ze.ZERO}static fromJson(e){var r;return new Ze((r=u.Json.readInt(e))!=null?r:0)}static fromBytes(e){const r=e.readByte();return new Ze(r)}};let Pt=Ze;_(Pt,"ZERO",new Ze(0)),_(Pt,"ONE",new Ze(1)),et.register(D.Byte,Pt);class kn extends et{constructor(e){super();_(this,"items");this.items=e}getItems(){return this.items.slice(0)}getAsTuple(e,r){return[...Array(e)].map((i,s)=>r(this.items[s]))}get(e){if(e=Math.floor(e),!(e<0||e>=this.items.length))return this.items[e]}get length(){return this.items.length}map(e){return this.items.map(e)}filter(e){return this.items.filter(e)}forEach(e){this.items.forEach(e)}set(e,r){this.items[e]=r}add(e){this.items.push(e)}insert(e,r){this.items.splice(e,0,r)}delete(e){this.items.splice(e,1)}clear(){this.items=[]}}class me extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="number"?new Pt(e):e))}getId(){return D.ByteArray}equals(t){return t.isByteArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return D.Byte}toString(){return"[B;"+this.items.map(e=>e.getAsNumber().toFixed()+"B").join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length),t.writeBytes(this.items.map(e=>e.getAsNumber()))}static create(){return new me([])}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readNumber(i))!=null?s:0}))!=null?r:[];return new me(e)}static fromBytes(t){const e=t.readInt(),r=t.readBytes(e);return new me(r)}}et.register(D.ByteArray,me);class Te extends et{constructor(e){super();_(this,"value");this.value=e}getId(){return D.Float}equals(e){return e.isFloat()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toString()+"f"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeFloat(this.value)}static create(){return new Te(0)}static fromJson(e){var r;return new Te((r=u.Json.readNumber(e))!=null?r:0)}static fromBytes(e){const r=e.readFloat();return new Te(r)}}et.register(D.Float,Te);class Ft extends et{constructor(e){super();_(this,"value");this.value=e}getId(){return D.Int}equals(e){return e.isInt()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeInt(this.value)}static create(){return new Ft(0)}static fromJson(e){var r;return new Ft((r=u.Json.readInt(e))!=null?r:0)}static fromBytes(e){const r=e.readInt();return new Ft(r)}}et.register(D.Int,Ft);class we extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="number"?new Ft(e):e))}getId(){return D.IntArray}equals(t){return t.isIntArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return D.Int}get length(){return this.items.length}toString(){return"[I;"+this.items.map(e=>e.getAsNumber().toFixed()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length);for(const e of this.items)t.writeInt(e.getAsNumber())}static create(){return new we}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readNumber(i))!=null?s:0}))!=null?r:[];return new we(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let i=0;i<e;i+=1)r.push(t.readInt());return new we(r)}}et.register(D.IntArray,we);class xt extends kn{constructor(e,r){super(e!=null?e:[]);_(this,"type");this.type=this.items.length===0?D.End:r!=null?r:this.items[0].getId()}static make(e,r){return new xt(r.map(i=>new e(i)))}getId(){return D.List}equals(e){return e.isList()&&this.type===e.type&&this.length===e.length&&this.items.every((r,i)=>r.equals(e.items[i]))}getType(){return this.type}getNumber(e){const r=this.get(e);return r!=null&&r.isNumber()?r.getAsNumber():0}getString(e){const r=this.get(e);return r!=null&&r.isString()?r.getAsString():""}getList(e,r){const i=this.get(e);return(i==null?void 0:i.isList())&&i.getType()===r?i:xt.create()}getCompound(e){const r=this.get(e);return r!=null&&r.isCompound()?r:mt.create()}set(e,r){this.updateType(r),super.set(e,r)}add(e){this.updateType(e),super.add(e)}insert(e,r){this.updateType(r),super.insert(e,r)}updateType(e){if(e.getId()!==D.End){if(this.type===D.End)this.type=e.getId();else if(this.type!==e.getId())throw new Error(`Trying to add tag of type ${D[e.getId()]} to list of ${D[this.type]}`)}}clear(){super.clear(),this.type=D.End}toString(){return"["+this.items.map(e=>e.toString()).join(",")+"]"}toPrettyString(e="  ",r=0){if(this.length===0)return"[]";const i=e.repeat(r),s=e.repeat(r+1);return`[
`+this.map(a=>s+a.toPrettyString(e,r+1)).join(`,
`)+`
`+i+"]"}toSimplifiedJson(){return this.map(e=>e.toSimplifiedJson())}toJson(){return{type:this.type,items:this.items.map(e=>e.toJson())}}toBytes(e){this.items.length===0?this.type=D.End:this.type=this.items[0].getId(),e.writeByte(this.type),e.writeInt(this.items.length);for(const r of this.items)r.toBytes(e)}static create(){return new xt}static fromJson(e){var a,o,g;const r=(a=u.Json.readObject(e))!=null?a:{},i=(o=u.Json.readNumber(r.type))!=null?o:D.Compound,s=((g=u.Json.readArray(r.items))!=null?g:[]).flatMap(c=>c!==void 0?[et.fromJson(c,i)]:[]);return new xt(s,i)}static fromBytes(e){const r=e.readByte(),i=e.readInt();if(r===D.End&&i>0)throw new Error(`Missing type on ListTag but length is ${i}`);const s=[];for(let a=0;a<i;a+=1)s.push(et.fromBytes(e,r));return new xt(s,r)}}et.register(D.List,xt);const dt=class extends et{constructor(e){super();_(this,"value");this.value=dt.toPair(e)}static toPair(e){return Array.isArray(e)?e:dt.bigintToPair(e)}static bigintToPair(e){return dt.dataview.setBigInt64(0,e),[dt.dataview.getInt32(0),dt.dataview.getInt32(4)]}static pairToBigint(e){return dt.dataview.setInt32(0,Number(e[0])),dt.dataview.setInt32(4,Number(e[1])),dt.dataview.getBigInt64(0)}static pairToString(e){return dt.pairToBigint(e).toString()}static pairToNumber(e){return Number(dt.pairToBigint(e))}getId(){return D.Long}equals(e){return e.isLong()&&this.value[0]===e.value[0]&&this.value[1]===e.value[1]}getAsNumber(){return dt.pairToNumber(this.value)}getAsPair(){return this.value}toBigInt(){return dt.pairToBigint(this.value)}toString(){return dt.pairToString(this.value)+"L"}toPrettyString(){return this.toString()}toSimplifiedJson(){return dt.pairToNumber(this.value)}toJson(){return this.value}toBytes(e){e.writeInt(this.value[0]),e.writeInt(this.value[1])}static create(){return new dt([0,0])}static fromJson(e){return new dt(Array.isArray(e)&&e.length===2?e.map(r=>typeof r=="number"?r:0):[0,0])}static fromBytes(e){const r=e.readInt(),i=e.readInt();return new dt([r,i])}};let Le=dt;_(Le,"dataview",new DataView(new Uint8Array(8).buffer)),et.register(D.Long,Le);class pe extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="bigint"||Array.isArray(e)?new Le(e):e))}getId(){return D.LongArray}equals(t){return t.isLongArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return D.Long}get length(){return this.items.length}toString(){return"[I;"+this.items.map(e=>e.toString()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsPair())}toJson(){return this.items.map(t=>t.getAsPair())}toBytes(t){t.writeInt(this.items.length);for(const e of this.items){const[r,i]=e.getAsPair();t.writeInt(r),t.writeInt(i)}}static create(){return new pe}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readPair(i,a=>{var o;return(o=u.Json.readNumber(a))!=null?o:0}))!=null?s:[0,0]}))!=null?r:[];return new pe(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let i=0;i<e;i+=1)r.push([t.readInt(),t.readInt()]);return new pe(r)}}et.register(D.LongArray,pe);class Pe extends et{constructor(e){super();_(this,"value");this.value=e}getId(){return D.Short}equals(e){return e.isShort()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"s"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeShort(this.value)}static create(){return new Pe(0)}static fromJson(e){return new Pe(typeof e=="number"?Math.floor(e):0)}static fromBytes(e){const r=e.readShort();return new Pe(r)}}et.register(D.Short,Pe);const en=class extends et{constructor(e){super();_(this,"value");this.value=e}getId(){return D.String}equals(e){return e.isString()&&this.value===e.value}getAsString(){return this.value}toString(){return'"'+this.value.replace(/(\\|")/g,"\\$1")+'"'}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeString(this.value)}static create(){return en.EMPTY}static fromJson(e){return new en(typeof e=="string"?e:"")}static fromBytes(e){const r=e.readString();return new en(r)}};let bt=en;_(bt,"EMPTY",new en("")),et.register(D.String,bt);var Qn;(n=>{const t=new RegExp("^[-+]?(?:[0-9]+[.]|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?$","i"),e=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?d$","i"),r=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?f$","i"),i=new RegExp("^[-+]?(?:0|[1-9][0-9]*)b$","i"),s=new RegExp("^[-+]?(?:0|[1-9][0-9]*)l$","i"),a=new RegExp("^[-+]?(?:0|[1-9][0-9]*)s$","i"),o=new RegExp("^[-+]?(?:0|[1-9][0-9]*)$","i");function g(f){if(f.skipWhitespace(),!f.canRead())throw f.createError("Expected value");const w=f.peek();if(w==="{")return c(f);if(w==="[")if(f.canRead(3)&&!It.isQuotedStringStart(f.peek(1))&&f.peek(2)===";"){f.expect("[",!0);const v=f.cursor,m=f.read();if(f.skip(),f.skipWhitespace(),f.canRead()){if(m==="B")return h(f,me,D.ByteArray,D.Byte);if(m==="L")return h(f,pe,D.LongArray,D.Long);if(m==="I")return h(f,we,D.IntArray,D.Int);throw f.cursor=v,f.createError(`Invalid array type '${m}'`)}else throw f.createError("Expected value")}else return l(f);else{f.skipWhitespace();const v=f.cursor;if(It.isQuotedStringStart(f.peek()))return new bt(f.readQuotedString());{const m=f.readUnquotedString();if(m.length===0)throw f.cursor=v,f.createError("Expected value");try{if(r.test(m)){const p=Number(m.substring(0,m.length-1));return new Te(p)}else if(i.test(m)){const p=Number(m.substring(0,m.length-1));return new Pt(Math.floor(p))}else if(s.test(m)){const p=BigInt(m.substring(0,m.length-1));return new Le(p)}else if(a.test(m)){const p=Number(m.substring(0,m.length-1));return new Pe(Math.floor(p))}else if(o.test(m)){const p=Number(m);return new Ft(Math.floor(p))}else if(e.test(m)){const p=Number(m.substring(0,m.length-1));return new ne(p)}else if(t.test(m)){const p=Number(m);return new ne(p)}else{if(m.toLowerCase()==="true")return Pt.ONE;if(m.toLowerCase()==="false")return Pt.ZERO}}catch{}return m.length===0?bt.EMPTY:new bt(m)}}}n.readTag=g;function c(f){f.expect("{",!0);const w=new Map;for(f.skipWhitespace();f.canRead()&&f.peek()!=="}";){const v=f.cursor;if(f.skipWhitespace(),!f.canRead())throw f.createError("Expected key");const m=f.readString();if(m.length===0)throw f.cursor=v,f.createError("Expected key");f.expect(":",!0);const p=g(f);if(w.set(m,p),!d(f))break;if(!f.canRead())throw f.createError("Expected key")}return f.expect("}",!0),new mt(w)}function l(f){if(f.expect("[",!0),f.skipWhitespace(),!f.canRead())throw f.createError("Expected value");const w=[];let v=D.End;for(;f.peek()!=="]";){const m=f.cursor,p=g(f),S=p.getId();if(v===D.End)v=S;else if(S!==v)throw f.cursor=m,f.createError(`Can't insert ${D[S]} into list of ${D[v]}`);if(w.push(p),!d(f))break;if(!f.canRead())throw f.createError("Expected value")}return f.expect("]",!0),new xt(w,v)}function h(f,w,v,m){const p=[];for(;f.peek()!=="]";){const S=g(f);if(S.getId()!==m)throw f.createError(`Can't insert ${D[S.getId()]} into ${D[v]}`);if(p.push(S.isLong()?S.getAsPair():S.getAsNumber()),!d(f))break;if(!f.canRead())throw f.createError("Expected value")}return f.expect("]"),new w(p)}function d(f){return f.skipWhitespace(),f.canRead()&&f.peek()===","?(f.skip(),f.skipWhitespace(),!0):!1}})(Qn||(Qn={}));class mt extends et{constructor(e){super();_(this,"properties");this.properties=e!=null?e:new Map}getId(){return D.Compound}equals(e){return e.isCompound()&&this.size===e.size&&[...this.properties.entries()].every(([r,i])=>{const s=e.properties.get(r);return s!==void 0&&i.equals(s)})}has(e){return this.properties.has(e)}hasNumber(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isNumber())!=null?i:!1}hasString(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isString())!=null?i:!1}hasList(e,r,i){var a;const s=this.get(e);return(a=(s==null?void 0:s.isList())&&(r===void 0||s.getType()===r)&&(i===void 0||s.length===i))!=null?a:!1}hasCompound(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isCompound())!=null?i:!1}get(e){return this.properties.get(e)}getString(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.getAsString())!=null?i:""}getNumber(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.getAsNumber())!=null?i:0}getBoolean(e){return this.getNumber(e)!==0}getList(e,r){const i=this.get(e);return(i==null?void 0:i.isList())&&(r===void 0||i.getType()===r)?i:xt.create()}getCompound(e){const r=this.get(e);return r!=null&&r.isCompound()?r:mt.create()}getByteArray(e){const r=this.get(e);return r!=null&&r.isByteArray()?r:me.create()}getIntArray(e){const r=this.get(e);return r!=null&&r.isIntArray()?r:we.create()}getLongArray(e){const r=this.get(e);return r!=null&&r.isLongArray()?r:pe.create()}keys(){return this.properties.keys()}get size(){return this.properties.size}map(e){return Object.fromEntries([...this.properties.entries()].map(([r,i])=>e(r,i,this)))}forEach(e){[...this.properties.entries()].forEach(([r,i])=>e(r,i,this))}set(e,r){return this.properties.set(e,r),this}delete(e){return this.properties.delete(e)}clear(){return this.properties.clear(),this}toString(){const e=[];for(const[r,i]of this.properties.entries()){const s=r.split("").some(a=>!It.isAllowedInUnquotedString(a));e.push((s?JSON.stringify(r):r)+":"+i.toString())}return"{"+e.join(",")+"}"}toPrettyString(e="  ",r=0){if(this.size===0)return"{}";const i=e.repeat(r),s=e.repeat(r+1),a=[];for(const[o,g]of this.properties.entries()){const c=o.split("").some(l=>!It.isAllowedInUnquotedString(l));a.push((c?JSON.stringify(o):o)+": "+g.toPrettyString(e,r+1))}return`{
`+a.map(o=>s+o).join(`,
`)+`
`+i+"}"}toSimplifiedJson(){return this.map((e,r)=>[e,r.toSimplifiedJson()])}toJson(){return this.map((e,r)=>[e,{type:r.getId(),value:r.toJson()}])}toBytes(e){for(const[r,i]of this.properties.entries()){const s=i.getId();e.writeByte(s),e.writeString(r),i.toBytes(e)}e.writeByte(D.End)}static create(){return new mt}static fromString(e){return Qn.readTag(e)}static fromJson(e){const r=u.Json.readMap(e,i=>{var c;const{type:s,value:a}=(c=u.Json.readObject(i))!=null?c:{},o=u.Json.readNumber(s);return et.fromJson(a!=null?a:{},o)});return new mt(new Map(Object.entries(r)))}static fromBytes(e){const r=new Map;for(;;){const i=e.readByte();if(i===D.End)break;const s=e.readString(),a=et.fromBytes(e,i);r.set(s,a)}return new mt(r)}}et.register(D.Compound,mt);const ye=class{constructor(t,e,r,i,s){this.name=t,this.root=e,this.compression=r,this.littleEndian=i,this.bedrockHeader=s}writeNamedTag(t){t.writeByte(D.Compound),t.writeString(this.name),this.root.toBytes(t)}write(){const t=this.littleEndian===!0||this.bedrockHeader!==void 0,e=new hi({littleEndian:t,offset:this.bedrockHeader&&8});if(this.writeNamedTag(e),this.bedrockHeader!==void 0){const i=e.offset;e.offset=0,e.writeInt(this.bedrockHeader),e.writeInt(i-8),e.offset=i}const r=e.getData();return this.compression==="gzip"?Zr.gzip(r):this.compression==="zlib"?Zr.deflate(r):r}static readNamedTag(t){if(t.readByte()!==D.Compound)throw new Error("Top tag should be a compound");return{name:t.readString(),root:mt.fromBytes(t)}}static create(t={}){var o,g,c;const e=(o=t.name)!=null?o:ye.DEFAULT_NAME,r=mt.create(),i=(g=t.compression)!=null?g:"none",s=typeof t.bedrockHeader=="boolean"?ye.DEFAULT_BEDROCK_HEADER:t.bedrockHeader,a=(c=t.littleEndian)!=null?c:t.bedrockHeader!==void 0;return new ye(e,r,i,a,s)}static read(t,e={}){var d;const r=typeof e.bedrockHeader=="number"?e.bedrockHeader:e.bedrockHeader?ia(t):void 0,i=e.compression==="gzip"||!r&&e.compression===void 0&&Rt(t),s=e.compression==="zlib"||!r&&e.compression===void 0&&Ee(t),a=s||i?Zr.inflate(t):t,o=e.littleEndian||r!==void 0,g=i?"gzip":s?"zlib":"none",c=new ui(a,{littleEndian:o,offset:r&&8}),{name:l,root:h}=ye.readNamedTag(c);return new ye((d=e.name)!=null?d:l,h,g,o,r)}toJson(){var t;return{name:this.name,root:this.root.toJson(),compression:this.compression,littleEndian:this.littleEndian,bedrockHeader:(t=this.bedrockHeader)!=null?t:null}}static fromJson(t){var g,c,l,h,d;const e=(g=u.Json.readObject(t))!=null?g:{},r=(c=u.Json.readString(e.name))!=null?c:"",i=mt.fromJson((l=e.root)!=null?l:{}),s=(h=u.Json.readString(e.compression))!=null?h:"none",a=(d=u.Json.readBoolean(e.littleEndian))!=null?d:!1,o=u.Json.readNumber(e.bedrockHeader);return new ye(r,i,s,a,o)}};let Yt=ye;_(Yt,"DEFAULT_NAME",""),_(Yt,"DEFAULT_BEDROCK_HEADER",4);class ee{constructor(t,e,r,i,s){_(this,"file");_(this,"dirty");this.x=t,this.z=e,this.compression=r,this.timestamp=i,this.raw=s,this.dirty=!1}getCompression(){switch(this.compression){case 1:return"gzip";case 2:return"zlib";case 3:return"none";default:throw new Error(`Invalid compression mode ${this.compression}`)}}setCompression(t){switch(t){case"gzip":this.compression=1;break;case"zlib":this.compression=2;break;case"none":this.compression=3;break;default:throw new Error(`Invalid compression mode ${t}`)}}getFile(){return this.file===void 0&&(this.file=Yt.read(this.raw,{compression:this.getCompression()})),this.file}getRoot(){return this.getFile().root}setRoot(t){this.file===void 0&&(this.file=Yt.create({compression:this.getCompression()})),this.file.root=t,this.markDirty()}markDirty(){this.dirty=!0}getRaw(){if(this.file===void 0||this.dirty===!1)return this.raw;this.file.compression=this.getCompression();const t=this.file.write();return this.raw=t,this.dirty=!1,t}toJson(){return{x:this.x,z:this.z,compression:this.compression,timestamp:this.timestamp,size:this.raw.byteLength}}toRef(t){return new ee.Ref(this.x,this.z,this.compression,this.timestamp,this.raw.byteLength,t)}static create(t,e,r,i){const s=new ee(t,e,0,i!=null?i:0,r.write());return s.setCompression(r.compression),s}static fromJson(t,e){var c,l,h,d,f,w;const r=(c=u.Json.readObject(t))!=null?c:{},i=(l=u.Json.readInt(r.x))!=null?l:0,s=(h=u.Json.readInt(r.z))!=null?h:0,a=(d=u.Json.readNumber(r.compression))!=null?d:2,o=(f=u.Json.readInt(r.timestamp))!=null?f:0,g=(w=u.Json.readInt(r.size))!=null?w:0;return new ee.Ref(i,s,a,o,g,e)}}(n=>{class t{constructor(r,i,s,a,o,g){_(this,"file");this.x=r,this.z=i,this.compression=s,this.timestamp=a,this.size=o,this.resolver=g}getFile(){if(this.file instanceof Yt)return this.file}getRoot(){if(this.file instanceof Yt)return this.file.root}async getFileAsync(){return this.file?this.file:(this.file=(async()=>{const r=await this.resolver(this.x,this.z);return this.file=r,r})(),this.file)}async getRootAsync(){return(await this.getFileAsync()).root}isResolved(){return this.file instanceof Yt}}n.Ref=t})(ee||(ee={}));class Bs{constructor(t){_(this,"chunks");this.chunks=Array(32*32).fill(void 0);for(const e of t){const r=ve.getIndex(e.x,e.z);this.chunks[r]=e}}getChunkPositions(){return this.chunks.flatMap(t=>t?[[t.x,t.z]]:[])}getChunk(t){if(!(t<0||t>=32*32))return this.chunks[t]}findChunk(t,e){return this.getChunk(ve.getIndex(t,e))}getFirstChunk(){return this.chunks.filter(t=>t!==void 0)[0]}filter(t){return this.chunks.filter(e=>e!==void 0&&t(e))}map(t){return this.chunks.flatMap(e=>e!==void 0?[t(e)]:[])}}class ve extends Bs{constructor(t){super(t)}write(){let t=0;for(const s of this.chunks)s!==void 0&&(t+=Math.ceil(s.getRaw().length/4096));const e=new Uint8Array(8192+t*4096),r=new DataView(e.buffer);let i=2;for(const s of this.chunks){if(s===void 0)continue;const a=s.getRaw(),o=4*((s.x&31)+(s.z&31)*32),g=Math.ceil(a.length/4096);r.setInt8(o,i>>16),r.setInt16(o+1,i&65535),r.setInt8(o+3,g),r.setInt32(o+4096,s.timestamp);const c=i*4096;r.setInt32(c,a.length+1),r.setInt8(c+4,s.compression),e.set(a,c+5),i+=g}return e}static read(t){const e=[];for(let r=0;r<32;r+=1)for(let i=0;i<32;i+=1){const s=4*((r&31)+(i&31)*32);if(t[s+3]===0)continue;const o=(t[s]<<16)+(t[s+1]<<8)+t[s+2],g=(t[s+4096]<<24)+(t[s+4097]<<16)+(t[s+4098]<<8)+t[s+4099],c=o*4096,l=(t[c]<<24)+(t[c+1]<<16)+(t[c+2]<<8)+t[c+3],h=t[c+4],d=t.slice(c+5,c+4+l);e.push(new ee(r,i,h,g,d))}return new ve(e)}static getIndex(t,e){return(t&31)+(e&31)*32}toJson(){return{chunks:this.map(t=>t.toJson())}}static fromJson(t,e){var a,o;const r=(a=u.Json.readObject(t))!=null?a:{},s=((o=u.Json.readArray(r.chunks))!=null?o:[]).flatMap(g=>g!==void 0?[ee.fromJson(g,e)]:[]);return new ve.Ref(s)}}(n=>{class t extends Bs{}n.Ref=t})(ve||(ve={}));class ne extends et{constructor(e){super();_(this,"value");this.value=e}getId(){return D.Double}equals(e){return e.isDouble()&&this.value===e.value}getAsNumber(){return this.value}toString(){return Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeDouble(this.value)}static create(){return new ne(0)}static fromJson(e){var r;return new ne((r=u.Json.readNumber(e))!=null?r:0)}static fromBytes(e){const r=e.readDouble();return new ne(r)}}et.register(D.Double,ne);const nn=class extends et{constructor(){super()}getId(){return D.End}equals(t){return t.isEnd()}toString(){return"END"}toPrettyString(){return this.toString()}toSimplifiedJson(){return null}toJson(){return null}toBytes(){}static create(){return nn.INSTANCE}static fromJson(){return nn.INSTANCE}static fromBytes(){return nn.INSTANCE}};let An=nn;_(An,"INSTANCE",new nn),et.register(D.End,An);function Gr(n){return typeof n=="string"?new bt(n):typeof n=="number"?Number.isInteger(n)?new Ft(n):new ne(n):typeof n=="boolean"?new Pt(n):Array.isArray(n)?new xt(n.map(Gr)):typeof n=="object"&&n!==null?new mt(new Map(Object.entries(n!=null?n:{}).map(([t,e])=>[t,Gr(e)]))):new Pt(0)}u.Direction=(n=>(n.UP="up",n.DOWN="down",n.NORTH="north",n.EAST="east",n.SOUTH="south",n.WEST="west",n))(u.Direction||{});const rl={up:[0,1,0],down:[0,-1,0],north:[0,0,-1],east:[1,0,0],south:[0,0,1],west:[-1,0,0]};(n=>{n.ALL=["up","down","north","east","south","west"];function t(e){return rl[e]}n.normal=t})(u.Direction||(u.Direction={})),u.BlockPos=void 0,(n=>{function t(h,d,f){return[h,d,f]}n.create=t,n.ZERO=n.create(0,0,0);function e(h,d,f,w){return[h[0]+d,h[1]+f,h[2]+w]}n.offset=e;function r(h,d){return[h[0]-d[0],h[1]-d[1],h[2]-d[2]]}n.subtract=r;function i(h,d){return[h[0]+d[0],h[1]+d[1],h[2]+d[2]]}n.add=i;function s(h,d){return n.offset(h,...u.Direction.normal(d))}n.towards=s;function a(h,d){return h===d?!0:h[0]===d[0]&&h[1]===d[1]&&h[2]===d[2]}n.equals=a;function o(h){return h[0]*h[0]+h[1]*h[1]+h[2]*h[2]}n.magnitude=o;function g(h){return new xt(h.map(d=>new Ft(d)))}n.toNbt=g;function c(h){return h.getAsTuple(3,d=>d!=null&&d.isInt()?d.getAsNumber():0)}n.fromNbt=c;function l(h){var f;const d=(f=u.Json.readArray(h,w=>{var v;return(v=u.Json.readInt(w))!=null?v:0}))!=null?f:[0,0,0];return t(d[0],d[1],d[2])}n.fromJson=l})(u.BlockPos||(u.BlockPos={}));const oe=class{constructor(t,e){this.namespace=t,this.path=e}is(t){return this.equals(oe.parse(t))}equals(t){return this===t?!0:t instanceof oe?this.namespace===t.namespace&&this.path===t.path:!1}toString(){return this.namespace+oe.SEPARATOR+this.path}withPrefix(t){return new oe(this.namespace,t+this.path)}static create(t){return new oe(this.DEFAULT_NAMESPACE,t)}static parse(t){const e=t.indexOf(this.SEPARATOR);if(e>=0){const r=e>=1?t.substring(0,e):this.DEFAULT_NAMESPACE,i=t.substring(e+1);return new oe(r,i)}return new oe(this.DEFAULT_NAMESPACE,t)}};let B=oe;_(B,"DEFAULT_NAMESPACE","minecraft"),_(B,"SEPARATOR",":");const St=class{constructor(t,e={}){_(this,"name");this.properties=e,this.name=typeof t=="string"?B.parse(t):t}getName(){return this.name}getProperties(){return this.properties}getProperty(t){return this.properties[t]}isFluid(){return this.is(St.WATER)||this.is(St.LAVA)}isWaterlogged(){return this.is(St.WATER)||this.is(St.LAVA)||this.is("bubble_column")||this.is("kelp")||this.is("kelp_plant")||this.is("seagrass")||this.is("tall_seagrass")||this.properties.waterlogged==="true"}equals(t){return this.name.equals(t.name)?Object.keys(this.properties).every(e=>t.properties[e]===this.properties[e]):!1}is(t){return typeof t=="string"?this.name.equals(B.parse(t)):t instanceof B?this.name.equals(t):this.name.equals(t.name)}toString(){return Object.keys(this.properties).length===0?this.name.toString():`${this.name.toString()}[${Object.entries(this.properties).map(([t,e])=>t+"="+e).join(",")}]`}static parse(t){const e=t.indexOf("[");if(e===-1)return new St(t);{const r=t.substring(0,e),i=t.substring(e+1,t.length-1).split(","),s=Object.fromEntries(i.map(a=>a.split("=")));return new St(r,s)}}static fromNbt(t){const e=B.parse(t.getString("Name")),r=t.getCompound("Properties").map((i,s)=>[i,s.getAsString()]);return new St(e,r)}static fromJson(t){var s,a;const e=(s=u.Json.readObject(t))!=null?s:{},r=B.parse((a=u.Json.readString(e.Name))!=null?a:St.STONE.name.toString()),i=u.Json.readMap(e.Properties,o=>{var g;return(g=u.Json.readString(o))!=null?g:""});return new St(r,i)}};let X=St;_(X,"AIR",new St(B.create("air"))),_(X,"STONE",new St(B.create("stone"))),_(X,"WATER",new St(B.create("water"),{level:"0"})),_(X,"LAVA",new St(B.create("lava"),{level:"0"}));class Ts{constructor(t,e){_(this,"storage");_(this,"palette");this.size=t,this.defaultValue=e,this.storage=Array(t).fill(0),this.palette=[e]}index(t,e,r){return(t<<8)+(e<<4)+r}get(t,e,r){const i=this.storage[this.index(t,e,r)];return this.palette[i]}set(t,e,r,i){let s=this.palette.findIndex(a=>a.equals(i));s===-1&&(s=this.palette.length,this.palette.push(i)),this.storage[this.index(t,e,r)]=s}}const rn=class{constructor(t){_(this,"states");this.minY=t,this.states=new Ts(rn.SIZE,X.AIR)}get minBlockY(){return this.minY<<4}getBlockState(t,e,r){return this.states.get(t,e,r)}setBlockState(t,e,r,i){this.states.set(t,e,r,i)}};let je=rn;_(je,"WIDTH",16),_(je,"SIZE",rn.WIDTH*rn.WIDTH*rn.WIDTH);class il{constructor(t,e,r){_(this,"sections");this.minY=t,this.height=e,this.pos=r,this.sections=Array(this.sectionsCount).fill(null)}get maxY(){return this.minY+this.height}get minSection(){return this.minY>>4}get maxSection(){return(this.maxY-1>>4)+1}get sectionsCount(){return this.maxSection-this.minSection}getSectionIndex(t){return(t>>4)-this.minSection}getBlockState(t){var a;const[e,r,i]=t,s=this.sections[this.getSectionIndex(r)];return(a=s==null?void 0:s.getBlockState(e&15,r&15,i&15))!=null?a:X.AIR}setBlockState(t,e){const[r,i,s]=t,a=this.getSectionIndex(i);let o=this.sections[a];if(o===null){if(e.equals(X.AIR))return;o=this.getOrCreateSection(a)}o.setBlockState(r&15,i&15,s&15,e)}getOrCreateSection(t){return this.sections[t]==null&&(this.sections[t]=new je(this.minSection+t)),this.sections[t]}}u.ChunkPos=void 0,(n=>{function t(l,h){return[l,h]}n.create=t;function e(l){return[l[0]>>4,l[2]>>4]}n.fromBlockPos=e;function r(l){return[Number(l)&4294967295,Number(l>>BigInt(32))]}n.fromLong=r;function i(l){return s(l[0],l[1])}n.toLong=i;function s(l,h){return BigInt(l&4294967295)|BigInt(h&4294967295)<<BigInt(32)}n.asLong=s;function a(l){return l[0]<<4}n.minBlockX=a;function o(l){return l[1]<<4}n.minBlockZ=o;function g(l){return(l[0]<<4)+15}n.maxBlockX=g;function c(l){return(l[1]<<4)+15}n.maxBlockZ=c})(u.ChunkPos||(u.ChunkPos={}));const Ls=new Map([["minecraft:speed",3402751],["minecraft:slowness",9154528],["minecraft:haste",14270531],["minecraft:mining_fatigue",4866583],["minecraft:strength",16762624],["minecraft:instant_health",16262179],["minecraft:instant_damage",11101546],["minecraft:jump_boost",16646020],["minecraft:nausea",5578058],["minecraft:regeneration",13458603],["minecraft:resistance",9520880],["minecraft:fire_resistance",16750848],["minecraft:water_breathing",10017472],["minecraft:invisibility",16185078],["minecraft:blindness",2039587],["minecraft:night_vision",12779366],["minecraft:hunger",5797459],["minecraft:weakness",4738376],["minecraft:poison",8889187],["minecraft:wither",7561558],["minecraft:health_boost",16284963],["minecraft:absorption",2445989],["minecraft:saturation",16262179],["minecraft:glowing",9740385],["minecraft:levitation",13565951],["minecraft:luck",5882118],["minecraft:unluck",12624973],["minecraft:slow_falling",15978425],["minecraft:conduit_power",1950417],["minecraft:dolphins_grace",8954814],["minecraft:bad_omen",745784],["minecraft:hero_of_the_village",4521796],["minecraft:darkness",2696993],["minecraft:trial_omen",1484454],["minecraft:raid_omen",14565464],["minecraft:wind_charged",12438015],["minecraft:weaving",7891290],["minecraft:oozing",10092451],["minecraft:infested",9214860]]);u.MobEffectInstance=void 0,(n=>{function t(e){return{effect:B.parse(e.getString("id")),duration:e.getNumber("duration"),amplifier:e.getNumber("amplifier")}}n.fromNbt=t})(u.MobEffectInstance||(u.MobEffectInstance={}));const Ps=new Map([["minecraft:empty",[]],["minecraft:water",[]],["minecraft:mundane",[]],["minecraft:thick",[]],["minecraft:awkward",[]],["minecraft:night_vision",[{effect:B.create("night_vision"),duration:3600,amplifier:0}]],["minecraft:long_night_vision",[{effect:B.create("night_vision"),duration:9600,amplifier:0}]],["minecraft:invisibility",[{effect:B.create("invisibility"),duration:3600,amplifier:0}]],["minecraft:long_invisibility",[{effect:B.create("invisibility"),duration:9600,amplifier:0}]],["minecraft:leaping",[{effect:B.create("jump_boost"),duration:3600,amplifier:0}]],["minecraft:long_leaping",[{effect:B.create("jump_boost"),duration:9600,amplifier:0}]],["minecraft:strong_leaping",[{effect:B.create("jump_boost"),duration:1800,amplifier:1}]],["minecraft:fire_resistance",[{effect:B.create("fire_resistance"),duration:3600,amplifier:0}]],["minecraft:long_fire_resistance",[{effect:B.create("fire_resistance"),duration:9600,amplifier:0}]],["minecraft:swiftness",[{effect:B.create("speed"),duration:3600,amplifier:0}]],["minecraft:long_swiftness",[{effect:B.create("speed"),duration:9600,amplifier:0}]],["minecraft:strong_swiftness",[{effect:B.create("speed"),duration:1800,amplifier:1}]],["minecraft:slowness",[{effect:B.create("slowness"),duration:1800,amplifier:0}]],["minecraft:long_slowness",[{effect:B.create("slowness"),duration:4800,amplifier:0}]],["minecraft:strong_slowness",[{effect:B.create("slowness"),duration:400,amplifier:3}]],["minecraft:turtle_master",[{effect:B.create("slowness"),duration:400,amplifier:3},{effect:B.create("resistance"),duration:400,amplifier:2}]],["minecraft:long_turtle_master",[{effect:B.create("slowness"),duration:800,amplifier:3},{effect:B.create("resistance"),duration:800,amplifier:2}]],["minecraft:strong_turtle_master",[{effect:B.create("slowness"),duration:400,amplifier:5},{effect:B.create("resistance"),duration:400,amplifier:3}]],["minecraft:water_breathing",[{effect:B.create("water_breathing"),duration:3600,amplifier:0}]],["minecraft:long_water_breathing",[{effect:B.create("water_breathing"),duration:9600,amplifier:0}]],["minecraft:healing",[{effect:B.create("instant_health"),duration:1,amplifier:0}]],["minecraft:strong_healing",[{effect:B.create("instant_health"),duration:1,amplifier:1}]],["minecraft:harming",[{effect:B.create("instant_damage"),duration:1,amplifier:0}]],["minecraft:strong_harming",[{effect:B.create("instant_damage"),duration:1,amplifier:1}]],["minecraft:poison",[{effect:B.create("poison"),duration:900,amplifier:0}]],["minecraft:long_poison",[{effect:B.create("poison"),duration:1800,amplifier:0}]],["minecraft:strong_poison",[{effect:B.create("poison"),duration:432,amplifier:1}]],["minecraft:regeneration",[{effect:B.create("regeneration"),duration:900,amplifier:0}]],["minecraft:long_regeneration",[{effect:B.create("regeneration"),duration:1800,amplifier:0}]],["minecraft:strong_regeneration",[{effect:B.create("regeneration"),duration:450,amplifier:1}]],["minecraft:strength",[{effect:B.create("strength"),duration:3600,amplifier:0}]],["minecraft:long_strength",[{effect:B.create("strength"),duration:9600,amplifier:0}]],["minecraft:strong_strength",[{effect:B.create("strength"),duration:1800,amplifier:1}]],["minecraft:weakness",[{effect:B.create("weakness"),duration:1800,amplifier:0}]],["minecraft:long_weakness",[{effect:B.create("weakness"),duration:4800,amplifier:0}]],["minecraft:luck",[{effect:B.create("luck"),duration:6e3,amplifier:0}]],["minecraft:slow_falling",[{effect:B.create("slow_falling"),duration:1800,amplifier:0}]],["minecraft:long_slow_falling",[{effect:B.create("slow_falling"),duration:4800,amplifier:0}]],["minecraft:wind_charged",[{effect:B.create("wind_charged"),duration:3600,amplifier:0}]],["minecraft:weaving",[{effect:B.create("weaving"),duration:3600,amplifier:0}]],["minecraft:oozing",[{effect:B.create("oozing"),duration:3600,amplifier:0}]],["minecraft:infested",[{effect:B.create("infested"),duration:3600,amplifier:0}]]]);u.PotionContents=void 0,(n=>{function t(s){const a={};return s.isString()?a.potion=B.parse(s.getAsString()):s.isCompound()&&(s.hasString("potion")&&(a.potion=B.parse(s.getString("potion"))),s.hasNumber("custom_color")&&(a.customColor=s.getNumber("custom_color")),s.hasList("custom_effects")&&(a.customEffects=s.getList("custom_effects",D.Compound).map(u.MobEffectInstance.fromNbt))),a}n.fromNbt=t;function e(s){if(s.customColor)return u.Color.intToRgb(s.customColor);const a=r(s);return i(a)}n.getColor=e;function r(s){var o;const a=[];return s.potion&&a.push(...(o=Ps.get(s.potion.toString()))!=null?o:[]),s.customEffects&&a.push(...s.customEffects),a}n.getAllEffects=r;function i(s){let[a,o,g]=[0,0,0],c=0;for(const l of s){const h=Ls.get(l.effect.toString());if(h===void 0)continue;const d=u.Color.intToRgb(h),f=l.amplifier+1;a+=f*d[0],o+=f*d[1],g+=f*d[2],c+=f}return c===0?u.Color.intToRgb(-13083194):(a=a/c,o=o/c,g=g/c,[a,o,g])}})(u.PotionContents||(u.PotionContents={})),u.Holder=void 0,(n=>{function t(i,s){return a=>typeof a=="string"?r(i,B.parse(a)):e(s(a))}n.parser=t;function e(i,s){return{value:()=>i,key:()=>s}}n.direct=e;function r(i,s,a=!0){return a?{value:()=>i.getOrThrow(s),key:()=>s}:{value:()=>i.get(s),key:()=>s}}n.reference=r})(u.Holder||(u.Holder={}));class _e{constructor(t){this.entries=t}static parser(t,e){const r=e!=null?e:i=>{var s;return u.Holder.reference(t,B.parse((s=u.Json.readString(i))!=null?s:""))};return i=>{var s,a;return typeof i=="string"?i.startsWith("#")?u.Holder.reference(t.getTagRegistry(),B.parse(i.substring(1))):u.Holder.direct(new _e([])):u.Holder.direct((a=new _e((s=u.Json.readArray(i,r))!=null?s:[]))!=null?a:[])}}static fromJson(t,e,r){var o,g,c;const i=(o=u.Json.readObject(e))!=null?o:{},s=(g=u.Json.readBoolean(i.replace))!=null?g:!1,a=(c=u.Json.readArray(i.values,l=>{var f,w,v;var h=!0,d="";if(typeof l=="string")d=l;else{const m=(f=u.Json.readObject(l))!=null?f:{};h=(w=u.Json.readBoolean(m.required))!=null?w:!1,d=(v=u.Json.readString(m.id))!=null?v:""}return d.startsWith("#")?u.Holder.reference(t.getTagRegistry(),B.parse(d.substring(1)),h):u.Holder.reference(t,B.parse(d),h)}))!=null?c:[];return r&&!s&&t.getTagRegistry().has(r)&&(a==null||a.push(u.Holder.direct(t.getTagRegistry().get(r)))),new _e(a)}*getEntries(){for(const t of this.entries){const e=t.value();e!==void 0&&(e instanceof _e?yield*e.getEntries():yield t)}}}class qt{constructor(t,e,r=new Map){this.id=t,this.count=e,this.components=r}getComponent(t,e){var i;if(typeof t=="string"&&(t=B.parse(t)),this.components.has("!"+t.toString()))return;const r=this.components.get(t.toString());if(r)return r;if(e)return(i=e.getItemComponents(this.id))==null?void 0:i.get(t.toString())}hasComponent(t,e){var r;return typeof t=="string"&&(t=B.parse(t)),this.components.has("!"+t.toString())?!1:this.components.has(t.toString())?!0:e?(r=e.getItemComponents(this.id))==null?void 0:r.has(t.toString()):!1}clone(){const t=new Map(this.components);return new qt(this.id,this.count,t)}is(t){return typeof t=="string"?this.id.equals(B.parse(t)):t instanceof B?this.id.equals(t):this.id.equals(t.id)}equals(t){return this===t?!0:t instanceof qt?this.count===t.count&&this.isSameItemSameComponents(t):!1}isSameItemSameComponents(t){if(!this.id.equals(t.id)||this.components.size!==t.components.size)return!1;for(const[e,r]of this.components){const i=t.components.get(e);if(r.toString()!==(i==null?void 0:i.toString()))return!1}return!0}toString(){let t=this.id.toString();return this.components.size>0&&(t+=`[${[...this.components.entries()].map(([e,r])=>e.startsWith("!")?e:`${e}=${r.toString()}`).join(",")}]`),this.count>1&&(t+=` ${this.count}`),t}static fromString(t){const e=new It(t);for(;e.canRead()&&e.peek()!=="[";)e.skip();const r=B.parse(e.getRead());if(!e.canRead())return new qt(r,1);const i=new Map;if(e.skip(),e.peek()==="]")return new qt(r,1,i);do{if(e.peek()==="!"){e.skip();const s=e.cursor;for(;e.canRead()&&e.peek()!=="]"&&e.peek()!==",";)e.skip();i.set("!"+B.parse(e.getRead(s)).toString(),new mt)}else{const s=e.cursor;for(;e.canRead()&&e.peek()!=="=";)e.skip();const a=B.parse(e.getRead(s)).toString();if(!e.canRead())break;e.skip();const o=Qn.readTag(e);i.set(a,o)}if(!e.canRead())break;if(e.peek()==="]")return new qt(r,1,i);if(e.peek()!==",")throw new Error("Expected , or ]");e.skip()}while(e.canRead());throw new Error("Missing closing ]")}toNbt(){const t=new mt().set("id",new bt(this.id.toString()));return this.count>1&&t.set("count",new Ft(this.count)),this.components.size>0&&t.set("components",new mt(this.components)),t}static fromNbt(t){const e=B.parse(t.getString("id")),r=t.hasNumber("count")?t.getNumber("count"):1,i=new Map(Object.entries(t.getCompound("components").map((s,a)=>s.startsWith("!")?["!"+B.parse(s).toString(),new mt]:[B.parse(s).toString(),a])));return new qt(e,r,i)}}const Ge=class{constructor(t,e){_(this,"storage",new Map);_(this,"builtin",new Map);_(this,"tags");this.key=t,this.parser=e}static createAndRegister(t,e){const r=new Ge(B.create(t),e);return Ge.REGISTRY.register(r.key,r),r}register(t,e,r){return this.storage.set(t.toString(),e),r&&this.builtin.set(t.toString(),e),u.Holder.reference(this,t)}delete(t){const e=this.storage.delete(t.toString());return this.builtin.delete(t.toString()),e}keys(){return[...this.storage.keys()].map(t=>B.parse(t))}has(t){return this.storage.has(t.toString())}get(t){var e=this.storage.get(t.toString());return e instanceof Function&&(e=e(),this.storage.set(t.toString(),e)),e}getOrThrow(t){const e=this.get(t);if(e===void 0)throw new Error(`Missing key in ${this.key.toString()}: ${t.toString()}`);return e}parse(t){if(!this.parser)throw new Error(`No parser exists for ${this.key.toString()}`);return this.parser(t)}clear(){this.storage.clear();for(const[t,e]of this.builtin.entries())this.storage.set(t,e);return this.tags&&this.tags.clear(),this}assign(t){if(!this.key.equals(t.key))throw new Error(`Cannot assign registry of type ${t.key.toString()} to registry of type ${this.key.toString()}`);for(const e of t.keys())this.storage.set(e.toString(),t.getOrThrow(e));return this}cloneEmpty(){return new Ge(this.key,this.parser)}forEach(t){for(const[e,r]of this.storage.entries())t(B.parse(e),r instanceof Function?r():r,this)}map(t){return[...this.storage.entries()].map(([e,r])=>t(B.parse(e),r instanceof Function?r():r,this))}getTagRegistry(){return this.tags===void 0&&(this.tags=new Ge(new B(this.key.namespace,`tags/${this.key.path}`))),this.tags}};let Ct=Ge;_(Ct,"REGISTRY",new Ge(B.create("root"))),u.Rotation=(n=>(n.NONE="none",n.CLOCKWISE_90="clockwise_90",n.CLOCKWISE_180="180",n.COUNTERCLOCKWISE_90="counterclockwise_90",n))(u.Rotation||{}),(n=>{function t(e){return["none","clockwise_90","180","counterclockwise_90"][e.nextInt(4)]}n.getRandom=t})(u.Rotation||(u.Rotation={}));const pr=class{constructor(t,e=[],r=[]){_(this,"blocksMap",[]);this.size=t,this.palette=e,this.blocks=r,r.forEach(i=>{if(!this.isInside(i.pos))throw new Error(`Found block at ${i.pos} which is outside the structure bounds ${this.size}`);this.blocksMap[i.pos[0]*t[1]*t[2]+i.pos[1]*t[2]+i.pos[2]]=i})}getSize(){return this.size}addBlock(t,e,r,i){if(!this.isInside(t))throw new Error(`Cannot add block at ${t} outside the structure bounds ${this.size}`);const s=new X(e,r);let a=this.palette.findIndex(o=>o.equals(s));return a===-1&&(a=this.palette.length,this.palette.push(s)),this.blocks.push({pos:t,state:a,nbt:i}),this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]]={pos:t,state:a,nbt:i},this}getBlocks(){return this.blocks.map(t=>this.toPlacedBlock(t))}getBlock(t){if(!this.isInside(t))return null;const e=this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]];return e?this.toPlacedBlock(e):null}toPlacedBlock(t){const e=this.palette[t.state];if(!e)throw new Error(`Block at ${t.pos.join(" ")} in structure references invalid palette index ${t.state}`);return{pos:t.pos,state:e,nbt:t.nbt}}isInside(t){return t[0]>=0&&t[0]<this.size[0]&&t[1]>=0&&t[1]<this.size[1]&&t[2]>=0&&t[2]<this.size[2]}static fromNbt(t){const e=u.BlockPos.fromNbt(t.getList("size")),r=t.getList("palette",D.Compound).map(s=>X.fromNbt(s)),i=t.getList("blocks",D.Compound).map(s=>{const a=u.BlockPos.fromNbt(s.getList("pos")),o=s.getNumber("state"),g=s.getCompound("nbt");return{pos:a,state:o,nbt:g.size>0?g:void 0}});return new pr(e,r,i)}static transform(t,e,r){switch(e){case u.Rotation.COUNTERCLOCKWISE_90:return u.BlockPos.create(r[0]-r[2]+t[2],t[1],r[0]+r[2]-t[0]);case u.Rotation.CLOCKWISE_90:return u.BlockPos.create(r[0]+r[2]-t[2],t[1],r[2]-r[0]+t[0]);case u.Rotation.CLOCKWISE_180:return u.BlockPos.create(r[0]+r[0]-t[0],t[1],r[2]+r[2]-t[2]);default:return t}}};let re=pr;_(re,"REGISTRY",Ct.createAndRegister("structures")),_(re,"EMPTY",new pr(u.BlockPos.ZERO));const sl=-2147483648,al=2147483647,ol=-9223372036854776e3,cl=9223372036854776e3;function ie(n){return n*n}function yt(n,t,e){return Math.max(t,Math.min(e,n))}function Oe(n,t,e){return t+n*(e-t)}function $r(n,t,e){return Math.fround(t+Math.fround(n*Math.fround(e-t)))}function tr(n,t,e,r,i,s){return Oe(t,Oe(n,e,r),Oe(n,i,s))}function Os(n,t,e,r,i,s,a,o,g,c,l){return Oe(e,tr(n,t,r,i,s,a),tr(n,t,o,g,c,l))}function Mn(n,t,e){return n===0?t():n===1?e():t()+n*(e()-t())}function Vr(n,t,e,r,i,s){return Mn(t,()=>Mn(n,e,r),()=>Mn(n,i,s))}function Js(n,t,e,r,i,s,a,o,g,c,l){return Mn(e,()=>Vr(n,t,r,i,s,a),()=>Vr(n,t,o,g,c,l))}function er(n,t,e){return e<0?n:e>1?t:Oe(e,n,t)}function Yr(n,t,e){return(n-t)/(e-t)}function nr(n){return n*n*n*(n*(n*6-15)+10)}function Rn(n,t,e,r,i){return Oe(Yr(n,t,e),r,i)}function qr(n,t,e,r,i){return er(r,i,Yr(n,t,e))}function Wt(n){return yt(Math.floor(n),sl,al)}function zs(n){return yt(Math.floor(n),ol,cl)}function Ds(n,t,e){let r=t-n;for(;r>0;){const i=Math.floor(r/2),s=n+i;if(e(s)){r=i;continue}n=s+1,r-=i+1}return n}function Wr(n,t,e){let r=BigInt(n*3129871)^BigInt(e)*BigInt(116129781)^BigInt(t);return r=r*r*BigInt(42317861)+r*BigInt(11),r>>BigInt(16)}function rr(n,t,e,r,i,s,a,o){return BigInt(n)<<BigInt(56)|BigInt(t)<<BigInt(48)|BigInt(e)<<BigInt(40)|BigInt(r)<<BigInt(32)|BigInt(i)<<BigInt(24)|BigInt(s)<<BigInt(16)|BigInt(a)<<BigInt(8)|BigInt(o)}function Xr(n){return(n&n-1)===0}function Fs(n){return n-=1,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>18,n|=n>>32,n+1}function ir(n,t,e){return n.nextInt(e-t+1)+t}function sr(n,t,e){return t>=e?t:n.nextInt(e-t+1)+t}function Us(n,t){for(var e=n.length;e>1;e--){const r=t.nextInt(e),i=n[r];n[r]=n[e-1],n[e-1]=i}}u.MinMaxNumberFunction=void 0,(n=>{function t(e){return typeof e=="object"&&e!==null&&"minValue"in e&&"maxValue"in e}n.is=t})(u.MinMaxNumberFunction||(u.MinMaxNumberFunction={})),u.CubicSpline=void 0,(n=>{function t(i,s){var c,l,h,d;if(typeof i=="number")return new e(i);const a=(c=u.Json.readObject(i))!=null?c:{},o=new r(s(a.coordinate)),g=(l=u.Json.readArray(a.points,f=>{var w;return(w=u.Json.readObject(f))!=null?w:{}}))!=null?l:[];if(g.length===0)return new e(0);for(const f of g){const w=(h=u.Json.readNumber(f.location))!=null?h:0,v=t(f.value,s),m=(d=u.Json.readNumber(f.derivative))!=null?d:0;o.addPoint(w,v,m)}return o}n.fromJson=t;class e{constructor(s){this.value=s}compute(){return this.value}min(){return this.value}max(){return this.value}mapAll(){return this}calculateMinMax(){}}n.Constant=e;class r{constructor(s,a=[],o=[],g=[]){_(this,"calculatedMin",Number.NEGATIVE_INFINITY);_(this,"calculatedMax",Number.POSITIVE_INFINITY);this.coordinate=s,this.locations=a,this.values=o,this.derivatives=g}compute(s){const a=this.coordinate.compute(s),o=Ds(0,this.locations.length,E=>a<this.locations[E])-1,g=this.locations.length-1;if(o<0)return Math.fround(this.values[0].compute(s)+Math.fround(this.derivatives[0]*Math.fround(a-this.locations[0])));if(o===g)return Math.fround(this.values[g].compute(s)+Math.fround(this.derivatives[g]*Math.fround(a-this.locations[g])));const c=this.locations[o],l=this.locations[o+1],h=this.derivatives[o],d=this.derivatives[o+1],f=Math.fround(Math.fround(a-c)/Math.fround(l-c)),w=this.values[o].compute(s),v=this.values[o+1].compute(s),m=Math.fround(Math.fround(h*Math.fround(l-c))-Math.fround(v-w)),p=Math.fround(Math.fround(-d*Math.fround(l-c))+Math.fround(v-w));return Math.fround($r(f,w,v)+Math.fround(Math.fround(f*Math.fround(1-f))*$r(f,m,p)))}min(){return this.calculatedMin}max(){return this.calculatedMax}mapAll(s){return new r(s(this.coordinate),this.locations,this.values.map(a=>a.mapAll(s)),this.derivatives)}addPoint(s,a,o=0){return this.locations.push(Math.fround(s)),this.values.push(typeof a=="number"?new n.Constant(Math.fround(a)):a),this.derivatives.push(Math.fround(o)),this}calculateMinMax(){if(!u.MinMaxNumberFunction.is(this.coordinate))return;const s=this.locations.length-1;var a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const g=this.coordinate.minValue(),c=this.coordinate.maxValue();for(const h of this.values)h.calculateMinMax();if(g<this.locations[0]){const h=r.linearExtend(g,this.locations,this.values[0].min(),this.derivatives,0),d=r.linearExtend(g,this.locations,this.values[0].max(),this.derivatives,0);a=Math.min(a,Math.min(h,d)),o=Math.max(o,Math.max(h,d))}if(c>this.locations[s]){const h=r.linearExtend(c,this.locations,this.values[s].min(),this.derivatives,s),d=r.linearExtend(c,this.locations,this.values[s].max(),this.derivatives,s);a=Math.min(a,Math.min(h,d)),o=Math.max(o,Math.max(h,d))}for(const h of this.values)a=Math.min(a,h.min()),o=Math.max(o,h.max());for(var l=0;l<s;++l){const h=this.locations[l],d=this.locations[l+1],f=Math.fround(d-h),w=this.values[l],v=this.values[l+1],m=w.min(),p=w.max(),S=v.min(),E=v.max(),y=this.derivatives[l],x=this.derivatives[l+1];if(y!==0||x!==0){const A=Math.fround(y*f),I=Math.fround(x*f),R=Math.min(m,S),C=Math.max(p,E),M=Math.fround(Math.fround(A-E)+m),N=Math.fround(Math.fround(A-S)+p),L=Math.fround(Math.fround(-I+S)-p),F=Math.fround(Math.fround(-I+E)-m),U=Math.min(M,L),T=Math.max(N,F);a=Math.min(a,Math.fround(R+Math.fround(.25*U))),o=Math.max(o,Math.fround(C+Math.fround(.25*T)))}}this.calculatedMin=a,this.calculatedMax=o}static linearExtend(s,a,o,g,c){const l=g[c];return l==0?o:Math.fround(o+Math.fround(l*Math.fround(s-a[c])))}}n.MultiPoint=r})(u.CubicSpline||(u.CubicSpline={}));var ar=1e-6,se=typeof Float32Array<"u"?Float32Array:Array,ll=Math.PI/180;function jr(n){return n*ll}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function Kr(){var n=new se(9);return se!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function ul(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n}function hl(n){var t=new se(9);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function fl(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function dl(n,t){if(n===t){var e=t[1],r=t[2],i=t[5];n[1]=t[3],n[2]=t[6],n[3]=e,n[5]=t[7],n[6]=r,n[7]=i}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n}function gl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],g=t[6],c=t[7],l=t[8],h=l*a-o*c,d=-l*s+o*g,f=c*s-a*g,w=e*h+r*d+i*f;return w?(w=1/w,n[0]=h*w,n[1]=(-l*r+i*c)*w,n[2]=(o*r-i*a)*w,n[3]=d*w,n[4]=(l*e-i*g)*w,n[5]=(-o*e+i*s)*w,n[6]=f*w,n[7]=(-c*e+r*g)*w,n[8]=(a*e-r*s)*w,n):null}function ml(n,t,e){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],g=t[5],c=t[6],l=t[7],h=t[8],d=e[0],f=e[1],w=e[2],v=e[3],m=e[4],p=e[5],S=e[6],E=e[7],y=e[8];return n[0]=d*r+f*a+w*c,n[1]=d*i+f*o+w*l,n[2]=d*s+f*g+w*h,n[3]=v*r+m*a+p*c,n[4]=v*i+m*o+p*l,n[5]=v*s+m*g+p*h,n[6]=S*r+E*a+y*c,n[7]=S*i+E*o+y*l,n[8]=S*s+E*g+y*h,n}function wl(n,t,e){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],g=t[5],c=t[6],l=t[7],h=t[8],d=e[0],f=e[1];return n[0]=r,n[1]=i,n[2]=s,n[3]=a,n[4]=o,n[5]=g,n[6]=d*r+f*a+c,n[7]=d*i+f*o+l,n[8]=d*s+f*g+h,n}function pl(n,t,e){var r=e[0],i=e[1];return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=i*t[3],n[4]=i*t[4],n[5]=i*t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function vl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=e+e,o=r+r,g=i+i,c=e*a,l=r*a,h=r*o,d=i*a,f=i*o,w=i*g,v=s*a,m=s*o,p=s*g;return n[0]=1-h-w,n[3]=l-p,n[6]=d+m,n[1]=l+p,n[4]=1-c-w,n[7]=f-v,n[2]=d-m,n[5]=f+v,n[8]=1-c-h,n}function _l(n){return"mat3("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+")"}function bl(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n}function yl(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n}function Sl(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n}var El=ml,Il=yl;function nt(){var n=new se(16);return se!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function kl(n){var t=new se(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Al(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Ml(n,t){if(n===t){var e=t[1],r=t[2],i=t[3],s=t[6],a=t[7],o=t[11];n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=e,n[6]=t[9],n[7]=t[13],n[8]=r,n[9]=s,n[11]=t[14],n[12]=i,n[13]=a,n[14]=o}else n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15];return n}function Rl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],g=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],w=t[12],v=t[13],m=t[14],p=t[15],S=e*o-r*a,E=e*g-i*a,y=e*c-s*a,x=r*g-i*o,A=r*c-s*o,I=i*c-s*g,R=l*v-h*w,C=l*m-d*w,M=l*p-f*w,N=h*m-d*v,L=h*p-f*v,F=d*p-f*m,U=S*F-E*L+y*N+x*M-A*C+I*R;return U?(U=1/U,n[0]=(o*F-g*L+c*N)*U,n[1]=(i*L-r*F-s*N)*U,n[2]=(v*I-m*A+p*x)*U,n[3]=(d*A-h*I-f*x)*U,n[4]=(g*M-a*F-c*C)*U,n[5]=(e*F-i*M+s*C)*U,n[6]=(m*y-w*I-p*E)*U,n[7]=(l*I-d*y+f*E)*U,n[8]=(a*L-o*M+c*R)*U,n[9]=(r*M-e*L-s*R)*U,n[10]=(w*A-v*y+p*S)*U,n[11]=(h*y-l*A-f*S)*U,n[12]=(o*C-a*N-g*R)*U,n[13]=(e*N-r*C+i*R)*U,n[14]=(v*E-w*x-m*S)*U,n[15]=(l*x-h*E+d*S)*U,n):null}function xl(n,t,e){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],g=t[5],c=t[6],l=t[7],h=t[8],d=t[9],f=t[10],w=t[11],v=t[12],m=t[13],p=t[14],S=t[15],E=e[0],y=e[1],x=e[2],A=e[3];return n[0]=E*r+y*o+x*h+A*v,n[1]=E*i+y*g+x*d+A*m,n[2]=E*s+y*c+x*f+A*p,n[3]=E*a+y*l+x*w+A*S,E=e[4],y=e[5],x=e[6],A=e[7],n[4]=E*r+y*o+x*h+A*v,n[5]=E*i+y*g+x*d+A*m,n[6]=E*s+y*c+x*f+A*p,n[7]=E*a+y*l+x*w+A*S,E=e[8],y=e[9],x=e[10],A=e[11],n[8]=E*r+y*o+x*h+A*v,n[9]=E*i+y*g+x*d+A*m,n[10]=E*s+y*c+x*f+A*p,n[11]=E*a+y*l+x*w+A*S,E=e[12],y=e[13],x=e[14],A=e[15],n[12]=E*r+y*o+x*h+A*v,n[13]=E*i+y*g+x*d+A*m,n[14]=E*s+y*c+x*f+A*p,n[15]=E*a+y*l+x*w+A*S,n}function W(n,t,e){var r=e[0],i=e[1],s=e[2],a,o,g,c,l,h,d,f,w,v,m,p;return t===n?(n[12]=t[0]*r+t[4]*i+t[8]*s+t[12],n[13]=t[1]*r+t[5]*i+t[9]*s+t[13],n[14]=t[2]*r+t[6]*i+t[10]*s+t[14],n[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],g=t[2],c=t[3],l=t[4],h=t[5],d=t[6],f=t[7],w=t[8],v=t[9],m=t[10],p=t[11],n[0]=a,n[1]=o,n[2]=g,n[3]=c,n[4]=l,n[5]=h,n[6]=d,n[7]=f,n[8]=w,n[9]=v,n[10]=m,n[11]=p,n[12]=a*r+l*i+w*s+t[12],n[13]=o*r+h*i+v*s+t[13],n[14]=g*r+d*i+m*s+t[14],n[15]=c*r+f*i+p*s+t[15]),n}function Nt(n,t,e){var r=e[0],i=e[1],s=e[2];return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[3]=t[3]*r,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*s,n[9]=t[9]*s,n[10]=t[10]*s,n[11]=t[11]*s,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Cl(n,t,e,r){var i=r[0],s=r[1],a=r[2],o=Math.hypot(i,s,a),g,c,l,h,d,f,w,v,m,p,S,E,y,x,A,I,R,C,M,N,L,F,U,T;return o<ar?null:(o=1/o,i*=o,s*=o,a*=o,g=Math.sin(e),c=Math.cos(e),l=1-c,h=t[0],d=t[1],f=t[2],w=t[3],v=t[4],m=t[5],p=t[6],S=t[7],E=t[8],y=t[9],x=t[10],A=t[11],I=i*i*l+c,R=s*i*l+a*g,C=a*i*l-s*g,M=i*s*l-a*g,N=s*s*l+c,L=a*s*l+i*g,F=i*a*l+s*g,U=s*a*l-i*g,T=a*a*l+c,n[0]=h*I+v*R+E*C,n[1]=d*I+m*R+y*C,n[2]=f*I+p*R+x*C,n[3]=w*I+S*R+A*C,n[4]=h*M+v*N+E*L,n[5]=d*M+m*N+y*L,n[6]=f*M+p*N+x*L,n[7]=w*M+S*N+A*L,n[8]=h*F+v*U+E*T,n[9]=d*F+m*U+y*T,n[10]=f*F+p*U+x*T,n[11]=w*F+S*U+A*T,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n)}function xn(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[4],a=t[5],o=t[6],g=t[7],c=t[8],l=t[9],h=t[10],d=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=s*i+c*r,n[5]=a*i+l*r,n[6]=o*i+h*r,n[7]=g*i+d*r,n[8]=c*i-s*r,n[9]=l*i-a*r,n[10]=h*i-o*r,n[11]=d*i-g*r,n}function vt(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],g=t[3],c=t[8],l=t[9],h=t[10],d=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=s*i-c*r,n[1]=a*i-l*r,n[2]=o*i-h*r,n[3]=g*i-d*r,n[8]=s*r+c*i,n[9]=a*r+l*i,n[10]=o*r+h*i,n[11]=g*r+d*i,n}function Hs(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],g=t[3],c=t[4],l=t[5],h=t[6],d=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=s*i+c*r,n[1]=a*i+l*r,n[2]=o*i+h*r,n[3]=g*i+d*r,n[4]=c*i-s*r,n[5]=l*i-a*r,n[6]=h*i-o*r,n[7]=d*i-g*r,n}function Nl(n,t){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n}function Bl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=e+e,o=r+r,g=i+i,c=e*a,l=r*a,h=r*o,d=i*a,f=i*o,w=i*g,v=s*a,m=s*o,p=s*g;return n[0]=1-h-w,n[1]=l+p,n[2]=d-m,n[3]=0,n[4]=l-p,n[5]=1-c-w,n[6]=f+v,n[7]=0,n[8]=d+m,n[9]=f-v,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Tl(n,t,e,r,i){var s=1/Math.tan(t/2),a;return n[0]=s/e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(a=1/(r-i),n[10]=(i+r)*a,n[14]=2*i*r*a):(n[10]=-1,n[14]=-2*r),n}function Ll(n,t,e,r,i,s,a){var o=1/(t-e),g=1/(r-i),c=1/(s-a);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(t+e)*o,n[13]=(i+r)*g,n[14]=(a+s)*c,n[15]=1,n}function Pl(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function Ol(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n[9]=t[9]+e[9],n[10]=t[10]+e[10],n[11]=t[11]+e[11],n[12]=t[12]+e[12],n[13]=t[13]+e[13],n[14]=t[14]+e[14],n[15]=t[15]+e[15],n}function Jl(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n[9]=t[9]-e[9],n[10]=t[10]-e[10],n[11]=t[11]-e[11],n[12]=t[12]-e[12],n[13]=t[13]-e[13],n[14]=t[14]-e[14],n[15]=t[15]-e[15],n}function zl(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11]*e,n[12]=t[12]*e,n[13]=t[13]*e,n[14]=t[14]*e,n[15]=t[15]*e,n}var Dl=xl,Fl=Jl;function Qr(){var n=new se(3);return se!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Ul(n,t,e){var r=new se(3);return r[0]=n,r[1]=t,r[2]=e,r}function Hl(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n}function Zl(n,t,e){var r=t[0],i=t[1],s=t[2],a=e[3]*r+e[7]*i+e[11]*s+e[15];return a=a||1,n[0]=(e[0]*r+e[4]*i+e[8]*s+e[12])/a,n[1]=(e[1]*r+e[5]*i+e[9]*s+e[13])/a,n[2]=(e[2]*r+e[6]*i+e[10]*s+e[14])/a,n}function Gl(n,t){var e=n[0],r=n[1],i=n[2],s=t[0],a=t[1],o=t[2];return Math.abs(e-s)<=ar*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-a)<=ar*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=ar*Math.max(1,Math.abs(i),Math.abs(o))}(function(){var n=Qr();return function(t,e,r,i,s,a){var o,g;for(e||(e=3),r||(r=0),i?g=Math.min(i*e+r,t.length):g=t.length,o=r;o<g;o+=e)n[0]=t[o],n[1]=t[o+1],n[2]=t[o+2],s(n,n,a),t[o]=n[0],t[o+1]=n[1],t[o+2]=n[2];return t}})();class Cn{constructor(t){_(this,"data");this.data=t!=null?t:Kr()}static fromMatrix4(t){return new Cn(ul(Kr(),t.data))}static fromQuat(t){return new Cn(vl(Kr(),t))}clone(){return new Cn(hl(this.data))}copy(t){return fl(this.data,t.data),this}translate(t){return wl(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}scale(t){return typeof t=="number"?Sl(this.data,this.data,t):pl(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}add(t){return bl(this.data,this.data,t.data),this}sub(t){return Il(this.data,this.data,t.data),this}mul(t){return El(this.data,this.data,t.data),this}transpose(){return dl(this.data,this.data),this}invert(){return gl(this.data,this.data),this}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m10(){return this.data[3]}get m11(){return this.data[4]}get m12(){return this.data[5]}get m20(){return this.data[6]}get m21(){return this.data[7]}get m22(){return this.data[8]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m10(t){this.data[3]=t}set m11(t){this.data[4]=t}set m12(t){this.data[5]=t}set m20(t){this.data[6]=t}set m21(t){this.data[7]=t}set m22(t){this.data[8]=t}toString(){return _l(this.data)}}class Y{constructor(t,e,r){this.x=t,this.y=e,this.z=r}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}distance(t){return this.sub(t).length()}distanceSquared(t){return this.sub(t).lengthSquared()}abs(){return new Y(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))}add(t){return new Y(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new Y(this.x-t.x,this.y-t.y,this.z-t.z)}mul(t){return new Y(this.x*t.x,this.y*t.y,this.z*t.z)}div(t){return new Y(this.x/t.x,this.y/t.y,this.z/t.z)}scale(t){return new Y(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const e=this.y*t.z-this.z*t.y,r=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;return new Y(e,r,i)}normalize(){if(this.x==0&&this.y==0&&this.z==0)return this;const t=1/this.length();return new Y(this.x*t,this.y*t,this.z*t)}components(){return[this.x,this.y,this.z]}toString(){return`[${this.x} ${this.y} ${this.z}]`}}class or{constructor(t){_(this,"data");this.data=t!=null?t:nt()}static fromQuat(t){return new or(Bl(nt(),t))}clone(){return new or(kl(this.data))}translate(t){return W(this.data,this.data,Array.isArray(t)?t:t.components()),this}scale(t){return typeof t=="number"?zl(this.data,this.data,t):Nt(this.data,this.data,Array.isArray(t)?t:t.components()),this}add(t){return Ol(this.data,this.data,t.data),this}sub(t){return Fl(this.data,this.data,t.data),this}mul(t){return Dl(this.data,this.data,t.data),this}transpose(){return Ml(this.data,this.data),this}invert(){return Rl(this.data,this.data),this}affine(){return this.scale(1/this.m33)}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m03(){return this.data[3]}get m10(){return this.data[4]}get m11(){return this.data[5]}get m12(){return this.data[6]}get m13(){return this.data[7]}get m20(){return this.data[8]}get m21(){return this.data[9]}get m22(){return this.data[10]}get m23(){return this.data[11]}get m30(){return this.data[12]}get m31(){return this.data[13]}get m32(){return this.data[14]}get m33(){return this.data[15]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m03(t){this.data[3]=t}set m10(t){this.data[4]=t}set m11(t){this.data[5]=t}set m12(t){this.data[6]=t}set m13(t){this.data[7]=t}set m20(t){this.data[8]=t}set m21(t){this.data[9]=t}set m22(t){this.data[10]=t}set m23(t){this.data[11]=t}set m30(t){this.data[12]=t}set m31(t){this.data[13]=t}set m32(t){this.data[14]=t}set m33(t){this.data[15]=t}getTranslation(){const[t,e,r]=Nl(Qr(),this.data);return new Y(t,e,r)}toString(){return Pl(this.data)}}var ti={exports:{}},Zs={exports:{}};(function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(e,r){return e<<r|e>>>32-r},rotr:function(e,r){return e<<32-r|e>>>r},endian:function(e){if(e.constructor==Number)return t.rotl(e,8)&16711935|t.rotl(e,24)&4278255360;for(var r=0;r<e.length;r++)e[r]=t.endian(e[r]);return e},randomBytes:function(e){for(var r=[];e>0;e--)r.push(Math.floor(Math.random()*256));return r},bytesToWords:function(e){for(var r=[],i=0,s=0;i<e.length;i++,s+=8)r[s>>>5]|=e[i]<<24-s%32;return r},wordsToBytes:function(e){for(var r=[],i=0;i<e.length*32;i+=8)r.push(e[i>>>5]>>>24-i%32&255);return r},bytesToHex:function(e){for(var r=[],i=0;i<e.length;i++)r.push((e[i]>>>4).toString(16)),r.push((e[i]&15).toString(16));return r.join("")},hexToBytes:function(e){for(var r=[],i=0;i<e.length;i+=2)r.push(parseInt(e.substr(i,2),16));return r},bytesToBase64:function(e){for(var r=[],i=0;i<e.length;i+=3)for(var s=e[i]<<16|e[i+1]<<8|e[i+2],a=0;a<4;a++)i*8+a*6<=e.length*8?r.push(n.charAt(s>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var r=[],i=0,s=0;i<e.length;s=++i%4)s!=0&&r.push((n.indexOf(e.charAt(i-1))&Math.pow(2,-2*s+8)-1)<<s*2|n.indexOf(e.charAt(i))>>>6-s*2);return r}};Zs.exports=t})();var ei={utf8:{stringToBytes:function(n){return ei.bin.stringToBytes(unescape(encodeURIComponent(n)))},bytesToString:function(n){return decodeURIComponent(escape(ei.bin.bytesToString(n)))}},bin:{stringToBytes:function(n){for(var t=[],e=0;e<n.length;e++)t.push(n.charCodeAt(e)&255);return t},bytesToString:function(n){for(var t=[],e=0;e<n.length;e++)t.push(String.fromCharCode(n[e]));return t.join("")}}},Gs=ei;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var $l=function(n){return n!=null&&($s(n)||Vl(n)||!!n._isBuffer)};function $s(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function Vl(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&$s(n.slice(0,0))}(function(){var n=Zs.exports,t=Gs.utf8,e=$l,r=Gs.bin,i=function(s,a){s.constructor==String?a&&a.encoding==="binary"?s=r.stringToBytes(s):s=t.stringToBytes(s):e(s)?s=Array.prototype.slice.call(s,0):!Array.isArray(s)&&s.constructor!==Uint8Array&&(s=s.toString());for(var o=n.bytesToWords(s),g=s.length*8,c=1732584193,l=-271733879,h=-1732584194,d=271733878,f=0;f<o.length;f++)o[f]=(o[f]<<8|o[f]>>>24)&16711935|(o[f]<<24|o[f]>>>8)&4278255360;o[g>>>5]|=128<<g%32,o[(g+64>>>9<<4)+14]=g;for(var w=i._ff,v=i._gg,m=i._hh,p=i._ii,f=0;f<o.length;f+=16){var S=c,E=l,y=h,x=d;c=w(c,l,h,d,o[f+0],7,-680876936),d=w(d,c,l,h,o[f+1],12,-389564586),h=w(h,d,c,l,o[f+2],17,606105819),l=w(l,h,d,c,o[f+3],22,-1044525330),c=w(c,l,h,d,o[f+4],7,-176418897),d=w(d,c,l,h,o[f+5],12,1200080426),h=w(h,d,c,l,o[f+6],17,-1473231341),l=w(l,h,d,c,o[f+7],22,-45705983),c=w(c,l,h,d,o[f+8],7,1770035416),d=w(d,c,l,h,o[f+9],12,-1958414417),h=w(h,d,c,l,o[f+10],17,-42063),l=w(l,h,d,c,o[f+11],22,-1990404162),c=w(c,l,h,d,o[f+12],7,1804603682),d=w(d,c,l,h,o[f+13],12,-40341101),h=w(h,d,c,l,o[f+14],17,-1502002290),l=w(l,h,d,c,o[f+15],22,1236535329),c=v(c,l,h,d,o[f+1],5,-165796510),d=v(d,c,l,h,o[f+6],9,-1069501632),h=v(h,d,c,l,o[f+11],14,643717713),l=v(l,h,d,c,o[f+0],20,-373897302),c=v(c,l,h,d,o[f+5],5,-701558691),d=v(d,c,l,h,o[f+10],9,38016083),h=v(h,d,c,l,o[f+15],14,-660478335),l=v(l,h,d,c,o[f+4],20,-405537848),c=v(c,l,h,d,o[f+9],5,568446438),d=v(d,c,l,h,o[f+14],9,-1019803690),h=v(h,d,c,l,o[f+3],14,-187363961),l=v(l,h,d,c,o[f+8],20,1163531501),c=v(c,l,h,d,o[f+13],5,-1444681467),d=v(d,c,l,h,o[f+2],9,-51403784),h=v(h,d,c,l,o[f+7],14,1735328473),l=v(l,h,d,c,o[f+12],20,-1926607734),c=m(c,l,h,d,o[f+5],4,-378558),d=m(d,c,l,h,o[f+8],11,-2022574463),h=m(h,d,c,l,o[f+11],16,1839030562),l=m(l,h,d,c,o[f+14],23,-35309556),c=m(c,l,h,d,o[f+1],4,-1530992060),d=m(d,c,l,h,o[f+4],11,1272893353),h=m(h,d,c,l,o[f+7],16,-155497632),l=m(l,h,d,c,o[f+10],23,-1094730640),c=m(c,l,h,d,o[f+13],4,681279174),d=m(d,c,l,h,o[f+0],11,-358537222),h=m(h,d,c,l,o[f+3],16,-722521979),l=m(l,h,d,c,o[f+6],23,76029189),c=m(c,l,h,d,o[f+9],4,-640364487),d=m(d,c,l,h,o[f+12],11,-421815835),h=m(h,d,c,l,o[f+15],16,530742520),l=m(l,h,d,c,o[f+2],23,-995338651),c=p(c,l,h,d,o[f+0],6,-198630844),d=p(d,c,l,h,o[f+7],10,1126891415),h=p(h,d,c,l,o[f+14],15,-1416354905),l=p(l,h,d,c,o[f+5],21,-57434055),c=p(c,l,h,d,o[f+12],6,1700485571),d=p(d,c,l,h,o[f+3],10,-1894986606),h=p(h,d,c,l,o[f+10],15,-1051523),l=p(l,h,d,c,o[f+1],21,-2054922799),c=p(c,l,h,d,o[f+8],6,1873313359),d=p(d,c,l,h,o[f+15],10,-30611744),h=p(h,d,c,l,o[f+6],15,-1560198380),l=p(l,h,d,c,o[f+13],21,1309151649),c=p(c,l,h,d,o[f+4],6,-145523070),d=p(d,c,l,h,o[f+11],10,-1120210379),h=p(h,d,c,l,o[f+2],15,718787259),l=p(l,h,d,c,o[f+9],21,-343485551),c=c+S>>>0,l=l+E>>>0,h=h+y>>>0,d=d+x>>>0}return n.endian([c,l,h,d])};i._ff=function(s,a,o,g,c,l,h){var d=s+(a&o|~a&g)+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._gg=function(s,a,o,g,c,l,h){var d=s+(a&g|o&~g)+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._hh=function(s,a,o,g,c,l,h){var d=s+(a^o^g)+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._ii=function(s,a,o,g,c,l,h){var d=s+(o^(a|~g))+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._blocksize=16,i._digestsize=16,ti.exports=function(s,a){if(s==null)throw new Error("Illegal argument "+s);var o=n.wordsToBytes(i(s,a));return a&&a.asBytes?o:a&&a.asString?r.bytesToString(o):n.bytesToHex(o)}})();const Bt=class{constructor(t){_(this,"seed",BigInt(0));this.setSeed(t)}static fromLargeFeatureSeed(t,e,r){const i=new Bt(t),s=i.nextLong(),a=i.nextLong(),o=BigInt(e)*s^BigInt(r)*a^t;return i.setSeed(o),i}static fromLargeFeatureWithSalt(t,e,r,i){const s=BigInt(e)*BigInt("341873128712")+BigInt(r)*BigInt("132897987541")+t+BigInt(i);return new Bt(s)}fork(){return new Bt(this.nextLong())}forkPositional(){return new Vs(this.nextLong())}setSeed(t){this.seed=(t^Bt.MULTIPLIER)&Bt.MODULUS_MASK}advance(){this.seed=this.seed*Bt.MULTIPLIER+Bt.INCREMENT&Bt.MODULUS_MASK}consume(t){for(let e=0;e<t;e+=1)this.advance()}next(t){this.advance();const e=Number(this.seed>>BigInt(Bt.MODULUS_BITS-t));return e>2147483647?e-4294967296:e}nextInt(t){if(t===void 0)return this.next(32);if((t&t-1)==0)return Number(BigInt(t)*BigInt(this.next(31))>>BigInt(31));let e,r;for(;(e=this.next(31))-(r=e%t)+(t-1)<0;);return r}nextLong(){return(BigInt(this.next(32))<<BigInt(32))+BigInt(this.next(32))}nextFloat(){return this.next(24)*Bt.FLOAT_MULTIPLIER}nextDouble(){const t=this.next(30);return this.advance(),t*Bt.DOUBLE_MULTIPLIER}};let at=Bt;_(at,"MODULUS_BITS",48),_(at,"MODULUS_MASK",BigInt("281474976710655")),_(at,"MULTIPLIER",BigInt("25214903917")),_(at,"INCREMENT",BigInt("11")),_(at,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),_(at,"DOUBLE_MULTIPLIER",1/Math.pow(2,30));class Vs{constructor(t){this.seed=t}at(t,e,r){const i=Wr(t,e,r);return new at(i^this.seed)}fromHashOf(t){const e=ti.exports(t,{asBytes:!0}),r=rr(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);return new at(r^this.seed)}seedKey(){return[this.seed,BigInt(0)]}}const $=class{constructor(t){_(this,"seed",[BigInt(0),BigInt(0)]);this.seed=t}static create(t){return new $($.upgradeSeedTo128bit(t))}static mixStafford13(t){return t=(t^t>>$.BIGINT_30)*$.STAFFORD_1&$.MAX_ULONG,t=(t^t>>$.BIGINT_27)*$.STAFFORD_2&$.MAX_ULONG,(t^t>>$.BIGINT_31)&$.MAX_ULONG}static upgradeSeedTo128bit(t){t<0&&(t+=$.POW2_60);const e=t^$.SILVER_RATIO_64,r=e+$.GOLDEN_RATIO_64&$.MAX_ULONG;return[$.mixStafford13(e),$.mixStafford13(r)]}static rotateLeft(t,e){return t<<e&$.MAX_ULONG|t>>$.BIGINT_64-e}setSeed(t){this.seed=$.upgradeSeedTo128bit(t)}fork(){return new $([this.next(),this.next()])}forkPositional(){return new Ys(this.next(),this.next())}next(){const t=this.seed[0];let e=this.seed[1];const r=$.rotateLeft(t+e&$.MAX_ULONG,$.BIGINT_17)+t&$.MAX_ULONG;return e^=t,this.seed=[$.rotateLeft(t,$.BIGINT_49)^e^e<<$.BIGINT_21&$.MAX_ULONG,$.rotateLeft(e,$.BIGINT_28)],r}nextLong(){let t=this.next();return t>$.POW2_63&&(t-=$.POW2_60),t}consume(t){let e=this.seed[0],r=this.seed[1];for(let i=0;i<t;i+=1)r^=e,e=$.rotateLeft(e,$.BIGINT_49)^r^r<<$.BIGINT_21,r=$.rotateLeft(r,$.BIGINT_28);this.seed=[e,r]}nextBits(t){return this.next()>>BigInt(64-t)}nextInt(t){let e=this.next()&$.MAX_UINT;if(t){const r=BigInt(t);let i=e*r,s=i&$.MAX_UINT;if(s<r){const o=((~r&$.MAX_UINT)+$.BIGINT_1)%r;for(;s<o;)e=this.next()&$.MAX_UINT,i=e*r,s=i&$.MAX_UINT}const a=i>>$.BIGINT_32;return Number(a)}else{let r=Number(e);return r>=2147483648&&(r-=4294967296),r}}nextFloat(){return Number(this.nextBits(24))*$.FLOAT_MULTIPLIER}nextDouble(){return Number(this.nextBits(53))*$.DOUBLE_MULTIPLIER}parityConfigString(){return"seedLo: "+this.seed[0]+", seedHi: "+this.seed[1]}};let rt=$;_(rt,"SILVER_RATIO_64",BigInt("7640891576956012809")),_(rt,"GOLDEN_RATIO_64",BigInt("-7046029254386353131")),_(rt,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),_(rt,"DOUBLE_MULTIPLIER",11102230246251565e-32),_(rt,"BIGINT_1",BigInt(1)),_(rt,"BIGINT_17",BigInt(17)),_(rt,"BIGINT_21",BigInt(21)),_(rt,"BIGINT_27",BigInt(27)),_(rt,"BIGINT_28",BigInt(28)),_(rt,"BIGINT_30",BigInt(30)),_(rt,"BIGINT_31",BigInt(31)),_(rt,"BIGINT_32",BigInt(32)),_(rt,"BIGINT_49",BigInt(49)),_(rt,"BIGINT_64",BigInt(64)),_(rt,"STAFFORD_1",BigInt("-4658895280553007687")),_(rt,"STAFFORD_2",BigInt("-7723592293110705685")),_(rt,"MAX_ULONG",BigInt("0xFFFFFFFFFFFFFFFF")),_(rt,"POW2_60",BigInt("0x10000000000000000")),_(rt,"POW2_63",BigInt("0x8000000000000000")),_(rt,"MAX_UINT",BigInt(4294967295));class Ys{constructor(t,e){this.seedLo=t,this.seedHi=e}at(t,e,r){const s=Wr(t,e,r)^this.seedLo;return new rt([s,this.seedHi])}fromHashOf(t){const e=ti.exports(t,{asBytes:!0}),r=rr(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),i=rr(e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]);return new rt([r^this.seedLo,i^this.seedHi])}seedKey(){return[this.seedLo,this.seedHi]}}const jt=class{constructor(t){_(this,"p");_(this,"xo");_(this,"yo");_(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),i=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=i}}sample2D(t,e){const r=(t+e)*jt.F2,i=Wt(t+r),s=Wt(e+r),a=(i+s)*jt.G2,o=i-a,g=t-o;let c,l;const h=e-(s-a);g>h?(c=1,l=0):(c=0,l=1);const d=g-c+jt.G2,f=h-l+jt.G2,w=g-1+2*jt.G2,v=h-1+2*jt.G2,m=i&255,p=s&255,S=this.P(m+this.P(p))%12,E=this.P(m+c+this.P(p+l))%12,y=this.P(m+1+this.P(p+1))%12,x=this.getCornerNoise3D(S,g,h,0,.5),A=this.getCornerNoise3D(E,d,f,0,.5),I=this.getCornerNoise3D(y,w,v,0,.5);return 70*(x+A+I)}sample(t,e,r){const i=(t+e+r)*.3333333333333333,s=Wt(t+i),a=Wt(e+i),o=Wt(r+i),g=(s+a+o)*.16666666666666666,c=t-(s-g),l=e-(a-g),h=r-(o-g);let d,f,w,v,m,p;c>=l?l>=h?(d=1,f=0,w=0,v=1,m=1,p=0):c>=h?(d=1,f=0,w=0,v=1,m=0,p=1):(d=0,f=0,w=1,v=1,m=0,p=1):l<h?(d=0,f=0,w=1,v=0,m=1,p=1):c<h?(d=0,f=1,w=0,v=0,m=1,p=1):(d=0,f=1,w=0,v=1,m=1,p=0);const S=c-d+.16666666666666666,E=l-f+.16666666666666666,y=h-w+.16666666666666666,x=c-v+.3333333333333333,A=l-m+.3333333333333333,I=h-p+.3333333333333333,R=c-.5,C=l-.5,M=h-.5,N=s&255,L=a&255,F=o&255,U=this.P(N+this.P(L+this.P(F)))%12,T=this.P(N+d+this.P(L+f+this.P(F+w)))%12,O=this.P(N+v+this.P(L+m+this.P(F+p)))%12,G=this.P(N+1+this.P(L+1+this.P(F+1)))%12,H=this.getCornerNoise3D(U,c,l,h,.6),j=this.getCornerNoise3D(T,S,E,y,.6),k=this.getCornerNoise3D(O,x,A,I,.6),b=this.getCornerNoise3D(G,R,C,M,.6);return 32*(H+j+k+b)}P(t){return this.p[t&255]}getCornerNoise3D(t,e,r,i,s){let a,o=s-e*e-r*r-i*i;return o<0?a=0:(o*=o,a=o*o*jt.gradDot(t,e,r,i)),a}static gradDot(t,e,r,i){const s=jt.GRADIENT[t&15];return s[0]*e+s[1]*r+s[2]*i}};let pt=jt;_(pt,"GRADIENT",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1],[1,1,0],[0,-1,1],[-1,1,0],[0,-1,-1]]),_(pt,"F2",.5*(Math.sqrt(3)-1)),_(pt,"G2",(3-Math.sqrt(3))/6);class ni{constructor(t){_(this,"p");_(this,"xo");_(this,"yo");_(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e>127?e-256:e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),i=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=i}}sample(t,e,r,i=0,s=0){const a=t+this.xo,o=e+this.yo,g=r+this.zo,c=Wt(a),l=Wt(o),h=Wt(g),d=a-c,f=o-l,w=g-h;let v=0;if(i!==0){const m=s>=0&&s<f?s:f;v=Wt(m/i+1e-7)*i}return this.sampleAndLerp(c,l,h,d,f-v,w,f)}sampleAndLerp(t,e,r,i,s,a,o){const g=this.P(t),c=this.P(t+1),l=this.P(g+e),h=this.P(g+e+1),d=this.P(c+e),f=this.P(c+e+1),w=pt.gradDot(this.P(l+r),i,s,a),v=pt.gradDot(this.P(d+r),i-1,s,a),m=pt.gradDot(this.P(h+r),i,s-1,a),p=pt.gradDot(this.P(f+r),i-1,s-1,a),S=pt.gradDot(this.P(l+r+1),i,s,a-1),E=pt.gradDot(this.P(d+r+1),i-1,s,a-1),y=pt.gradDot(this.P(h+r+1),i,s-1,a-1),x=pt.gradDot(this.P(f+r+1),i-1,s-1,a-1),A=nr(i),I=nr(o),R=nr(a);return Os(A,I,R,w,v,m,p,S,E,y,x)}P(t){return this.p[t&255]&255}}class _t{constructor(t,e,r,i=!1){_(this,"noiseLevels");_(this,"amplitudes");_(this,"lowestFreqInputFactor");_(this,"lowestFreqValueFactor");_(this,"maxValue");if(t instanceof rt&&!i){const s=t.forkPositional();this.noiseLevels=Array(r.length);for(let a=0;a<r.length;a++)if(r[a]!==0){const o=e+a;this.noiseLevels[a]=new ni(s.fromHashOf("octave_"+o))}}else{if(1-e<r.length)throw new Error("Positive octaves are not allowed when using LegacyRandom");this.noiseLevels=Array(r.length);for(let s=-e;s>=0;s-=1)s<r.length&&r[s]!==0?this.noiseLevels[s]=new ni(t):t.consume(262)}this.amplitudes=r,this.lowestFreqInputFactor=Math.pow(2,e),this.lowestFreqValueFactor=Math.pow(2,r.length-1)/(Math.pow(2,r.length)-1),this.maxValue=this.edgeValue(2)}sample(t,e,r,i=0,s=0,a=!1){let o=0,g=this.lowestFreqInputFactor,c=this.lowestFreqValueFactor;for(let l=0;l<this.noiseLevels.length;l+=1){const h=this.noiseLevels[l];h&&(o+=this.amplitudes[l]*c*h.sample(_t.wrap(t*g),a?-h.yo:_t.wrap(e*g),_t.wrap(r*g),i*g,s*g)),g*=2,c/=2}return o}getOctaveNoise(t){return this.noiseLevels[this.noiseLevels.length-1-t]}edgeValue(t){let e=0,r=this.lowestFreqValueFactor;for(let i=0;i<this.noiseLevels.length;i+=1)this.noiseLevels[i]&&(e+=this.amplitudes[i]*t*r),r/=2;return e}static wrap(t){return t-zs(t/33554432+.5)*33554432}}class qs{constructor(t,e,r,i,s,a){_(this,"minLimitNoise");_(this,"maxLimitNoise");_(this,"mainNoise");_(this,"xzMultiplier");_(this,"yMultiplier");_(this,"maxValue");this.xzScale=e,this.yScale=r,this.xzFactor=i,this.yFactor=s,this.smearScaleMultiplier=a,this.minLimitNoise=new _t(t,-15,[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],!0),this.maxLimitNoise=new _t(t,-15,[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],!0),this.mainNoise=new _t(t,-7,[1,1,1,1,1,1,1,1],!0),this.xzMultiplier=684.412*e,this.yMultiplier=684.412*r,this.maxValue=this.minLimitNoise.edgeValue(this.yMultiplier+2)}sample(t,e,r){const i=t*this.xzMultiplier,s=e*this.yMultiplier,a=r*this.xzMultiplier,o=i/this.xzFactor,g=s/this.yFactor,c=a/this.xzFactor,l=this.yMultiplier*this.smearScaleMultiplier,h=l/this.yFactor;let d,f=0,w=1;for(let p=0;p<8;p+=1){if(d=this.mainNoise.getOctaveNoise(p),d){const S=_t.wrap(o*w),E=_t.wrap(g*w),y=_t.wrap(c*w);f+=d.sample(S,E,y,h*w,g*w)/w}w/=2}f=(f/10+1)/2,w=1;let v=0,m=0;for(let p=0;p<16;p+=1){const S=_t.wrap(i*w),E=_t.wrap(s*w),y=_t.wrap(a*w),x=l*w;f<1&&(d=this.minLimitNoise.getOctaveNoise(p))&&(v+=d.sample(S,E,y,x,s*w)/w),f>0&&(d=this.maxLimitNoise.getOctaveNoise(p))&&(m+=d.sample(S,E,y,x,s*w)/w),w/=2}return er(v/512,m/512,f)/128}}const Ln=class{constructor(t,{firstOctave:e,amplitudes:r}){_(this,"valueFactor");_(this,"first");_(this,"second");_(this,"maxValue");this.first=new _t(t,e,r),this.second=new _t(t,e,r);let i=1/0,s=-1/0;for(let o=0;o<r.length;o+=1)r[o]!==0&&(i=Math.min(i,o),s=Math.max(s,o));const a=.1*(1+1/(s-i+1));this.valueFactor=1/6/a,this.maxValue=(this.first.maxValue+this.second.maxValue)*this.valueFactor}sample(t,e,r){const i=t*Ln.INPUT_FACTOR,s=e*Ln.INPUT_FACTOR,a=r*Ln.INPUT_FACTOR;return(this.first.sample(t,e,r)+this.second.sample(i,s,a))*this.valueFactor}};let ae=Ln;_(ae,"INPUT_FACTOR",1.0181268882175227),u.NoiseParameters=void 0,(n=>{function t(r,i){return{firstOctave:r,amplitudes:i}}n.create=t;function e(r){var s,a,o;const i=(s=u.Json.readObject(r))!=null?s:{};return{firstOctave:(a=u.Json.readInt(i.firstOctave))!=null?a:0,amplitudes:(o=u.Json.readArray(i.amplitudes,g=>{var c;return(c=u.Json.readNumber(g))!=null?c:0}))!=null?o:[]}}n.fromJson=e})(u.NoiseParameters||(u.NoiseParameters={}));class Yl{constructor(t,e){_(this,"noiseLevels");_(this,"highestFreqInputFactor");_(this,"highestFreqValueFactor");const r=e[e.length-1],s=-e[0]+r+1,a=new Set(e),o=new pt(t);this.noiseLevels=Array(s),r>=0&&r<s&&a.has(0)&&(this.noiseLevels[r]=o);for(let g=r+1;g<s;g+=1)g>=0&&a.has(r-g)?this.noiseLevels[g]=new pt(t):t.consume(262);if(r>0)throw new Error("Positive octaves are not allowed");this.highestFreqInputFactor=Math.pow(2,r),this.highestFreqValueFactor=1/(Math.pow(2,s)-1)}sample(t,e,r){let i=0,s=this.highestFreqInputFactor,a=this.highestFreqValueFactor;for(let o=0;o<this.noiseLevels.length;o+=1){const g=this.noiseLevels[o];g&&(i+=a*g.sample2D(t*s+(r?g.xo:0),e*s+(r?g.yo:0))),s/=2,a*=2}return i}}const Ut=[124/255,189/255,107/255],ql=u.Color.intToRgb(6396257),Wl=u.Color.intToRgb(8431445),Ke=u.Color.intToRgb(4764952),cr=u.Color.intToRgb(4159204),Xl=u.Color.intToRgb(2129968),jl=n=>{const t=n/15,e=t*.6+(t>0?.4:.3),r=yt(t*t*.7-.5,0,1),i=yt(t*t*.6-.7,0,1);return[e,r,i]},lr=n=>[n/8,1-n/32,n/64],Je={large_fern:()=>Ut,tall_grass:()=>Ut,grass_block:()=>Ut,fern:()=>Ut,grass:()=>Ut,short_grass:()=>Ut,potted_fern:()=>Ut,pink_petals:()=>Ut,wildflowers:()=>Ut,bush:()=>Ut,spruce_leaves:()=>ql,birch_leaves:()=>Wl,oak_leaves:()=>Ke,jungle_leaves:()=>Ke,acacia_leaves:()=>Ke,dark_oak_leaves:()=>Ke,vine:()=>Ke,mangrove_leaves:()=>Ke,water:()=>cr,bubble_column:()=>cr,cauldron:()=>cr,water_cauldron:()=>cr,redstone_wire:n=>{var t;return jl(parseInt((t=n.power)!=null?t:"0"))},sugar_cane:()=>Ut,attached_melon_stem:()=>lr(7),attached_pumpkin_stem:()=>lr(7),melon_stem:n=>{var t;return lr(parseInt((t=n.age)!=null?t:"0"))},pumpkin_stem:n=>{var t;return lr(parseInt((t=n.age)!=null?t:"0"))},lily_pad:()=>Xl};u.Cull=void 0,(n=>{function t(r,i,s){let{up:a,down:o,north:g,east:c,south:l,west:h}=r;switch(s){case 90:[g,c,l,h]=[c,l,h,g];break;case 180:[g,c,l,h]=[l,h,g,c];break;case 270:[g,c,l,h]=[h,g,c,l]}switch(i){case 90:[a,g,o,l]=[g,o,l,a];break;case 180:[a,g,o,l]=[o,l,a,g];break;case 270:[a,g,o,l]=[l,a,g,o]}return{up:a,down:o,north:g,east:c,south:l,west:h}}n.rotate=t;function e(){return Object.create(null)}n.none=e})(u.Cull||(u.Cull={}));const Zt=class{constructor(t,e,r,i,s){this.pos=t,this.color=e,this.texture=r,this.normal=i,this.blockPos=s}transform(t){return Zt.VEC[0]=this.pos.x,Zt.VEC[1]=this.pos.y,Zt.VEC[2]=this.pos.z,Zl(Zt.VEC,Zt.VEC,t),this.pos=new Y(Zt.VEC[0],Zt.VEC[1],Zt.VEC[2]),this}static fromPos(t){return new Zt(t,[0,0,0],[0,0],void 0,void 0)}};let Ot=Zt;_(Ot,"VEC",Qr());class ur{constructor(t,e){this.v1=t,this.v2=e}vertices(){return[this.v1,this.v2]}forEach(t){return t(this.v1),t(this.v2),this}transform(t){return this.forEach(e=>e.transform(t)),this}setColor(t){return this.forEach(e=>e.color=t),this}toString(){return`Line(${this.v1.pos.toString()}, ${this.v2.pos.toString()})`}static fromPoints(t,e){return new ur(Ot.fromPos(t),Ot.fromPos(e))}}class it{constructor(t=[],e=[]){_(this,"posBuffer");_(this,"colorBuffer");_(this,"textureBuffer");_(this,"normalBuffer");_(this,"blockPosBuffer");_(this,"indexBuffer");_(this,"linePosBuffer");_(this,"lineColorBuffer");this.quads=t,this.lines=e}clear(){return this.quads=[],this.lines=[],this}isEmpty(){return this.quads.length===0&&this.lines.length===0}quadVertices(){return this.quads.length*4}quadIndices(){return this.quads.length*6}lineVertices(){return this.lines.length*2}merge(t){return this.quads=this.quads.concat(t.quads),this.lines=this.lines.concat(t.lines),this}addLine(t,e,r,i,s,a,o){const g=new ur(Ot.fromPos(new Y(t,e,r)),Ot.fromPos(new Y(i,s,a))).setColor(o);return this.lines.push(g),this}addLineCube(t,e,r,i,s,a,o){return this.addLine(t,e,r,t,e,a,o),this.addLine(i,e,r,i,e,a,o),this.addLine(t,e,r,i,e,r,o),this.addLine(t,e,a,i,e,a,o),this.addLine(t,e,r,t,s,r,o),this.addLine(i,e,r,i,s,r,o),this.addLine(t,e,a,t,s,a,o),this.addLine(i,e,a,i,s,a,o),this.addLine(t,s,r,t,s,a,o),this.addLine(i,s,r,i,s,a,o),this.addLine(t,s,r,i,s,r,o),this.addLine(t,s,a,i,s,a,o),this}transform(t){for(const e of this.quads)e.transform(t);return this}computeNormals(){for(const t of this.quads){const e=t.normal();t.forEach(r=>r.normal=e)}}rebuild(t,e){const r=(s,a,o)=>{var g;if(s||(s=(g=t.createBuffer())!=null?g:void 0),!s)throw new Error("Cannot create new buffer");return t.bindBuffer(a,s),t.bufferData(a,o,t.DYNAMIC_DRAW),s},i=(s,a,o)=>{if(s.length===0){a&&t.deleteBuffer(a);return}const g=s.flatMap(c=>c.vertices().flatMap(l=>{const h=o(l);if(!h)throw new Error("Missing vertex component");return h}));return r(a,t.ARRAY_BUFFER,new Float32Array(g))};return e.pos&&(this.posBuffer=i(this.quads,this.posBuffer,s=>s.pos.components()),this.linePosBuffer=i(this.lines,this.linePosBuffer,s=>s.pos.components())),e.color&&(this.colorBuffer=i(this.quads,this.colorBuffer,s=>s.color),this.lineColorBuffer=i(this.lines,this.lineColorBuffer,s=>s.color)),e.texture&&(this.textureBuffer=i(this.quads,this.textureBuffer,s=>s.texture)),e.normal&&(this.normalBuffer=i(this.quads,this.normalBuffer,s=>{var a;return(a=s.normal)==null?void 0:a.components()})),e.blockPos&&(this.blockPosBuffer=i(this.quads,this.blockPosBuffer,s=>{var a;return(a=s.blockPos)==null?void 0:a.components()})),this.quads.length===0?(this.indexBuffer&&t.deleteBuffer(this.indexBuffer),this.indexBuffer=void 0):this.indexBuffer=r(this.indexBuffer,t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.quads.flatMap((s,a)=>[4*a,4*a+1,4*a+2,a*4,4*a+2,4*a+3],!0))),this}}class ri{constructor(t,e){this.variants=t,this.multipart=e}getModelVariants(t){if(this.variants){const e=Object.keys(this.variants).filter(i=>this.matchesVariant(i,t));if(e.length===0)return[];const r=this.variants[e[0]];return[Array.isArray(r)?r[0]:r]}else if(this.multipart)return this.multipart.filter(r=>r.when?this.matchesCase(r.when,t):!0).map(r=>Array.isArray(r.apply)?r.apply[0]:r.apply);return[]}getMesh(t,e,r,i,s){var c,l,h,d,f;const a=this.getModelVariants(e),o=new it;for(const w of a){const v=u.Cull.rotate(s,(c=w.x)!=null?c:0,(l=w.y)!=null?l:0),m=i.getBlockModel(B.parse(w.model));if(!m)throw new Error(`Cannot find block model ${w.model}`);const p=t?(h=Je[t.path])==null?void 0:h.call(Je,e):void 0,S=m.getMesh(r,v,p);if(w.x||w.y){const E=nt();W(E,E,[8,8,8]),vt(E,E,-jr((d=w.y)!=null?d:0)),xn(E,E,-jr((f=w.x)!=null?f:0)),W(E,E,[-8,-8,-8]),S.transform(E)}o.merge(S)}const g=nt();return Nt(g,g,[.0625,.0625,.0625]),o.transform(g)}matchesVariant(t,e){return t.split(",").every(r=>{const[i,s]=r.split("=");return e[i]===s})}matchesCase(t,e){if(Array.isArray(t.OR))return t.OR.some(i=>this.matchesCase(i,e));const r=t;return Object.keys(r).every(i=>r[i].split("|").includes(e[i]))}static fromJson(t){return new ri(t.variants,t.multipart)}}class Xt{constructor(t,e,r,i){this.v1=t,this.v2=e,this.v3=r,this.v4=i}vertices(){return[this.v1,this.v2,this.v3,this.v4]}forEach(t){return t(this.v1),t(this.v2),t(this.v3),t(this.v4),this}transform(t){return this.forEach(e=>e.transform(t)),this}normal(){const t=this.v2.pos.sub(this.v1.pos),e=this.v3.pos.sub(this.v1.pos);return t.cross(e).normalize()}reverse(){return[this.v1,this.v2,this.v3,this.v4]=[this.v4,this.v3,this.v2,this.v1],this}setColor(t){return this.forEach(e=>e.color=t),this}setTexture(t){return this.v1.texture=[t[0],t[1]],this.v2.texture=[t[2],t[3]],this.v3.texture=[t[4],t[5]],this.v4.texture=[t[6],t[7]],this}toString(){return`Quad(${this.v1.pos.toString()}, ${this.v2.pos.toString()}, ${this.v3.pos.toString()}, ${this.v4.pos.toString()})`}static fromPoints(t,e,r,i){return new Xt(Ot.fromPos(t),Ot.fromPos(e),Ot.fromPos(r),Ot.fromPos(i))}}const Kl={0:[0,3,2,3,2,1,0,1],90:[2,3,2,1,0,1,0,3],180:[2,1,0,1,0,3,2,3],270:[0,1,0,3,2,3,2,1]},Ql={x:[1,0,0],y:[0,1,0],z:[0,0,1]},Qe=1.41421356237,tu={x:[1,Qe,Qe],y:[Qe,1,Qe],z:[Qe,Qe,1]},sn=class{constructor(t,e,r,i,s){_(this,"generationMarker",!1);_(this,"uvEpsilon",1/16);this.parent=t,this.textures=e,this.elements=r,this.display=i,this.guiLight=s}getDisplayTransform(t){var i;const e=(i=this.display)==null?void 0:i[t],r=nt();return W(r,r,[8,8,8]),e!=null&&e.translation&&W(r,r,e.translation),e!=null&&e.rotation&&(xn(r,r,e.rotation[0]*Math.PI/180),vt(r,r,e.rotation[1]*Math.PI/180),Hs(r,r,-e.rotation[2]*Math.PI/180)),e!=null&&e.scale&&Nt(r,r,e.scale),W(r,r,[-8,-8,-8]),r}getMesh(t,e,r){var a;const i=new it,s=o=>r===void 0?[1,1,1]:o===void 0||o<0?[1,1,1]:typeof r=="function"?r(o):r;for(const o of(a=this.elements)!=null?a:[])i.merge(this.getElementMesh(o,t,e,s));return i}getElementMesh(t,e,r,i){var w,v,m,p,S,E,y,x,A,I,R,C;const s=new it,[a,o,g]=t.from,[c,l,h]=t.to,d=(M,N,L)=>{var Z,K,At,Mt,Et,ut,ht,lt,V;const F=Xt.fromPoints(new Y(L[0],L[1],L[2]),new Y(L[3],L[4],L[5]),new Y(L[6],L[7],L[8]),new Y(L[9],L[10],L[11])),U=i(M.tintindex);F.setColor(U);const[T,O,G,H]=e.getTextureUV(this.getTexture(M.texture)),j=(G-T)/16,k=(H-O)/16,b=j*this.uvEpsilon,P=k*this.uvEpsilon;N[0]=((K=(Z=M.uv)==null?void 0:Z[0])!=null?K:N[0])*j+b,N[1]=((Mt=(At=M.uv)==null?void 0:At[1])!=null?Mt:N[1])*k+P,N[2]=((ut=(Et=M.uv)==null?void 0:Et[2])!=null?ut:N[2])*j-b,N[3]=((lt=(ht=M.uv)==null?void 0:ht[3])!=null?lt:N[3])*k-P;const z=Kl[(V=M.rotation)!=null?V:0];F.setTexture([T+N[z[0]],O+N[z[1]],T+N[z[2]],O+N[z[3]],T+N[z[4]],O+N[z[5]],T+N[z[6]],O+N[z[7]]]),s.quads.push(F)};((v=(w=t.faces)==null?void 0:w.up)==null?void 0:v.texture)&&(!t.faces.up.cullface||!r[t.faces.up.cullface])&&d(t.faces.up,[a,16-h,c,16-g],[a,l,h,c,l,h,c,l,g,a,l,g]),((p=(m=t.faces)==null?void 0:m.down)==null?void 0:p.texture)&&(!t.faces.down.cullface||!r[t.faces.down.cullface])&&d(t.faces.down,[16-h,16-c,16-g,16-a],[a,o,g,c,o,g,c,o,h,a,o,h]),((E=(S=t.faces)==null?void 0:S.south)==null?void 0:E.texture)&&(!t.faces.south.cullface||!r[t.faces.south.cullface])&&d(t.faces.south,[a,16-l,c,16-o],[a,o,h,c,o,h,c,l,h,a,l,h]),((x=(y=t.faces)==null?void 0:y.north)==null?void 0:x.texture)&&(!t.faces.north.cullface||!r[t.faces.north.cullface])&&d(t.faces.north,[16-c,16-l,16-a,16-o],[c,o,g,a,o,g,a,l,g,c,l,g]),((I=(A=t.faces)==null?void 0:A.east)==null?void 0:I.texture)&&(!t.faces.east.cullface||!r[t.faces.east.cullface])&&d(t.faces.east,[16-h,16-l,16-g,16-o],[c,o,h,c,o,g,c,l,g,c,l,h]),((C=(R=t.faces)==null?void 0:R.west)==null?void 0:C.texture)&&(!t.faces.west.cullface||!r[t.faces.west.cullface])&&d(t.faces.west,[g,16-l,h,16-o],[a,o,g,a,o,h,a,l,h,a,l,g]);const f=nt();if(t.rotation){const M=Ul(...t.rotation.origin);W(f,f,M),Cl(f,f,jr(t.rotation.angle),Ql[t.rotation.axis]),t.rotation.rescale&&Nt(f,f,tu[t.rotation.axis]),Hl(M,M),W(f,f,M)}return s.transform(f)}getTexture(t){var e,r;for(;t.startsWith("#");)t=(r=(e=this.textures)==null?void 0:e[t.slice(1)])!=null?r:"";return B.parse(t)}withUvEpsilon(t){return this.uvEpsilon=t,this}flatten(t){var r,i,s,a;if(!this.parent)return;if(this.parent.equals(sn.BUILTIN_GENERATED)){this.generationMarker=!0;return}const e=this.getParent(t);if(!e){console.warn(`parent ${this.parent} does not exist!`),this.parent=void 0;return}if(e.flatten(t),this.elements||(this.elements=e.elements),this.textures||(this.textures={}),Object.keys((r=e.textures)!=null?r:{}).forEach(o=>{this.textures[o]||(this.textures[o]=e.textures[o])}),this.display||(this.display={}),Object.keys((i=e.display)!=null?i:{}).forEach(o=>{var c;const g=o;this.display[g]?Object.keys((c=e.display[g])!=null?c:{}).forEach(l=>{const h=l;this.display[g][h]||(this.display[g][h]=e.display[g][h])}):this.display[g]=e.display[g]}),this.guiLight||(this.guiLight=e.guiLight),e.generationMarker&&(this.generationMarker=!0),this.generationMarker&&((a=(s=this.elements)==null?void 0:s.length)!=null?a:0)===0)for(let o=0;o<sn.GENERATED_LAYERS.length;o+=1){const g=sn.GENERATED_LAYERS[o];if(!Object.hasOwn(this.textures,g))break;this.elements||(this.elements=[]),this.elements.push({from:[0,0,0],to:[16,16,0],faces:{south:{texture:`#${g}`,tintindex:o}}})}this.parent=void 0}getParent(t){return this.parent?t.getBlockModel(this.parent):null}static fromJson(t){const e=t.parent===void 0?void 0:B.parse(t.parent);return new sn(e,t.textures,t.elements,t.display)}};let ct=sn;_(ct,"BUILTIN_GENERATED",B.create("builtin/generated")),_(ct,"GENERATED_LAYERS",["layer0","layer1","layer2","layer3","layer4"]);const eu=u.Color.intToRgb(16383998),nu=u.Color.intToRgb(16351261),ru=u.Color.intToRgb(13061821),iu=u.Color.intToRgb(3847130),su=u.Color.intToRgb(16701501),au=u.Color.intToRgb(8439583),ou=u.Color.intToRgb(15961002),cu=u.Color.intToRgb(4673362),lu=u.Color.intToRgb(10329495),uu=u.Color.intToRgb(1481884),hu=u.Color.intToRgb(8991416),fu=u.Color.intToRgb(3949738),du=u.Color.intToRgb(8606770),gu=u.Color.intToRgb(6192150),mu=u.Color.intToRgb(11546150),wu=u.Color.intToRgb(1908001),ze={white:()=>eu,orange:()=>nu,magenta:()=>ru,light_blue:()=>iu,yellow:()=>su,lime:()=>au,pink:()=>ou,gray:()=>cu,light_gray:()=>lu,cyan:()=>uu,purple:()=>hu,blue:()=>fu,brown:()=>du,green:()=>gu,red:()=>mu,black:()=>wu};function ii(n,t,e,r,i){var a;const s=r.up?16:[14.2,12.5,10.5,9,7,5.3,3.7,1.9,16,16,16,16,16,16,16,16][t];return new ct(void 0,{still:`block/${n}_still`,flow:`block/${n}_flow`},[{from:[0,0,0],to:[16,s,16],faces:{up:{texture:"#still",tintindex:i,cullface:u.Direction.UP},down:{texture:"#still",tintindex:i,cullface:u.Direction.DOWN},north:{texture:"#flow",tintindex:i,cullface:u.Direction.NORTH},east:{texture:"#flow",tintindex:i,cullface:u.Direction.EAST},south:{texture:"#flow",tintindex:i,cullface:u.Direction.SOUTH},west:{texture:"#flow",tintindex:i,cullface:u.Direction.WEST}}}]).getMesh(e,r,(a=Je[n])==null?void 0:a.call(Je,{}))}u.SpecialRenderers=void 0,(n=>{function t(T){return O=>new ct(void 0,{0:T.withPrefix("entity/chest/").toString()},[{from:[1,0,1],to:[15,10,15],faces:{north:{uv:[10.5,8.25,14,10.75],rotation:180,texture:"#0"},east:{uv:[7,8.25,10.5,10.75],rotation:180,texture:"#0"},south:{uv:[3.5,8.25,7,10.75],rotation:180,texture:"#0"},west:{uv:[0,8.25,3.5,10.75],rotation:180,texture:"#0"},up:{uv:[7,4.75,10.5,8.25],texture:"#0"},down:{uv:[3.5,4.75,7,8.25],texture:"#0"}}},{from:[1,10,1],to:[15,14,15],faces:{north:{uv:[10.5,3.75,14,4.75],rotation:180,texture:"#0"},east:{uv:[7,3.75,10.5,4.75],rotation:180,texture:"#0"},south:{uv:[3.5,3.75,7,4.75],rotation:180,texture:"#0"},west:{uv:[0,3.75,3.5,4.75],rotation:180,texture:"#0"},up:{uv:[7,0,10.5,3.5],texture:"#0"},down:{uv:[3.5,0,7,3.5],texture:"#0"}}},{from:[7,7,0],to:[9,11,2],faces:{north:{uv:[.25,.25,.75,1.25],rotation:180,texture:"#0"},east:{uv:[0,.25,.25,1.25],rotation:180,texture:"#0"},south:{uv:[1,.25,1.5,1.25],rotation:180,texture:"#0"},west:{uv:[.75,.25,1,1.25],rotation:180,texture:"#0"},up:{uv:[.25,0,.75,.25],rotation:180,texture:"#0"},down:{uv:[.75,0,1.25,.25],rotation:180,texture:"#0"}}}]).getMesh(O,u.Cull.none())}n.chestRenderer=t;function e(T){return new ct(void 0,{0:"entity/decorated_pot/decorated_pot_side",1:"entity/decorated_pot/decorated_pot_base"},[{from:[1,0,1],to:[15,16,15],faces:{north:{uv:[1,0,15,16],texture:"#0"},east:{uv:[1,0,15,16],texture:"#0"},south:{uv:[1,0,15,16],texture:"#0"},west:{uv:[1,0,15,16],texture:"#0"},up:{uv:[0,6.5,7,13.5],texture:"#1"},down:{uv:[7,6.5,14,13.5],texture:"#1"}}},{from:[5,16,5],to:[11,17,11],faces:{north:{uv:[0,5.5,3,6],texture:"#1"},east:{uv:[3,5.5,6,6],texture:"#1"},south:{uv:[6,5.5,9,6],texture:"#1"},west:{uv:[9,5.5,12,6],texture:"#1"}}},{from:[4,17,4],to:[12,20,12],faces:{north:{uv:[0,4,4,5.5],texture:"#1"},east:{uv:[4,4,8,5.5],texture:"#1"},south:{uv:[8,4,12,5.5],texture:"#1"},west:{uv:[12,4,16,5.5],texture:"#1"},up:{uv:[4,0,8,4],texture:"#1"},down:{uv:[8,0,12,4],texture:"#1"}}}]).getMesh(T,u.Cull.none())}n.decoratedPotRenderer=e;function r(T){return new ct(void 0,{0:"entity/shield_base_nopattern"},[{from:[-6,-11,-2],to:[6,11,-1],faces:{north:{uv:[3.5,.25,6.5,5.75],texture:"#0"},east:{uv:[3.25,.25,3.5,5.75],texture:"#0"},south:{uv:[.25,.25,3.25,5.75],texture:"#0"},west:{uv:[0,.25,.25,5.75],texture:"#0"},up:{uv:[.25,0,3.25,.25],texture:"#0"},down:{uv:[3.25,0,6.25,.25],texture:"#0"}}}]).getMesh(T,u.Cull.none())}n.shieldRenderer=r;function i(T,O){return G=>new ct(void 0,{0:T.withPrefix("entity/").toString()},[{from:[4,0,4],to:[12,8,12],faces:{north:{uv:[6,2*O,8,4*O],texture:"#0"},east:{uv:[2,2*O,0,4*O],texture:"#0"},south:{uv:[2,2*O,4,4*O],texture:"#0"},west:{uv:[6,2*O,4,4*O],texture:"#0"},up:{uv:[2,0*O,4,2*O],texture:"#0"},down:{uv:[4,0*O,6,2*O],texture:"#0"}}}]).getMesh(G,u.Cull.none())}n.headRenderer=i;function s(T=B.create("enderdragon/dragon")){return O=>{const G=nt();return W(G,G,[8,8,8]),Nt(G,G,[.75,.75,.75]),vt(G,G,Math.PI),W(G,G,[-8,-11.2,-8]),new ct(void 0,{0:T.withPrefix("entity/").toString()},[{from:[2,4,-16],to:[14,9,0],faces:{north:{uv:[12,3.75,12.75,4.0625],texture:"#0"},east:{uv:[11,3.75,12,4.0625],texture:"#0"},south:{uv:[13.75,3.75,14.5,4.0625],texture:"#0"},west:{uv:[12.75,3.75,13.75,4.0625],texture:"#0"},up:{uv:[12.75,3.75,12,2.75],texture:"#0"},down:{uv:[13.5,2.75,12.75,3.75],texture:"#0"}}},{from:[0,0,-2],to:[16,16,14],faces:{north:{uv:[8,2.875,9,3.875],texture:"#0"},east:{uv:[7,2.875,8,3.875],texture:"#0"},south:{uv:[10,2.875,11,3.875],texture:"#0"},west:{uv:[9,2.875,10,3.875],texture:"#0"},up:{uv:[9,2.875,8,1.875],texture:"#0"},down:{uv:[10,1.875,9,2.875],texture:"#0"}}},{from:[2,0,-16],to:[14,4,0],rotation:{angle:-.2*180/Math.PI,axis:"x",origin:[8,4,-2]},faces:{north:{uv:[12,5.0625,12.75,5.3125],texture:"#0"},east:{uv:[11,5.0625,12,5.3125],texture:"#0"},south:{uv:[13.75,5.0625,14.5,5.3125],texture:"#0"},west:{uv:[12.75,5.0625,13.75,5.3125],texture:"#0"},up:{uv:[12.75,5.0625,12,4.0625],texture:"#0"},down:{uv:[13.5,4.0625,12.75,5.0625],texture:"#0"}}},{from:[3,16,4],to:[5,20,10],faces:{north:{uv:[.375,.375,.5,.625],texture:"#0"},east:{uv:[0,.375,.375,.625],texture:"#0"},south:{uv:[.875,.375,1,.625],texture:"#0"},west:{uv:[.5,.375,.875,.625],texture:"#0"},up:{uv:[.5,.375,.375,0],texture:"#0"},down:{uv:[.625,0,.5,.375],texture:"#0"}}},{from:[11,16,4],to:[13,20,10],faces:{north:{uv:[.375,.375,.5,.625],texture:"#0"},east:{uv:[0,.375,.375,.625],texture:"#0"},south:{uv:[.875,.375,1,.625],texture:"#0"},west:{uv:[.5,.375,.875,.625],texture:"#0"},up:{uv:[.5,.375,.375,0],texture:"#0"},down:{uv:[.625,0,.5,.375],texture:"#0"}}},{from:[3,9,-14],to:[5,11,-10],faces:{north:{uv:[7.25,.25,7.375,.375],texture:"#0"},east:{uv:[7,.25,7.25,.375],texture:"#0"},south:{uv:[7.625,.25,7.75,.375],texture:"#0"},west:{uv:[7.375,.25,7.625,.375],texture:"#0"},up:{uv:[7.375,.25,7.25,0],texture:"#0"},down:{uv:[7.5,0,7.375,.25],texture:"#0"}}},{from:[11,9,-14],to:[13,11,-10],faces:{north:{uv:[7.25,.25,7.375,.375],texture:"#0"},east:{uv:[7,.25,7.25,.375],texture:"#0"},south:{uv:[7.625,.25,7.75,.375],texture:"#0"},west:{uv:[7.375,.25,7.625,.375],texture:"#0"},up:{uv:[7.375,.25,7.25,0],texture:"#0"},down:{uv:[7.5,0,7.375,.25],texture:"#0"}}}]).withUvEpsilon(1/256).getMesh(O,u.Cull.none()).transform(G)}}n.dragonHeadRenderer=s;function a(T=B.create("piglin/piglin")){return O=>new ct(void 0,{0:T.withPrefix("entity/").toString()},[{from:[3,0,4],to:[13,8,12],faces:{north:{uv:[6.5,2,9,4],texture:"#0"},east:{uv:[2,2,0,4],texture:"#0"},south:{uv:[2,2,4.5,4],texture:"#0"},west:{uv:[6.5,2,4.5,4],texture:"#0"},up:{uv:[2,0,4.5,2],texture:"#0"},down:{uv:[4.5,0,7,2],texture:"#0"}}},{from:[6,0,12],to:[10,4,13],faces:{north:{uv:[9.25,.5,10.25,1.5],texture:"#0"},east:{uv:[7.75,.5,8,1.5],texture:"#0"},south:{uv:[8,.5,9,1.5],texture:"#0"},west:{uv:[9,.5,9.25,1.5],texture:"#0"},up:{uv:[8,.25,9,.5],texture:"#0"},down:{uv:[9,.25,10,.5],texture:"#0"}}},{from:[5,0,12],to:[6,2,13],faces:{north:{uv:[1.25,.25,1.5,.75],texture:"#0"},east:{uv:[.5,.25,.75,.75],texture:"#0"},south:{uv:[.75,.25,1,.75],texture:"#0"},west:{uv:[1,.25,1.25,.75],texture:"#0"},up:{uv:[.75,0,1,.25],texture:"#0"},down:{uv:[1,0,1.25,.25],texture:"#0"}}},{from:[10,0,12],to:[11,2,13],faces:{north:{uv:[1.25,1.25,1.5,1.75],texture:"#0"},east:{uv:[.5,1.25,.75,1.75],texture:"#0"},south:{uv:[.75,1.25,1,1.75],texture:"#0"},west:{uv:[1,1.25,1.25,1.75],texture:"#0"},up:{uv:[.75,1,1,1.25],texture:"#0"},down:{uv:[1,1,1.25,1.25],texture:"#0"}}},{from:[2.5,1.5,6],to:[3.5,6.5,10],rotation:{angle:-30,axis:"z",origin:[3,7,8]},faces:{north:{uv:[12,2.5,12.25,3.75],texture:"#0"},east:{uv:[9.75,2.5,10.75,3.75],texture:"#0"},south:{uv:[10.75,2.5,11,3.75],texture:"#0"},west:{uv:[11,2.5,12,3.75],texture:"#0"},up:{uv:[10.75,1.5,11,2.5],texture:"#0"},down:{uv:[11,1.5,11.25,2.5],texture:"#0"}}},{from:[12.5,1.5,6],to:[13.5,6.5,10],rotation:{angle:30,axis:"z",origin:[13,7,8]},faces:{north:{uv:[15.25,2.5,15,3.75],texture:"#0"},east:{uv:[15,2.5,14,3.75],texture:"#0"},south:{uv:[14,2.5,13.75,3.75],texture:"#0"},west:{uv:[13.75,2.5,12.75,3.75],texture:"#0"},up:{uv:[14,1.5,13.75,2.5],texture:"#0"},down:{uv:[14.25,1.5,14,2.5],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(O,u.Cull.none())}n.piglinHeadRenderer=a;function o(T){return O=>new ct(void 0,{0:T.withPrefix("entity/signs/").toString()},[{from:[-4,8,7],to:[20,20,9],faces:{north:{uv:[.5,1,6.5,7],texture:"#0"},east:{uv:[0,1,.5,7],texture:"#0"},south:{uv:[7,1,13,7],texture:"#0"},west:{uv:[6.5,1,7,7],texture:"#0"},up:{uv:[6.5,1,.5,0],texture:"#0"},down:{uv:[12.5,0,6.5,1],texture:"#0"}}},{from:[7,-6,7],to:[9,8,9],faces:{north:{uv:[.5,8,1,15],texture:"#0"},east:{uv:[0,8,.5,15],texture:"#0"},south:{uv:[1.5,8,2,15],texture:"#0"},west:{uv:[1,8,1.5,15],texture:"#0"},up:{uv:[1,8,.5,7],texture:"#0"},down:{uv:[1.5,7,1,8],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(O,u.Cull.none())}n.signRenderer=o;function g(T){return O=>new ct(void 0,{0:T.withPrefix("entity/signs/").toString()},[{from:[-4,4,17],to:[20,16,19],faces:{north:{uv:[.5,1,6.5,7],texture:"#0"},east:{uv:[0,1,.5,7],texture:"#0"},south:{uv:[7,1,13,7],texture:"#0"},west:{uv:[6.5,1,7,7],texture:"#0"},up:{uv:[6.5,1,.5,0],texture:"#0"},down:{uv:[12.5,0,6.5,1],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(O,u.Cull.none())}n.wallSignRenderer=g;function c(T){return(O,G)=>O?new ct(void 0,{0:T.withPrefix("entity/signs/hanging/").toString()},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[2,10,8],to:[14,16,8],faces:{north:{uv:[3.5,3,6.5,6],texture:"#0"},south:{uv:[3.5,3,6.5,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(G,u.Cull.none()):new ct(void 0,{0:T.withPrefix("entity/signs/hanging/").toString()},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[1.5,10,8],to:[4.5,16,8],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[3,10,6.5],to:[3,16,9.5],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}},{from:[11.5,10,8],to:[14.5,16,8],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[13,10,6.5],to:[13,16,9.5],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(G,u.Cull.none())}n.hangingSignRenderer=c;function l(T){return O=>new ct(void 0,{0:`entity/signs/hanging/${T}`},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[0,14,6],to:[16,16,10],faces:{north:{uv:[1,2,5,3],texture:"#0"},east:{uv:[0,2,1,3],texture:"#0"},south:{uv:[6,2,10,3],texture:"#0"},west:{uv:[5,2,6,3],texture:"#0"},up:{uv:[5,2,1,0],texture:"#0"},down:{uv:[9,0,5,2],texture:"#0"}}},{from:[1.5,10,8],to:[4.5,16,8],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[3,10,6.5],to:[3,16,9.5],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}},{from:[11.5,10,8],to:[14.5,16,8],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[13,10,6.5],to:[13,16,9.5],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(O,u.Cull.none())}n.wallHangingSignRenderer=l;function h(T){return new ct(void 0,{0:"entity/conduit/base"},[{from:[5,5,5],to:[11,11,11],faces:{north:{uv:[3,6,6,12],texture:"#0"},east:{uv:[0,6,3,12],texture:"#0"},south:{uv:[9,6,12,12],texture:"#0"},west:{uv:[6,6,9,12],texture:"#0"},up:{uv:[6,6,3,0],texture:"#0"},down:{uv:[9,0,6,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(T,u.Cull.none())}n.conduitRenderer=h;function d(T){return O=>new ct(void 0,{0:T.withPrefix("entity/shulker/").toString()},[{from:[0,0,0],to:[16,8,16],faces:{north:{uv:[4,11,8,13],texture:"#0"},east:{uv:[0,11,4,13],texture:"#0"},south:{uv:[12,11,16,13],texture:"#0"},west:{uv:[8,11,12,13],texture:"#0"},up:{uv:[8,11,4,7],texture:"#0"},down:{uv:[12,7,8,11],texture:"#0"}}},{from:[0,4,0],to:[16,16,16],faces:{north:{uv:[4,4,8,7],texture:"#0"},east:{uv:[0,4,4,7],texture:"#0"},south:{uv:[12,4,16,7],texture:"#0"},west:{uv:[8,4,12,7],texture:"#0"},up:{uv:[8,4,4,0],texture:"#0"},down:{uv:[12,0,8,4],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(O,u.Cull.none())}n.shulkerBoxRenderer=d;const f=T=>({north:{uv:[.25,.25,5.25,10.25],texture:`#${T}`,tintindex:T},east:{uv:[0,.25,.25,10.25],texture:`#${T}`,tintindex:T},south:{uv:[5.5,.25,10.5,10.25],texture:`#${T}`,tintindex:T},west:{uv:[5.25,.25,5.5,10.25],texture:`#${T}`,tintindex:T},up:{uv:[5.25,.25,.25,0],texture:`#${T}`,tintindex:T},down:{uv:[10.25,0,5.25,.25],texture:`#${T}`,tintindex:T}});function w(T,O){return(G,H)=>{const j={0:"entity/banner_base"},k=[...O.base],b=[T];return H==null||H.forEach((P,z)=>{const Z=B.parse(P.getString("pattern")).path,K=P.getString("color");z++,j[z]=`entity/banner/${Z}`,k.push(O.pattern(z)),b.push(K)}),new ct(void 0,j,k).getMesh(G,u.Cull.none(),P=>{var z;return(z=ze[b[P]])==null?void 0:z.call(ze,{})})}}n.bannerRenderer=T=>w(T,{base:[{from:[-2,-8,6],to:[18,32,7],faces:f(0)},{from:[7,-12,7],to:[9,30,9],faces:{north:{uv:[11.5,.5,12,11],texture:"#0"},east:{uv:[11,.5,11.5,11],texture:"#0"},south:{uv:[12.5,.5,13,11],texture:"#0"},west:{uv:[12,.5,12.5,11],texture:"#0"},up:{uv:[12,.5,11.5,0],texture:"#0"},down:{uv:[12.5,0,12,.5],texture:"#0"}}},{from:[-2,30,7],to:[18,32,9],faces:{north:{uv:[.5,11,5.5,11.5],texture:"#0"},east:{uv:[0,11,.5,11.5],texture:"#0"},south:{uv:[6,11,11,11.5],texture:"#0"},west:{uv:[5.5,11,6,11.5],texture:"#0"},up:{uv:[5.5,11,.5,10.5],texture:"#0"},down:{uv:[10.5,10.5,5.5,11],texture:"#0"}}}],pattern:O=>({from:[-2,-8,6],to:[18,32,7],faces:f(O)})}),n.wallBannerRenderer=T=>w(T,{base:[{from:[-2,-8,-1.5],to:[18,32,-.5],faces:f(0)},{from:[-2,30,-3.5],to:[18,32,-1.5],faces:{north:{uv:[.5,11,5.5,11.5],texture:"#0"},east:{uv:[0,11,.5,11.5],texture:"#0"},south:{uv:[6,11,11,11.5],texture:"#0"},west:{uv:[5.5,11,6,11.5],texture:"#0"},up:{uv:[5.5,11,.5,10.5],texture:"#0"},down:{uv:[10.5,10.5,5.5,11],texture:"#0"}}}],pattern:O=>({from:[-2,-8,-1.5],to:[18,32,-.5],faces:f(O)})});function v(T){return new ct(void 0,{0:"entity/bell/bell_body"},[{from:[5,3,5],to:[11,10,11],faces:{north:{uv:[3,3,6,6.5],texture:"#0"},east:{uv:[0,3,3,6.5],texture:"#0"},south:{uv:[9,3,12,6.5],texture:"#0"},west:{uv:[6,3,9,6.5],texture:"#0"},up:{uv:[6,3,3,0],texture:"#0"},down:{uv:[9,0,6,3],texture:"#0"}}},{from:[4,10,4],to:[12,12,12],faces:{north:{uv:[4,10.5,8,11.5],texture:"#0"},east:{uv:[0,10.5,4,11.5],texture:"#0"},south:{uv:[12,10.5,16,11.5],texture:"#0"},west:{uv:[8,10.5,12,11.5],texture:"#0"},up:{uv:[8,10.5,4,6.5],texture:"#0"},down:{uv:[12,6.5,8,10.5],texture:"#0"}}}]).withUvEpsilon(1/64).getMesh(T,u.Cull.none())}n.bellRenderer=v;function m(T){return(O,G)=>O==="foot"?new ct(void 0,{0:T.withPrefix("entity/bed/").toString()},[{from:[0,3,0],to:[16,9,16],faces:{north:{uv:[5.5,5.5,9.5,7],rotation:180,texture:"#0"},east:{uv:[0,7,1.5,11],rotation:270,texture:"#0"},west:{uv:[5.5,7,7,11],rotation:90,texture:"#0"},up:{uv:[5.5,11,1.5,7],texture:"#0"},down:{uv:[11,7,7,11],texture:"#0"}}},{from:[0,0,0],to:[3,3,3],faces:{north:{uv:[12.5,5.25,13.25,6],texture:"#0"},east:{uv:[14.75,5.25,15.5,6],texture:"#0"},south:{uv:[14,5.25,14.75,6],texture:"#0"},west:{uv:[13.25,5.25,14,6],texture:"#0"},up:{uv:[13.25,4.5,14,5.25],texture:"#0"},down:{uv:[14,4.5,14.75,5.25],texture:"#0"}}},{from:[13,0,0],to:[16,3,3],faces:{north:{uv:[13.25,3.75,14,4.5],texture:"#0"},east:{uv:[12.5,3.75,13.25,4.5],texture:"#0"},south:{uv:[14.75,3.75,15.5,4.5],texture:"#0"},west:{uv:[14,3.75,14.75,4.5],texture:"#0"},up:{uv:[13.25,3,14,3.75],texture:"#0"},down:{uv:[14,3,14.75,3.75],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(G,u.Cull.none()):new ct(void 0,{0:T.withPrefix("entity/bed/").toString()},[{from:[0,3,0],to:[16,9,16],faces:{east:{uv:[0,1.5,1.5,5.5],rotation:270,texture:"#0"},south:{uv:[1.5,0,5.5,1.5],rotation:180,texture:"#0"},west:{uv:[5.5,1.5,7,5.5],rotation:90,texture:"#0"},up:{uv:[5.5,5.5,1.5,1.5],texture:"#0"},down:{uv:[11,1.5,7,5.5],texture:"#0"}}},{from:[0,0,13],to:[3,3,16],faces:{north:{uv:[14.75,.75,15.5,1.5],texture:"#0"},east:{uv:[14,.75,14.75,1.5],texture:"#0"},south:{uv:[13.25,.75,14,1.5],texture:"#0"},west:{uv:[12.5,.75,13.25,1.5],texture:"#0"},up:{uv:[13.25,0,14,.75],texture:"#0"},down:{uv:[14,0,14.75,.75],texture:"#0"}}},{from:[13,0,13],to:[16,3,16],faces:{north:{uv:[14,2.25,14.75,3],texture:"#0"},east:{uv:[13.25,2.25,14,3],texture:"#0"},south:{uv:[12.5,2.25,13.25,3],texture:"#0"},west:{uv:[14.75,2.25,15.5,3],texture:"#0"},up:{uv:[13.25,1.5,14,2.25],texture:"#0"},down:{uv:[14,1.5,14.75,2.25],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(G,u.Cull.none())}n.bedRenderer=m;function p(T,O,G=""){var H;return(H=T.getProperty(O))!=null?H:G}function S(T,O,G="0"){var H;return parseInt((H=T.getProperty(O))!=null?H:G)}const E=new Map(Object.entries({"minecraft:chest":n.chestRenderer(B.create("normal")),"minecraft:ender_chest":n.chestRenderer(B.create("ender")),"minecraft:trapped_chest":n.chestRenderer(B.create("trapped"))})),y=new Map(Object.entries({"minecraft:skeleton_skull":n.headRenderer(B.create("skeleton/skeleton"),2),"minecraft:wither_skeleton_skull":n.headRenderer(B.create("skeleton/wither_skeleton"),2),"minecraft:zombie_head":n.headRenderer(B.create("zombie/zombie"),1),"minecraft:creeper_head":n.headRenderer(B.create("creeper/creeper"),2),"minecraft:dragon_head":n.dragonHeadRenderer(),"minecraft:piglin_head":n.piglinHeadRenderer(),"minecraft:player_head":n.headRenderer(B.create("player/wide/steve"),1)})),x=["oak","spruce","birch","jungle","acacia","dark_oak","mangrove","cherry","bamboo","crimson","warped"],A=new Map(x.map(T=>[`minecraft:${T}_sign`,n.signRenderer(B.create(T))])),I=new Map(x.map(T=>[`minecraft:${T}_wall_sign`,n.wallSignRenderer(B.create(T))])),R=new Map(x.map(T=>[`minecraft:${T}_hanging_sign`,n.hangingSignRenderer(B.create(T))])),C=new Map(x.map(T=>[`minecraft:${T}_wall_hanging_sign`,n.wallHangingSignRenderer(T)])),M=new Map(Object.keys(ze).map(T=>[`minecraft:${T}_shulker_box`,n.shulkerBoxRenderer(B.create(`shulker_${T}`))])),N=new Map(Object.keys(ze).map(T=>[`minecraft:${T}_bed`,n.bedRenderer(B.create(T))])),L=new Map(Object.keys(ze).map(T=>[`minecraft:${T}_banner`,n.bannerRenderer(T)])),F=new Map(Object.keys(ze).map(T=>[`minecraft:${T}_wall_banner`,n.wallBannerRenderer(T)]));function U(T,O,G){const H=T.state,j=T.nbt,k=new it;H.is("water")&&k.merge(ii("water",S(H,"level"),O,G,0)),H.is("lava")&&k.merge(ii("lava",S(H,"level"),O,G));const b=E.get(H.getName().toString());if(b!==void 0){const V=p(H,"facing","south"),J=nt();W(J,J,[8,8,8]),vt(J,J,V==="west"?Math.PI/2:V==="south"?Math.PI:V==="east"?Math.PI*3/2:0),W(J,J,[-8,-8,-8]),k.merge(b(O).transform(J))}H.is("decorated_pot")&&k.merge(e(O));const P=y.get(H.getName().toString());if(P!==void 0){const V=S(H,"rotation")/16*Math.PI*2,J=nt();W(J,J,[8,8,8]),vt(J,J,V),W(J,J,[-8,-8,-8]),k.merge(P(O).transform(J))}const z=A.get(H.getName().toString());if(z!==void 0){const V=S(H,"rotation")/16*Math.PI*2,J=nt();W(J,J,[8,8,8]),vt(J,J,V),Nt(J,J,[2/3,2/3,2/3]),W(J,J,[-8,-8,-8]),k.merge(z(O).transform(J))}const Z=I.get(H.getName().toString());if(Z!==void 0){const V=p(H,"facing","south"),J=nt();W(J,J,[8,8,8]),vt(J,J,V==="west"?Math.PI/2:V==="south"?Math.PI:V==="east"?Math.PI*3/2:0),Nt(J,J,[2/3,2/3,2/3]),W(J,J,[-8,-8,-8]),k.merge(Z(O).transform(J))}const K=R.get(H.getName().toString());if(K!==void 0){const V=p(H,"attached","false")==="true",J=S(H,"rotation")/16*Math.PI*2,ot=nt();W(ot,ot,[8,8,8]),vt(ot,ot,J),Nt(ot,ot,[2/3,2/3,2/3]),W(ot,ot,[-8,-8,-8]),k.merge(K(V,O).transform(ot))}const At=C.get(H.getName().toString());if(At!==void 0){const V=p(H,"facing","south"),J=nt();W(J,J,[8,8,8]),vt(J,J,V==="west"?Math.PI/2:V==="south"?Math.PI:V==="east"?Math.PI*3/2:0),W(J,J,[-8,-8,-8]),k.merge(At(O).transform(J))}H.is("conduit")&&k.merge(h(O));const Mt=M.get(H.getName().toString());if(Mt!==void 0){const V=p(H,"facing","up"),J=nt();W(J,J,[8,8,8]),V==="down"?xn(J,J,Math.PI):V!=="up"&&(vt(J,J,V==="east"?Math.PI/2:V==="north"?Math.PI:V==="west"?Math.PI*3/2:0),xn(J,J,Math.PI/2)),W(J,J,[-8,-8,-8]),k.merge(Mt(O).transform(J))}if(H.is("bell")){const V=nt();W(V,V,[8,8,8]),Nt(V,V,[1,-1,-1]),W(V,V,[-8,-8,-8]),k.merge(v(O).transform(V))}const Et=N.get(H.getName().toString());if(Et!==void 0){const V=p(H,"part","head"),J=p(H,"facing","south"),ot=nt();W(ot,ot,[8,8,8]),vt(ot,ot,J==="east"?Math.PI/2:J==="north"?Math.PI:J==="west"?Math.PI*3/2:0),W(ot,ot,[-8,-8,-8]),k.merge(Et(V,O).transform(ot))}const ut=L.get(H.getName().toString());if(ut!==void 0){const V=S(H,"rotation")/16*Math.PI*2,J=nt();W(J,J,[8,24,8]),vt(J,J,V),Nt(J,J,[2/3,2/3,2/3]),W(J,J,[-8,-24,-8]),k.merge(ut(O,j==null?void 0:j.getList("patterns",D.Compound)).transform(J))}const ht=F.get(H.getName().toString());if(ht!==void 0){const V=p(H,"facing","south"),J=nt();W(J,J,[8,8,8]),vt(J,J,V==="east"?Math.PI/2:V==="north"?Math.PI:V==="west"?Math.PI*3/2:0),Nt(J,J,[2/3,2/3,2/3]),W(J,J,[-8,-23.2,-8]),k.merge(ht(O,j==null?void 0:j.getList("patterns",D.Compound)).transform(J))}!H.is("water")&&!H.is("lava")&&H.isWaterlogged()&&k.merge(ii("water",0,O,G,0));const lt=nt();return Nt(lt,lt,[.0625,.0625,.0625]),k.transform(lt)}n.getBlockMesh=U})(u.SpecialRenderers||(u.SpecialRenderers={}));class Ws{constructor(t,e,r,i=16){_(this,"chunks",[]);_(this,"chunkSize");this.gl=t,this.structure=e,this.resources=r,this.chunkSize=typeof i=="number"?[i,i,i]:i,this.updateStructureBuffers()}setStructure(t){this.structure=t,this.updateStructureBuffers()}updateStructureBuffers(t){var e,r;if(!!this.structure){t?t.forEach(i=>{const s=this.getChunk(i);s.mesh.clear(),s.transparentMesh.clear()}):this.chunks.forEach(i=>i.forEach(s=>s.forEach(a=>{a.mesh.clear(),a.transparentMesh.clear()})));for(const i of this.structure.getBlocks()){const s=i.state.getName(),a=i.state.getProperties(),o=(e=this.resources.getDefaultBlockProperties(s))!=null?e:{};Object.entries(o).forEach(([l,h])=>{a[l]||(a[l]=h)});const g=[Math.floor(i.pos[0]/this.chunkSize[0]),Math.floor(i.pos[1]/this.chunkSize[1]),Math.floor(i.pos[2]/this.chunkSize[2])];if(t&&!t.some(l=>Gl(l,g)))continue;const c=this.getChunk(g);try{const l=this.resources.getBlockDefinition(s),h={up:this.needsCull(i,u.Direction.UP),down:this.needsCull(i,u.Direction.DOWN),west:this.needsCull(i,u.Direction.WEST),east:this.needsCull(i,u.Direction.EAST),north:this.needsCull(i,u.Direction.NORTH),south:this.needsCull(i,u.Direction.SOUTH)},d=new it;l&&d.merge(l.getMesh(s,a,this.resources,this.resources,h));const f=u.SpecialRenderers.getBlockMesh(i,this.resources,h);f.isEmpty()||d.merge(f),d.isEmpty()||(this.finishChunkMesh(d,i.pos),(r=this.resources.getBlockFlags(i.state.getName()))!=null&&r.semi_transparent?c.transparentMesh.merge(d):c.mesh.merge(d))}catch(l){console.error(`Error rendering block ${s}`,l)}}t?t.forEach(i=>{const s=this.getChunk(i);s.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0}),s.transparentMesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})}):this.chunks.forEach(i=>i.forEach(s=>s.forEach(a=>{a.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0}),a.transparentMesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})})))}}getMeshes(){const t=this.chunks.flatMap(e=>e.flatMap(r=>r.flatMap(i=>i!=null?i:[])));return t.flatMap(e=>e.mesh.isEmpty()?[]:e.mesh).concat(t.flatMap(e=>e.transparentMesh.isEmpty()?[]:e.transparentMesh))}needsCull(t,e){var s;const r=(s=this.structure.getBlock(u.BlockPos.towards(t.pos,e)))==null?void 0:s.state;if(!r)return!1;const i=this.resources.getBlockFlags(r.getName());return t.state.getName().equals(r.getName())&&(i==null?void 0:i.self_culling)?!0:i!=null&&i.opaque?!(e===u.Direction.UP&&t.state.isWaterlogged()):t.state.isWaterlogged()&&r.isWaterlogged()}finishChunkMesh(t,e){const r=nt();W(r,r,e),t.transform(r);for(const i of t.quads){const s=i.normal();i.forEach(a=>a.normal=s),i.forEach(a=>a.blockPos=new Y(e[0],e[1],e[2]))}}getChunk(t){const e=Math.abs(t[0])*2+(t[0]<0?1:0),r=Math.abs(t[1])*2+(t[1]<0?1:0),i=Math.abs(t[2])*2+(t[2]<0?1:0);return this.chunks[e]||(this.chunks[e]=[]),this.chunks[e][r]||(this.chunks[e][r]=[]),this.chunks[e][r][i]||(this.chunks[e][r][i]={mesh:new it,transparentMesh:new it}),this.chunks[e][r][i]}}class Nn{constructor(t,e,r){_(this,"gl");_(this,"program");this.gl=t,this.program=this.initShaderProgram(e,r)}getProgram(){return this.program}initShaderProgram(t,e){const r=this.loadShader(this.gl.VERTEX_SHADER,t),i=this.loadShader(this.gl.FRAGMENT_SHADER,e),s=this.gl.createProgram();if(this.gl.attachShader(s,r),this.gl.attachShader(s,i),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS))throw new Error(`Unable to link shader program: ${this.gl.getProgramInfoLog(s)}`);return s}loadShader(t,e){const r=this.gl.createShader(t);if(this.gl.shaderSource(r,e),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)){const i=new Error(`Compiling ${t===this.gl.VERTEX_SHADER?"vertex":"fragment"} shader: ${this.gl.getShaderInfoLog(r)}`);throw this.gl.deleteShader(r),i}return r}}const pu=`
  attribute vec4 vertPos;
  attribute vec2 texCoord;
  attribute vec3 vertColor;
  attribute vec3 normal;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec2 vTexCoord;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vTexCoord = texCoord;
    vTintColor = vertColor;
    vLighting = normal.y * 0.2 + abs(normal.z) * 0.1 + 0.8;
  }
`,vu=`
  precision highp float;
  varying highp vec2 vTexCoord;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  uniform sampler2D sampler;

  void main(void) {
		vec4 texColor = texture2D(sampler, vTexCoord);
		if(texColor.a < 0.01) discard;
		gl_FragColor = vec4(texColor.xyz * vTintColor * vLighting, texColor.a);
  }
`;class hr{constructor(t){_(this,"shaderProgram");_(this,"projMatrix");_(this,"activeShader");this.gl=t,this.shaderProgram=new Nn(t,pu,vu).getProgram(),this.activeShader=this.shaderProgram,this.projMatrix=this.getPerspective(),this.initialize()}setViewport(t,e,r,i){this.gl.viewport(t,e,r,i),this.projMatrix=this.getPerspective()}getPerspective(){const t=70*Math.PI/180,e=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,r=nt();return Tl(r,t,e,.1,500),r}initialize(){this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK)}setShader(t){this.gl.useProgram(t),this.activeShader=t}setVertexAttr(t,e,r){if(r===void 0)throw new Error(`Expected buffer for ${t}`);const i=this.gl.getAttribLocation(this.activeShader,t);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.vertexAttribPointer(i,e,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(i)}setUniform(t,e){const r=this.gl.getUniformLocation(this.activeShader,t);this.gl.uniformMatrix4fv(r,!1,e)}setTexture(t){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t)}createAtlasTexture(t){const e=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),e}prepareDraw(t){this.setUniform("mView",t),this.setUniform("mProj",this.projMatrix)}drawMesh(t,e){if(t.quadVertices()>0){if(e.pos&&this.setVertexAttr("vertPos",3,t.posBuffer),e.color&&this.setVertexAttr("vertColor",3,t.colorBuffer),e.texture&&this.setVertexAttr("texCoord",2,t.textureBuffer),e.normal&&this.setVertexAttr("normal",3,t.normalBuffer),e.blockPos&&this.setVertexAttr("blockPos",3,t.blockPosBuffer),!t.indexBuffer)throw new Error("Expected index buffer");this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,t.quadIndices(),this.gl.UNSIGNED_SHORT,0)}t.lineVertices()>0&&(e.pos&&this.setVertexAttr("vertPos",3,t.linePosBuffer),e.color&&this.setVertexAttr("vertColor",3,t.lineColorBuffer),this.gl.drawArrays(this.gl.LINES,0,t.lineVertices()))}}class fr extends hr{constructor(e,r,i,s={}){super(e);_(this,"mesh");_(this,"atlasTexture");this.item=r,this.resources=i,this.updateMesh(s),this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setItem(e,r={}){this.item=e,this.updateMesh(r)}updateMesh(e={}){this.mesh=fr.getItemMesh(this.item,this.resources,e),this.mesh.computeNormals(),this.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0})}static getItemMesh(e,r,i){var g;const s=(g=e.getComponent("item_model",r))==null?void 0:g.getAsString();if(s===void 0)return new it;const a=r.getItemModel(B.parse(s));if(!a)throw new Error(`Item model ${s} does not exist (defined by item ${e.toString()})`);return a.getMesh(e,r,i)}getPerspective(){const e=nt();return Ll(e,0,16,0,16,.1,500),e}drawItem(){const e=nt();W(e,e,[0,0,-32]),this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture),this.prepareDraw(e),this.drawMesh(this.mesh,{pos:!0,color:!0,texture:!0,normal:!0})}}const De=[0,0,0];u.ItemTint=void 0,(n=>{function t(l){var f,w,v,m,p,S,E,y,x,A,I,R;const h=(f=u.Json.readObject(l))!=null?f:{},d=(w=u.Json.readString(h.type))==null?void 0:w.replace(/^minecraft:/,"");switch(d){case"constant":return new e((v=u.Color.fromJson(h.value))!=null?v:De);case"dye":return new r((m=u.Color.fromJson(h.default))!=null?m:De);case"grass":return new i((p=u.Json.readNumber(h.temperature))!=null?p:0,(S=u.Json.readNumber(h.downfall))!=null?S:0);case"firework":return new s((E=u.Color.fromJson(h.default))!=null?E:De);case"potion":return new a((y=u.Color.fromJson(h.default))!=null?y:De);case"map_color":return new o((x=u.Color.fromJson(h.default))!=null?x:De);case"custom_model_data":return new g((A=u.Json.readInt(h.index))!=null?A:0,(I=u.Color.fromJson(h.default))!=null?I:De);case"team":return new c((R=u.Color.fromJson(h.default))!=null?R:De);default:throw new Error(`Invalid item tint type ${d}`)}}n.fromJson=t;class e{constructor(h){this.value=h}getTint(h){return this.value}}n.Constant=e;class r{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("dyed_color",d);return f?f.isCompound()?u.Color.intToRgb(f.getNumber("rgb")):u.Color.intToRgb(f.getAsNumber()):this.default_color}}n.Dye=r;class i{constructor(h,d){this.temperature=h,this.downfall=d}getTint(h){return[124/255,189/255,107/255]}}n.Grass=i;class s{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("firework_explosion",d);if(!(f!=null&&f.isCompound()))return this.default_color;const w=f.get("colors");return!w||!w.isListOrArray()?this.default_color:(()=>{if(w.length===1)return u.Color.intToRgb(w.get(0).getAsNumber());let[m,p,S]=[0,0,0];for(const E of w.getItems())m+=(E.getAsNumber()&16711680)>>16,p+=(E.getAsNumber()&65280)>>8,S+=(E.getAsNumber()&255)>>0;return m/=w.length,p/=w.length,S/=w.length,[m/255,p/255,S/255]})()}}n.Firework=s;class a{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("potion_contents",d);if(!f)return this.default_color;const w=u.PotionContents.fromNbt(f);return u.PotionContents.getColor(w)}}n.Potion=a;class o{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("map_color",d);return f?u.Color.intToRgb(f.getAsNumber()):this.default_color}}n.MapColor=o;class g{constructor(h,d){this.index=h,this.default_color=d}getTint(h,d){var v;const f=h.getComponent("custom_model_data",d);if(!(f!=null&&f.isCompound()))return this.default_color;const w=f.getList("colors").get(this.index);return w?(v=u.Color.fromNbt(w))!=null?v:this.default_color:this.default_color}}n.CustomModelData=g;class c{constructor(h){this.default_color=h}getTint(h,d,f){var w;return(w=f.context_entity_team_color)!=null?w:this.default_color}}n.Team=c})(u.ItemTint||(u.ItemTint={}));var si;(n=>{function t(f){var m,p,S,E,y,x,A,I,R,C,M,N,L;const w=(m=u.Json.readObject(f))!=null?m:{},v=(p=u.Json.readString(w.type))==null?void 0:p.replace(/^minecraft:/,"");switch(v){case"bed":return new e(B.parse((S=u.Json.readString(w.texture))!=null?S:""));case"banner":return new r((E=u.Json.readString(w.color))!=null?E:"");case"conduit":return new i;case"chest":return new s(B.parse((y=u.Json.readString(w.texture))!=null?y:""),(x=u.Json.readNumber(w.openness))!=null?x:0);case"head":return new a((A=u.Json.readString(w.kind))!=null?A:"",typeof w.texture=="string"?B.parse(w.texture):void 0,(I=u.Json.readNumber(w.animation))!=null?I:0);case"shulker_box":return new o(B.parse((R=u.Json.readString(w.texture))!=null?R:""),(C=u.Json.readNumber(w.openness))!=null?C:0,(M=u.Json.readString(w.orientation))!=null?M:"up");case"shield":return new g;case"trident":return new c;case"decorated_pot":return new l;case"standing_sign":return new h((N=u.Json.readString(w.wood_type))!=null?N:"",typeof w.texture=="string"?B.parse(w.texture):void 0);case"hanging_sign":return new d((L=u.Json.readString(w.wood_type))!=null?L:"",typeof w.texture=="string"?B.parse(w.texture):void 0);default:throw new Error(`Invalid item model type ${v}`)}}n.fromJson=t;class e{constructor(w){_(this,"renderer");this.renderer=u.SpecialRenderers.bedRenderer(w)}getMesh(w,v){const m=this.renderer("head",v),p=this.renderer("foot",v),S=nt();return W(S,S,[0,0,-16]),m.merge(p.transform(S))}}class r{constructor(w){_(this,"renderer");this.renderer=u.SpecialRenderers.bannerRenderer(w)}getMesh(w,v){const m=w.getComponent("banner_patterns",void 0),p=nt();return W(p,p,[8,24,8]),vt(p,p,Math.PI),Nt(p,p,[2/3,2/3,2/3]),W(p,p,[-8,-24,-8]),this.renderer(v,m instanceof xt?m:void 0).transform(p)}}class i{getMesh(w,v){return u.SpecialRenderers.conduitRenderer(v)}}class s{constructor(w,v){_(this,"renderer");this.renderer=u.SpecialRenderers.chestRenderer(w)}getMesh(w,v){const m=nt();return W(m,m,[8,8,8]),vt(m,m,Math.PI),W(m,m,[-8,-8,-8]),this.renderer(v).transform(m)}}class a{constructor(w,v,m){_(this,"renderer");var p;this.renderer=((p={skeleton:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("skeleton/skeleton"),2),wither_skeleton:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("skeleton/wither_skeleton"),2),zombie:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("zombie/zombie"),1),creeper:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("creeper/creeper"),2),dragon:()=>u.SpecialRenderers.dragonHeadRenderer(v),piglin:()=>u.SpecialRenderers.piglinHeadRenderer(v),player:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("player/wide/steve"),1)}[w])!=null?p:()=>()=>new it)()}getMesh(w,v){return this.renderer(v)}}class o{constructor(w,v,m){_(this,"renderer");this.renderer=u.SpecialRenderers.shulkerBoxRenderer(w)}getMesh(w,v){return this.renderer(v)}}class g{getMesh(w,v){const m=u.SpecialRenderers.shieldRenderer(v),p=nt();return W(p,p,[-3,1,0]),xn(p,p,-10*Math.PI/180),vt(p,p,-10*Math.PI/180),Hs(p,p,-5*Math.PI/180),m.transform(p)}}class c{getMesh(w,v){return new it}}class l{getMesh(w,v){return u.SpecialRenderers.decoratedPotRenderer(v)}}class h{constructor(w,v){_(this,"renderer");this.renderer=u.SpecialRenderers.signRenderer(v!=null?v:B.create(w))}getMesh(w,v){return this.renderer(v)}}class d{constructor(w,v){_(this,"renderer");this.renderer=u.SpecialRenderers.hangingSignRenderer(v!=null?v:B.create(w))}getMesh(w,v){return this.renderer(!1,v)}}})(si||(si={}));const Xs=new it;u.ItemModel=void 0,(n=>{function t(l){var f,w,v,m,p,S,E,y,x;const h=(f=u.Json.readObject(l))!=null?f:{},d=(w=u.Json.readString(h.type))==null?void 0:w.replace(/^minecraft:/,"");switch(d){case"empty":return new e;case"model":return new r(B.parse((v=u.Json.readString(h.model))!=null?v:""),(m=u.Json.readArray(h.tints,u.ItemTint.fromJson))!=null?m:[]);case"composite":return new i((p=u.Json.readArray(h.models,n.fromJson))!=null?p:[]);case"condition":return new s(s.propertyFromJson(h),n.fromJson(h.on_true),n.fromJson(h.on_false));case"select":return new a(a.propertyFromJson(h),new Map((S=u.Json.readArray(h.cases,A=>{var I;return(I=u.Json.readObject(A))!=null?I:{}}))==null?void 0:S.flatMap(A=>{var R;const I=n.fromJson(A.model);return Array.isArray(A.when)?A.when.map(C=>{var M;return[(M=u.Json.readString(C))!=null?M:"",I]}):[[(R=u.Json.readString(A.when))!=null?R:"",I]]})),h.fallback?n.fromJson(h.fallback):void 0);case"range_dispatch":return new o(o.propertyFromJson(h),(E=u.Json.readNumber(h.scale))!=null?E:1,(y=u.Json.readArray(h.entries,A=>{var R,C;const I=(R=u.Json.readObject(A))!=null?R:{};return{threshold:(C=u.Json.readNumber(I.threshold))!=null?C:0,model:n.fromJson(I.model)}}))!=null?y:[],h.fallback?n.fromJson(h.fallback):void 0);case"special":return new g(si.fromJson(h.model),B.parse((x=u.Json.readString(h.base))!=null?x:""));case"bundle/selected_item":return new c;default:throw new Error(`Invalid item model type ${d}`)}}n.fromJson=t;class e{getMesh(h,d,f){return new it}}n.Empty=e;class r{constructor(h,d){this.modelId=h,this.tints=d}getMesh(h,d,f){var p;const w=d.getBlockModel(this.modelId);if(!w)throw new Error(`Model ${this.modelId} does not exist (trying to render ${h.toString()})`);const v=S=>S<this.tints.length?this.tints[S].getTint(h,d,f):[1,1,1],m=w.getMesh(d,u.Cull.none(),v);return m.transform(w.getDisplayTransform((p=f.display_context)!=null?p:"gui")),m}}n.Model=r;class i{constructor(h){this.models=h}getMesh(h,d,f){const w=new it;return this.models.forEach(v=>w.merge(v.getMesh(h,d,f))),w}}n.Composite=i;class s{constructor(h,d,f){this.property=h,this.onTrue=d,this.onFalse=f}getMesh(h,d,f){return(this.property(h,d,f)?this.onTrue:this.onFalse).getMesh(h,d,f)}static propertyFromJson(h){var f,w,v,m,p;const d=(f=u.Json.readString(h.property))==null?void 0:f.replace(/^minecraft:/,"");switch(d){case"fishing_rod/cast":case"selected":case"carried":case"extended_view":return(A,I,R)=>{var C;return(C=R[d])!=null?C:!1};case"view_entity":return(A,I,R)=>{var C;return(C=R.context_entity_is_view_entity)!=null?C:!1};case"using_item":return(A,I,R)=>{var C;return((C=R.use_duration)!=null?C:-1)>=0};case"bundle/has_selected_item":return(A,I,R)=>{var C;return((C=R["bundle/selected_item"])!=null?C:-1)>=0};case"broken":return(A,I,R)=>{var N,L;const C=(N=A.getComponent("damage",I))==null?void 0:N.getAsNumber(),M=(L=A.getComponent("max_damage",I))==null?void 0:L.getAsNumber();return C!==void 0&&M!==void 0&&C>=M-1};case"damaged":return(A,I,R)=>{var N,L;const C=(N=A.getComponent("damage",I))==null?void 0:N.getAsNumber(),M=(L=A.getComponent("max_damage",I))==null?void 0:L.getAsNumber();return C!==void 0&&M!==void 0&&C>=1};case"has_component":const S=B.parse((w=u.Json.readString(h.component))!=null?w:""),E=(v=u.Json.readBoolean(h.ignore_default))!=null?v:!1;return(A,I,R)=>A.hasComponent(S,E?void 0:I);case"keybind_down":const y=(m=u.Json.readString(h.keybind))!=null?m:"";return(A,I,R)=>{var C,M;return(M=(C=R.keybind_down)==null?void 0:C.includes(y))!=null?M:!1};case"custom_model_data":const x=(p=u.Json.readInt(h.index))!=null?p:0;return(A,I,R)=>{const C=A.getComponent("custom_model_data",I);if(!(C!=null&&C.isCompound()))return!1;const M=C.getList("flags").getNumber(x);return M!==void 0&&M!==0};default:throw new Error(`Invalid condition property ${d}`)}}}n.Condition=s;class a{constructor(h,d,f){this.property=h,this.cases=d,this.fallback=f}getMesh(h,d,f){var v,m,p;const w=this.property(h,d,f);return(p=(m=(v=w!==null?this.cases.get(w):void 0)!=null?v:this.fallback)==null?void 0:m.getMesh(h,d,f))!=null?p:Xs}static propertyFromJson(h){var f,w,v;const d=(f=u.Json.readString(h.property))==null?void 0:f.replace(/^minecraft:/,"");switch(d){case"main_hand":return(E,y,x)=>{var A;return(A=x.main_hand)!=null?A:"right"};case"display_context":return(E,y,x)=>{var A;return(A=x.display_context)!=null?A:"gui"};case"context_dimension":return(E,y,x)=>{var A,I;return(I=(A=x.context_dimension)==null?void 0:A.toString())!=null?I:null};case"charge_type":const m=B.create("firework_rocket");return(E,y,x)=>{const A=E.getComponent("charged_projectiles",y);return!(A!=null&&A.isList())||A.length===0?"none":A.filter(I=>I.isCompound()?B.parse(I.getString("id")).equals(m):!1).length>0?"rocket":"arrow"};case"trim_material":return(E,y,x)=>{const A=E.getComponent("trim",y);return A!=null&&A.isCompound()?B.parse(A.getString("material")).toString():null};case"block_state":const p=(w=u.Json.readString(h.block_state_property))!=null?w:"";return(E,y,x)=>{const A=E.getComponent("block_state",y);return A!=null&&A.isCompound()?A.getString(p):null};case"local_time":return(E,y,x)=>"NOT IMPLEMENTED";case"context_entity_type":return(E,y,x)=>{var A,I;return(I=(A=x.context_entity_type)==null?void 0:A.toString())!=null?I:null};case"custom_model_data":const S=(v=u.Json.readInt(h.index))!=null?v:0;return(E,y,x)=>{const A=E.getComponent("custom_model_data",y);if(!(A!=null&&A.isCompound()))return null;const I=A.getList("strings");return I.length<=S?null:I.getString(S)};default:throw new Error(`Invalid select property ${d}`)}}}n.Select=a;class o{constructor(h,d,f,w){_(this,"entries");this.property=h,this.scale=d,this.fallback=w,this.entries=f.sort((v,m)=>v.threshold-m.threshold)}getMesh(h,d,f){var m;const w=this.property(h,d,f)*this.scale;let v=this.fallback;for(const p of this.entries)if(p.threshold<=w)v=p.model;else break;return(m=v==null?void 0:v.getMesh(h,d,f))!=null?m:Xs}static propertyFromJson(h){var f,w,v,m,p,S,E;const d=(f=u.Json.readString(h.property))==null?void 0:f.replace(/^minecraft:/,"");switch(d){case"bundle/fullness":let y=function(C,M){const N=C.getComponent("bundle_contents",M);return N!=null&&N.isListOrArray()?N.map(F=>F.isCompound()?qt.fromNbt(F):void 0).reduce((F,U)=>{var G,H;if(U===void 0)return F;if(U.hasComponent("bundle_contents",M))return F+y(U,M)+.0625;const T=U.getComponent("bees",M);if((T==null?void 0:T.isListOrArray())&&T.length>0)return F+1;const O=(H=(G=U.getComponent("max_stack_size",M))==null?void 0:G.getAsNumber())!=null?H:1;return F+U.count/O},0):0};return(C,M,N)=>y(C,M);case"damage":{const C=(w=u.Json.readBoolean(h.normalize))!=null?w:!0;return(M,N,L)=>{var T,O,G,H;const F=(O=(T=M.getComponent("max_damage",N))==null?void 0:T.getAsNumber())!=null?O:0,U=yt((H=(G=M.getComponent("damage",N))==null?void 0:G.getAsNumber())!=null?H:0,0,F);return C?yt(U/F,0,1):yt(U,0,F)}}case"count":{const C=(v=u.Json.readBoolean(h.normalize))!=null?v:!0;return(M,N,L)=>{var U,T;const F=(T=(U=M.getComponent("max_stack_size",N))==null?void 0:U.getAsNumber())!=null?T:1;return C?yt(M.count/F,0,1):yt(M.count,0,F)}}case"cooldown":return(C,M,N)=>{var U,T,O;const L=C.getComponent("use_cooldown",M),F=L!=null&&L.isCompound()?B.parse((U=L.getString("cooldown_group"))!=null?U:C.id):C.id;return(O=(T=N.cooldown_percentage)==null?void 0:T[F.toString()])!=null?O:0};case"time":switch((m=u.Json.readString(h.source))!=null?m:"daytime"){case"moon_phase":return(C,M,N)=>{var L;return((L=N.game_time)!=null?L:0)/24e3%8/8};case"random":return(C,M,N)=>Math.random();default:return(C,M,N)=>{var T;const F=((T=N.game_time)!=null?T:0)/24e3%1-.25,U=.5-Math.cos(F*Math.PI)/2;return(F*2+U)/3}}case"compass":return(C,M,N)=>{var L;return(L=N.compass_angle)!=null?L:0};case"crossbow/pull":return(C,M,N)=>{var L;return(L=N["crossbow/pull"])!=null?L:0};case"use_duration":const A=(p=u.Json.readBoolean(h.remaining))!=null?p:!0;return(C,M,N)=>{var L;return N.use_duration===void 0||N.use_duration<0?0:A?Math.max(((L=N.max_use_duration)!=null?L:0)-N.use_duration,0):N.use_duration};case"use_cycle":const I=(S=u.Json.readNumber(h.period))!=null?S:1;return(C,M,N)=>{var L,F;return N.use_duration===void 0||N.use_duration<0?0:Math.max(((L=N.max_use_duration)!=null?L:0)-((F=N.use_duration)!=null?F:0),0)%I};case"custom_model_data":const R=(E=u.Json.readInt(h.index))!=null?E:0;return(C,M,N)=>{const L=C.getComponent("custom_model_data",M);return L!=null&&L.isCompound()?L.getList("floats").getNumber(R):0};default:throw new Error(`Invalid select property ${d}`)}}}n.RangeDispatch=o;class g{constructor(h,d){this.specialModel=h,this.base=d}getMesh(h,d,f){var m;const w=this.specialModel.getMesh(h,d),v=d.getBlockModel(this.base);if(!v)throw new Error(`Base model ${this.base} does not exist (trying to render ${h.toString()})`);return w.transform(v.getDisplayTransform((m=f.display_context)!=null?m:"gui")),w}}n.Special=g;class c{getMesh(h,d,f){const w=f["bundle/selected_item"];if(w===void 0||w<0)return new it;const v=h.getComponent("bundle_contents",d);if(!(v!=null&&v.isListOrArray()))return new it;const m=v.get(w);if(m===void 0||!m.isCompound())return new it;const p=qt.fromNbt(m);return fr.getItemMesh(p,d,{...f,"bundle/selected_item":-1,selected:!1,carried:!1,use_duration:-1})}}n.BundleSelectedItem=c})(u.ItemModel||(u.ItemModel={}));const _u=`
  attribute vec4 vertPos;
  attribute vec3 blockPos;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = blockPos / 256.0;
  }
`,bu=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`,yu=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,Su=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class Eu extends hr{constructor(e,r,i,s){var o,g;super(e);_(this,"gridShaderProgram");_(this,"colorShaderProgram");_(this,"gridMesh",new it);_(this,"outlineMesh",new it);_(this,"invisibleBlocksMesh",new it);_(this,"atlasTexture");_(this,"useInvisibleBlocks");_(this,"chunkBuilder");this.structure=r,this.resources=i;const a=(o=s==null?void 0:s.chunkSize)!=null?o:16;this.chunkBuilder=new Ws(e,r,i,a),s!=null&&s.facesPerBuffer&&console.warn("[deepslate renderer warning]: facesPerBuffer option has been removed in favor of chunkSize"),this.useInvisibleBlocks=(g=s==null?void 0:s.useInvisibleBlockBuffer)!=null?g:!0,this.gridShaderProgram=new Nn(e,yu,Su).getProgram(),this.colorShaderProgram=new Nn(e,_u,bu).getProgram(),this.gridMesh=this.getGridMesh(),this.outlineMesh=this.getOutlineMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh(),this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setStructure(e){this.structure=e,this.chunkBuilder.setStructure(e),this.gridMesh=this.getGridMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh()}updateStructureBuffers(e){this.chunkBuilder.updateStructureBuffers(e)}getGridMesh(){const[e,r,i]=this.structure.getSize(),s=new it;s.addLine(0,0,0,e,0,0,[1,0,0]),s.addLine(0,0,0,0,0,i,[0,0,1]);const a=[.8,.8,.8];s.addLine(0,0,0,0,r,0,a),s.addLine(e,0,0,e,r,0,a),s.addLine(0,0,i,0,r,i,a),s.addLine(e,0,i,e,r,i,a),s.addLine(0,r,0,0,r,i,a),s.addLine(e,r,0,e,r,i,a),s.addLine(0,r,0,e,r,0,a),s.addLine(0,r,i,e,r,i,a);for(let o=1;o<=e;o+=1)s.addLine(o,0,0,o,0,i,a);for(let o=1;o<=i;o+=1)s.addLine(0,0,o,e,0,o,a);return s.rebuild(this.gl,{pos:!0,color:!0})}getOutlineMesh(){return new it().addLineCube(0,0,0,1,1,1,[1,1,1]).rebuild(this.gl,{pos:!0,color:!0})}getInvisibleBlocksMesh(){const e=new it;if(!this.useInvisibleBlocks)return e;const r=this.structure.getSize();for(let i=0;i<r[0];i+=1)for(let s=0;s<r[1];s+=1)for(let a=0;a<r[2];a+=1){const o=this.structure.getBlock([i,s,a]);o!==void 0&&(o===null?e.addLineCube(i+.4375,s+.4375,a+.4375,i+.5625,s+.5625,a+.5625,[1,.25,.25]):o.state.is(X.AIR)?e.addLineCube(i+.375,s+.375,a+.375,i+.625,s+.625,a+.625,[.5,.5,1]):o.state.is(new X("cave_air"))&&e.addLineCube(i+.375,s+.375,a+.375,i+.625,s+.625,a+.625,[.5,1,.5]))}return e.rebuild(this.gl,{pos:!0,color:!0})}drawGrid(e){this.setShader(this.gridShaderProgram),this.prepareDraw(e),this.drawMesh(this.gridMesh,{pos:!0,color:!0})}drawInvisibleBlocks(e){!this.useInvisibleBlocks||(this.setShader(this.gridShaderProgram),this.prepareDraw(e),this.drawMesh(this.invisibleBlocksMesh,{pos:!0,color:!0}))}drawStructure(e){this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture),this.prepareDraw(e),this.chunkBuilder.getMeshes().forEach(r=>{this.drawMesh(r,{pos:!0,color:!0,texture:!0,normal:!0})})}drawColoredStructure(e){this.setShader(this.colorShaderProgram),this.prepareDraw(e),this.chunkBuilder.getMeshes().forEach(r=>{this.drawMesh(r,{pos:!0,color:!0,normal:!0,blockPos:!0})})}drawOutline(e,r){this.setShader(this.gridShaderProgram);const i=nt();Al(i,e),W(i,i,r),this.prepareDraw(i),this.drawMesh(this.outlineMesh,{pos:!0,color:!0})}}class Bn{constructor(t,e){_(this,"part");if(this.img=t,this.idMap=e,!Xr(t.width)||!Xr(t.height))throw new Error(`Expected texture atlas dimensions to be powers of two, got ${t.width}x${t.height}.`);this.part=16/t.width}getTextureAtlas(){return this.img}getTextureUV(t){var e;return(e=this.idMap[t.toString()])!=null?e:[0,0,this.part,this.part]}static async fromBlobs(t){const e=Math.sqrt(Object.keys(t).length+1),r=Fs(e),i=r*16,s=1/r,a=document.createElement("canvas");a.width=i,a.height=i;const o=a.getContext("2d");this.drawInvalidTexture(o);const g={};let c=1;return await Promise.all(Object.keys(t).map(async l=>{const h=c%r,d=Math.floor(c/r);c+=1,g[l]=[s*h,s*d,s*h+s,s*d+s];const f=await createImageBitmap(t[l]);o.drawImage(f,0,0,16,16,16*h,16*d,16,16)})),new Bn(o.getImageData(0,0,i,i),g)}static empty(){const t=document.createElement("canvas");t.width=16,t.height=16;const e=t.getContext("2d");return Bn.drawInvalidTexture(e),new Bn(e.getImageData(0,0,16,16),{})}static drawInvalidTexture(t){t.fillStyle="black",t.fillRect(0,0,16,16),t.fillStyle="magenta",t.fillRect(0,0,8,8),t.fillRect(8,8,8,8)}}const Iu=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,ku=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class Au extends hr{constructor(e){super(e);_(this,"voxelShaderProgram");_(this,"voxels",[]);_(this,"quads",[]);_(this,"meshes",[]);this.voxelShaderProgram=new Nn(e,Iu,ku).getProgram()}setVoxels(e){this.voxels=e,this.quads=this.getQuads(),this.meshes=this.getMeshes()}getQuads(){var i,s,a,o,g,c,l,h,d,f,w,v;const e=new Map;for(const m of this.voxels)vr(e,m.x,new Map,p=>{vr(p,m.y,new Set,S=>{S.add(m.z)})});const r=[];for(const m of this.voxels)(s=(i=e.get(m.x+1))==null?void 0:i.get(m.y))!=null&&s.has(m.z)||r.push(Xt.fromPoints(new Y(m.x+1,m.y,m.z),new Y(m.x+1,m.y+1,m.z),new Y(m.x+1,m.y+1,m.z+1),new Y(m.x+1,m.y,m.z+1)).setColor(m.color)),(o=(a=e.get(m.x-1))==null?void 0:a.get(m.y))!=null&&o.has(m.z)||r.push(Xt.fromPoints(new Y(m.x,m.y,m.z+1),new Y(m.x,m.y+1,m.z+1),new Y(m.x,m.y+1,m.z),new Y(m.x,m.y,m.z)).setColor(m.color)),(c=(g=e.get(m.x))==null?void 0:g.get(m.y+1))!=null&&c.has(m.z)||r.push(Xt.fromPoints(new Y(m.x,m.y+1,m.z+1),new Y(m.x+1,m.y+1,m.z+1),new Y(m.x+1,m.y+1,m.z),new Y(m.x,m.y+1,m.z)).setColor(m.color)),(h=(l=e.get(m.x))==null?void 0:l.get(m.y-1))!=null&&h.has(m.z)||r.push(Xt.fromPoints(new Y(m.x,m.y,m.z),new Y(m.x+1,m.y,m.z),new Y(m.x+1,m.y,m.z+1),new Y(m.x,m.y,m.z+1)).setColor(m.color)),(f=(d=e.get(m.x))==null?void 0:d.get(m.y))!=null&&f.has(m.z+1)||r.push(Xt.fromPoints(new Y(m.x,m.y,m.z+1),new Y(m.x+1,m.y,m.z+1),new Y(m.x+1,m.y+1,m.z+1),new Y(m.x,m.y+1,m.z+1)).setColor(m.color)),(v=(w=e.get(m.x))==null?void 0:w.get(m.y))!=null&&v.has(m.z-1)||r.push(Xt.fromPoints(new Y(m.x,m.y+1,m.z),new Y(m.x+1,m.y+1,m.z),new Y(m.x+1,m.y,m.z),new Y(m.x,m.y,m.z)).setColor(m.color));return console.debug(`Converted ${this.voxels.length} voxels into ${r.length} quads!`),r}getMeshes(){const e=[];let r=new it;for(const i of this.quads){const s=i.normal(),a=(s.y*.25+Math.abs(s.z)*.125+.75)/256;i.forEach(o=>o.color=[o.color[0]*a,o.color[1]*a,o.color[2]*a]),r.quads.push(i),r.quadVertices()>65e3&&(e.push(r),r=new it)}r.isEmpty()||e.push(r);for(const i of e)i.rebuild(this.gl,{pos:!0,color:!0});return e}draw(e){if(console.debug(`Drawing ${this.meshes.length} meshes...`),this.setShader(this.voxelShaderProgram),this.prepareDraw(e),this.meshes.length===0){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);return}for(const r of this.meshes)this.drawMesh(r,{pos:!0,color:!0})}}u.NoiseRouter=void 0,(n=>{const t=o=>new q.HolderHolder(u.Holder.parser(u.WorldgenRegistries.DENSITY_FUNCTION,q.fromJson)(o));function e(o){var c;const g=(c=u.Json.readObject(o))!=null?c:{};return{barrier:t(g.barrier),fluidLevelFloodedness:t(g.fluid_level_floodedness),fluidLevelSpread:t(g.fluid_level_spread),lava:t(g.lava),temperature:t(g.temperature),vegetation:t(g.vegetation),continents:t(g.continents),erosion:t(g.erosion),depth:t(g.depth),ridges:t(g.ridges),initialDensityWithoutJaggedness:t(g.initial_density_without_jaggedness),finalDensity:t(g.final_density),veinToggle:t(g.vein_toggle),veinRidged:t(g.vein_ridged),veinGap:t(g.vein_gap)}}n.fromJson=e;function r(o){return{barrier:q.Constant.ZERO,fluidLevelFloodedness:q.Constant.ZERO,fluidLevelSpread:q.Constant.ZERO,lava:q.Constant.ZERO,temperature:q.Constant.ZERO,vegetation:q.Constant.ZERO,continents:q.Constant.ZERO,erosion:q.Constant.ZERO,depth:q.Constant.ZERO,ridges:q.Constant.ZERO,initialDensityWithoutJaggedness:q.Constant.ZERO,finalDensity:q.Constant.ZERO,veinToggle:q.Constant.ZERO,veinRidged:q.Constant.ZERO,veinGap:q.Constant.ZERO,...o}}n.create=r;function i(o,g){return{barrier:o.barrier.mapAll(g),fluidLevelFloodedness:o.fluidLevelFloodedness.mapAll(g),fluidLevelSpread:o.fluidLevelSpread.mapAll(g),lava:o.lava.mapAll(g),temperature:o.temperature.mapAll(g),vegetation:o.vegetation.mapAll(g),continents:o.continents.mapAll(g),erosion:o.erosion.mapAll(g),depth:o.depth.mapAll(g),ridges:o.ridges.mapAll(g),initialDensityWithoutJaggedness:o.initialDensityWithoutJaggedness.mapAll(g),finalDensity:o.finalDensity.mapAll(g),veinToggle:o.veinToggle.mapAll(g),veinRidged:o.veinRidged.mapAll(g),veinGap:o.veinGap.mapAll(g)}}n.mapAll=i;const s=new Map;function a(o,g){var f;const c=(f=g.key())==null?void 0:f.toString();if(!c)throw new Error("Cannot instantiate noise from direct holder");const l=o.seedKey(),h=s.get(c);if(h&&h[0]===l[0]&&h[1]===l[1])return h[2];const d=new ae(o.fromHashOf(c),g.value());return s.set(c,[l[0],l[1],d]),d}n.instantiate=a})(u.NoiseRouter||(u.NoiseRouter={})),u.NoiseSettings=void 0,(n=>{function t(o){var c,l,h,d,f;const g=(c=u.Json.readObject(o))!=null?c:{};return{minY:(l=u.Json.readInt(g.min_y))!=null?l:0,height:(h=u.Json.readInt(g.height))!=null?h:256,xzSize:(d=u.Json.readInt(g.size_horizontal))!=null?d:1,ySize:(f=u.Json.readInt(g.size_vertical))!=null?f:1}}n.fromJson=t;function e(o){return{minY:0,height:256,xzSize:1,ySize:1,...o}}n.create=e;function r(o){return o.ySize<<2}n.cellHeight=r;function i(o){return o.xzSize<<2}n.cellWidth=i;function s(o){return o.height/r(o)}n.cellCountY=s;function a(o){return Math.floor(o.minY/r(o))}n.minCellY=a})(u.NoiseSettings||(u.NoiseSettings={})),u.NoiseSlideSettings=void 0,(n=>{function t(r){var s,a,o,g;const i=(s=u.Json.readObject(r))!=null?s:{};return{target:(a=u.Json.readNumber(i.target))!=null?a:0,size:(o=u.Json.readInt(i.size))!=null?o:0,offset:(g=u.Json.readInt(i.offset))!=null?g:0}}n.fromJson=t;function e(r,i,s){if(r.size<=0)return i;const a=(s-r.offset)/r.size;return er(r.target,i,a)}n.apply=e})(u.NoiseSlideSettings||(u.NoiseSlideSettings={})),u.VerticalAnchor=void 0,(n=>{function t(s){var o,g,c,l;const a=(o=u.Json.readObject(s))!=null?o:{};return a.absolute!==void 0?e((g=u.Json.readNumber(a.absolute))!=null?g:0):a.above_bottom!==void 0?r((c=u.Json.readNumber(a.above_bottom))!=null?c:0):a.below_top!==void 0?i((l=u.Json.readNumber(a.below_top))!=null?l:0):()=>0}n.fromJson=t;function e(s){return()=>s}n.absolute=e;function r(s){return a=>a.minY+s}n.aboveBottom=r;function i(s){return a=>a.minY+a.height-1-s}n.belowTop=i})(u.VerticalAnchor||(u.VerticalAnchor={}));class js{constructor(t,e,r){_(this,"surfaceNoise");_(this,"surfaceSecondaryNoise");_(this,"random");_(this,"positionalRandoms");this.rule=t,this.defaultBlock=e,this.random=rt.create(r).forkPositional(),this.surfaceNoise=u.NoiseRouter.instantiate(this.random,u.WorldgenRegistries.SURFACE_NOISE),this.surfaceSecondaryNoise=u.NoiseRouter.instantiate(this.random,u.WorldgenRegistries.SURFACE_SECONDARY_NOISE),this.positionalRandoms=new Map}buildSurface(t,e,r,i){const s=u.ChunkPos.minBlockX(t.pos),a=u.ChunkPos.minBlockZ(t.pos),o=new Ks(this,t,e,r,i),g=this.rule(o);for(let c=0;c<16;c+=1){const l=s+c;for(let h=0;h<1;h+=1){const d=a+h;o.updateXZ(l,d);let f=0,w=Number.MIN_SAFE_INTEGER,v=Number.MAX_SAFE_INTEGER;for(let m=t.maxY;m>=t.minY;m-=1){const p=u.BlockPos.create(l,m,d),S=t.getBlockState(p);if(S.equals(X.AIR)){f=0,w=Number.MIN_SAFE_INTEGER;continue}if(S.isFluid()){w===Number.MIN_SAFE_INTEGER&&(w=m+1);continue}if(v>=m){v=Number.MIN_SAFE_INTEGER;for(let x=m-1;x>=t.minY;x-=1){const A=t.getBlockState(u.BlockPos.create(l,x,d));if(A.equals(X.AIR)||A.isFluid()){v=x+1;break}}}f+=1;const E=m-v+1;if(!S.equals(this.defaultBlock))continue;o.updateY(f,E,w,m);const y=g(l,m,d);y&&t.setBlockState(p,y)}}}}getSurfaceDepth(t,e){const r=this.surfaceNoise.sample(t,0,e),i=this.random.at(t,0,e).nextDouble()*.25;return r*2.75+3+i}getSurfaceSecondary(t,e){return this.surfaceSecondaryNoise.sample(t,0,e)}getRandom(t){return Ie(this.positionalRandoms,t,()=>this.random.fromHashOf(t))}}class Ks{constructor(t,e,r,i,s){_(this,"blockX",0);_(this,"blockY",0);_(this,"blockZ",0);_(this,"stoneDepthAbove",0);_(this,"stoneDepthBelow",0);_(this,"surfaceDepth",0);_(this,"waterHeight",0);_(this,"biome",()=>"");_(this,"surfaceSecondary",()=>0);_(this,"minSurfaceLevel",()=>0);this.system=t,this.chunk=e,this.noiseChunk=r,this.context=i,this.getBiome=s}updateXZ(t,e){this.blockX=t,this.blockZ=e,this.surfaceDepth=this.system.getSurfaceDepth(t,e),this.surfaceSecondary=an(()=>this.system.getSurfaceSecondary(t,e)),this.minSurfaceLevel=an(()=>this.calculateMinSurfaceLevel(t,e))}updateY(t,e,r,i){this.blockY=i,this.stoneDepthAbove=t,this.stoneDepthBelow=e,this.waterHeight=r,this.biome=an(()=>this.getBiome(u.BlockPos.create(this.blockX,this.blockY,this.blockZ)))}calculateMinSurfaceLevel(t,e){const r=t>>4,i=e>>4,s=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,i<<4),a=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,i<<4),o=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,i+1<<4),g=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,i+1<<4);return Math.floor(tr((t&15)/16,(e&15)/16,s,a,o,g))+this.surfaceDepth-8}}u.SurfaceRule=void 0,(n=>{n.NOOP=()=>()=>{};function t(s){var g,c,l;const a=(g=u.Json.readObject(s))!=null?g:{};switch((c=u.Json.readString(a.type))==null?void 0:c.replace(/^minecraft:/,"")){case"block":return e(X.fromJson(a.result_state));case"sequence":return r((l=u.Json.readArray(a.sequence,n.fromJson))!=null?l:[]);case"condition":return i(u.SurfaceCondition.fromJson(a.if_true),n.fromJson(a.then_run))}return n.NOOP}n.fromJson=t;function e(s){return()=>()=>s}n.block=e;function r(s){return a=>{const o=s.map(g=>g(a));return(g,c,l)=>{for(const h of o){const d=h(g,c,l);if(d)return d}}}}n.sequence=r;function i(s,a){return o=>(g,c,l)=>{if(s(o))return a(o)(g,c,l)}}n.condition=i})(u.SurfaceRule||(u.SurfaceRule={})),u.SurfaceCondition=void 0,(n=>{n.FALSE=()=>!1,n.TRUE=()=>!0;function t(c){var d,f,w,v,m,p,S,E,y,x,A,I;const l=(d=u.Json.readObject(c))!=null?d:{};switch((f=u.Json.readString(l.type))==null?void 0:f.replace(/^minecraft:/,"")){case"above_preliminary_surface":return e();case"biome":return r((w=u.Json.readArray(l.biome_is,R=>{var C;return(C=u.Json.readString(R))!=null?C:""}))!=null?w:[]);case"not":return i(n.fromJson(l.invert));case"stone_depth":return s((v=u.Json.readInt(l.offset))!=null?v:0,(m=u.Json.readBoolean(l.add_surface_depth))!=null?m:!1,(p=u.Json.readInt(l.secondary_depth_range))!=null?p:0,u.Json.readString(l.surface_type)==="ceiling");case"vertical_gradient":return a((S=u.Json.readString(l.random_name))!=null?S:"",u.VerticalAnchor.fromJson(l.true_at_and_below),u.VerticalAnchor.fromJson(l.false_at_and_above));case"water":return o((E=u.Json.readInt(l.offset))!=null?E:0,(y=u.Json.readInt(l.surface_depth_multiplier))!=null?y:0,(x=u.Json.readBoolean(l.add_surface_depth))!=null?x:!1);case"y_above":return g(u.VerticalAnchor.fromJson(l.anchor),(A=u.Json.readInt(l.surface_depth_multiplier))!=null?A:0,(I=u.Json.readBoolean(l.add_surface_depth))!=null?I:!1)}return n.FALSE}n.fromJson=t;function e(){return c=>c.blockY>=c.minSurfaceLevel()}n.abovePreliminarySurface=e;function r(c){const l=new Set(c);return h=>l.has(h.biome())}n.biome=r;function i(c){return l=>!c(l)}n.not=i;function s(c,l,h,d){return f=>{const w=d?f.stoneDepthBelow:f.stoneDepthAbove,v=l?f.surfaceDepth:0,m=h===0?0:Rn(f.surfaceSecondary(),-1,1,0,h);return w<=1+c+v+m}}n.stoneDepth=s;function a(c,l,h){return d=>{const f=l(d.context),w=h(d.context);if(d.blockY<=f)return!0;if(d.blockY>=w)return!1;const v=d.system.getRandom(c),m=Rn(d.blockY,f,w,1,0);return v.nextFloat()<m}}n.verticalGradient=a;function o(c,l,h){return d=>{if(d.waterHeight===Number.MIN_SAFE_INTEGER)return!0;const f=h?d.stoneDepthAbove:0;return d.blockY+f>=d.waterHeight+c+d.surfaceDepth*l}}n.water=o;function g(c,l,h){return d=>{const f=h?d.stoneDepthAbove:0;return d.blockY+f>=c(d.context)+d.surfaceDepth*l}}n.yAbove=g})(u.SurfaceCondition||(u.SurfaceCondition={})),u.NoiseGeneratorSettings=void 0,(n=>{function t(r){var s,a,o,g,c,l;const i=(s=u.Json.readObject(r))!=null?s:{};return{surfaceRule:u.SurfaceRule.fromJson(i.surface_rule),noise:u.NoiseSettings.fromJson(i.noise),defaultBlock:X.fromJson(i.default_block),defaultFluid:X.fromJson(i.default_fluid),noiseRouter:u.NoiseRouter.fromJson(i.noise_router),seaLevel:(a=u.Json.readInt(i.sea_level))!=null?a:0,disableMobGeneration:(o=u.Json.readBoolean(i.disable_mob_generation))!=null?o:!1,aquifersEnabled:(g=u.Json.readBoolean(i.aquifers_enabled))!=null?g:!1,oreVeinsEnabled:(c=u.Json.readBoolean(i.ore_veins_enabled))!=null?c:!1,legacyRandomSource:(l=u.Json.readBoolean(i.legacy_random_source))!=null?l:!1}}n.fromJson=t;function e(r){return{surfaceRule:u.SurfaceRule.NOOP,noise:u.NoiseSettings.create({}),defaultBlock:X.STONE,defaultFluid:X.WATER,noiseRouter:u.NoiseRouter.create({}),seaLevel:0,disableMobGeneration:!1,aquifersEnabled:!1,oreVeinsEnabled:!1,legacyRandomSource:!1,...r}}n.create=e})(u.NoiseGeneratorSettings||(u.NoiseGeneratorSettings={})),u.WorldgenRegistries=void 0,(n=>{n.NOISE=Ct.createAndRegister("worldgen/noise",u.NoiseParameters.fromJson),n.DENSITY_FUNCTION=Ct.createAndRegister("worldgen/density_function",e=>q.fromJson(e)),n.NOISE_SETTINGS=Ct.createAndRegister("worldgen/noise_settings",u.NoiseGeneratorSettings.fromJson),n.BIOME=Ct.createAndRegister("worldgen/biome"),n.SURFACE_NOISE=t("surface",-6,[1,1,1]),n.SURFACE_SECONDARY_NOISE=t("surface_secondary",-6,[1,1,0,1]);function t(e,r,i){return n.NOISE.register(B.create(e),u.NoiseParameters.create(r,i),!0)}})(u.WorldgenRegistries||(u.WorldgenRegistries={}));class q{minValue(){return-this.maxValue()}mapAll(t){return t.map(this)}}(n=>{function t(j,k,b){return{x:j,y:k,z:b}}n.context=t;class e extends n{constructor(k){super(),this.input=k}compute(k){return this.transform(k,this.input.compute(k))}}const r=u.Holder.parser(u.WorldgenRegistries.NOISE,u.NoiseParameters.fromJson);function i(j,k=i){var z,Z,K,At,Mt,Et,ut,ht,lt,V,J,ot,On,Jn,oi,ci,li,ea,na,ra;if(typeof j=="string")return new a(u.Holder.reference(u.WorldgenRegistries.DENSITY_FUNCTION,B.parse(j)));if(typeof j=="number")return new s(j);const b=(z=u.Json.readObject(j))!=null?z:{},P=(Z=u.Json.readString(b.type))==null?void 0:Z.replace(/^minecraft:/,"");switch(P){case"blend_alpha":return new o(1,0,1);case"blend_offset":return new o(0,-1/0,1/0);case"beardifier":return new o(0,-1/0,1/0);case"old_blended_noise":return new g((K=u.Json.readNumber(b.xz_scale))!=null?K:1,(At=u.Json.readNumber(b.y_scale))!=null?At:1,(Mt=u.Json.readNumber(b.xz_factor))!=null?Mt:80,(Et=u.Json.readNumber(b.y_factor))!=null?Et:160,(ut=u.Json.readNumber(b.smear_scale_multiplier))!=null?ut:8);case"flat_cache":return new l(k(b.argument));case"interpolated":return new w(k(b.argument));case"cache_2d":return new d(k(b.argument));case"cache_once":return new f(k(b.argument));case"cache_all_in_cell":return new h(k(b.argument));case"noise":return new v((ht=u.Json.readNumber(b.xz_scale))!=null?ht:1,(lt=u.Json.readNumber(b.y_scale))!=null?lt:1,r(b.noise));case"end_islands":return new m;case"weird_scaled_sampler":return new S(k(b.input),u.Json.readEnum(b.rarity_value_mapper,p),r(b.noise));case"shifted_noise":return new E(k(b.shift_x),k(b.shift_y),k(b.shift_z),(V=u.Json.readNumber(b.xz_scale))!=null?V:1,(J=u.Json.readNumber(b.y_scale))!=null?J:1,r(b.noise));case"range_choice":return new y(k(b.input),(ot=u.Json.readNumber(b.min_inclusive))!=null?ot:0,(On=u.Json.readNumber(b.max_exclusive))!=null?On:1,k(b.when_in_range),k(b.when_out_of_range));case"shift_a":return new A(r(b.argument));case"shift_b":return new I(r(b.argument));case"shift":return new R(r(b.argument));case"blend_density":return new C(k(b.argument));case"clamp":return new M(k(b.input),(Jn=u.Json.readNumber(b.min))!=null?Jn:0,(oi=u.Json.readNumber(b.max))!=null?oi:1);case"abs":case"square":case"cube":case"half_negative":case"quarter_negative":case"squeeze":return new N(P,k(b.argument));case"add":case"mul":case"min":case"max":return new F(u.Json.readEnum(P,L),k(b.argument1),k(b.argument2));case"spline":return new U(u.CubicSpline.fromJson(b.spline,k));case"constant":return new s((ci=u.Json.readNumber(b.argument))!=null?ci:0);case"y_clamped_gradient":return new T((li=u.Json.readInt(b.from_y))!=null?li:-4064,(ea=u.Json.readInt(b.to_y))!=null?ea:4062,(na=u.Json.readNumber(b.from_value))!=null?na:-4064,(ra=u.Json.readNumber(b.to_value))!=null?ra:4062)}return s.ZERO}n.fromJson=i;const O=class extends n{constructor(k){super(),this.value=k}compute(){return this.value}minValue(){return this.value}maxValue(){return this.value}};let s=O;_(s,"ZERO",new O(0)),_(s,"ONE",new O(1)),n.Constant=s;class a extends n{constructor(k){super(),this.holder=k}compute(k){return this.holder.value().compute(k)}minValue(){return this.holder.value().minValue()}maxValue(){return this.holder.value().maxValue()}}n.HolderHolder=a;class o extends n.Constant{constructor(k,b,P){super(k),this.min=b,this.max=P}minValue(){return this.min}maxValue(){return this.max}}n.ConstantMinMax=o;class g extends n{constructor(k,b,P,z,Z,K){super(),this.xzScale=k,this.yScale=b,this.xzFactor=P,this.yFactor=z,this.smearScaleMultiplier=Z,this.blendedNoise=K}compute(k){var b,P;return(P=(b=this.blendedNoise)==null?void 0:b.sample(k.x,k.y,k.z))!=null?P:0}maxValue(){var k,b;return(b=(k=this.blendedNoise)==null?void 0:k.maxValue)!=null?b:0}}n.OldBlendedNoise=g;class c extends n{constructor(k){super(),this.wrapped=k}minValue(){return this.wrapped.minValue()}maxValue(){return this.wrapped.maxValue()}}class l extends c{constructor(b){super(b);_(this,"lastQuartX");_(this,"lastQuartZ");_(this,"lastValue",0)}compute(b){const P=b.x>>2,z=b.z>>2;return(this.lastQuartX!==P||this.lastQuartZ!==z)&&(this.lastValue=this.wrapped.compute(n.context(P<<2,0,z<<2)),this.lastQuartX=P,this.lastQuartZ=z),this.lastValue}mapAll(b){return b.map(new l(this.wrapped.mapAll(b)))}}n.FlatCache=l;class h extends c{constructor(k){super(k)}compute(k){return this.wrapped.compute(k)}mapAll(k){return k.map(new h(this.wrapped.mapAll(k)))}}n.CacheAllInCell=h;class d extends c{constructor(b){super(b);_(this,"lastBlockX");_(this,"lastBlockZ");_(this,"lastValue",0)}compute(b){const P=b.x,z=b.z;return(this.lastBlockX!==P||this.lastBlockZ!==z)&&(this.lastValue=this.wrapped.compute(b),this.lastBlockX=P,this.lastBlockZ=z),this.lastValue}mapAll(b){return b.map(new d(this.wrapped.mapAll(b)))}}n.Cache2D=d;class f extends c{constructor(b){super(b);_(this,"lastBlockX");_(this,"lastBlockY");_(this,"lastBlockZ");_(this,"lastValue",0)}compute(b){const P=b.x,z=b.y,Z=b.z;return(this.lastBlockX!==P||this.lastBlockY!==z||this.lastBlockZ!==Z)&&(this.lastValue=this.wrapped.compute(b),this.lastBlockX=P,this.lastBlockY=z,this.lastBlockZ=Z),this.lastValue}mapAll(b){return b.map(new f(this.wrapped.mapAll(b)))}}n.CacheOnce=f;class w extends c{constructor(b,P=4,z=4){super(b);_(this,"values");this.cellWidth=P,this.cellHeight=z,this.values=new Map}compute({x:b,y:P,z}){const Z=this.cellWidth,K=this.cellHeight,At=(b%Z+Z)%Z/Z,Mt=(P%K+K)%K/K,Et=(z%Z+Z)%Z/Z,ut=Math.floor(b/Z)*Z,ht=Math.floor(P/K)*K,lt=Math.floor(z/Z)*Z;return Js(At,Mt,Et,()=>this.computeCorner(ut,ht,lt),()=>this.computeCorner(ut+Z,ht,lt),()=>this.computeCorner(ut,ht+K,lt),()=>this.computeCorner(ut+Z,ht+K,lt),()=>this.computeCorner(ut,ht,lt+Z),()=>this.computeCorner(ut+Z,ht,lt+Z),()=>this.computeCorner(ut,ht+K,lt+Z),()=>this.computeCorner(ut+Z,ht+K,lt+Z))}computeCorner(b,P,z){return Ie(this.values,`${b} ${P} ${z}`,()=>this.wrapped.compute(n.context(b,P,z)))}mapAll(b){return b.map(new w(this.wrapped.mapAll(b)))}withCellSize(b,P){return new w(this.wrapped,b,P)}}n.Interpolated=w;class v extends n{constructor(k,b,P,z){super(),this.xzScale=k,this.yScale=b,this.noiseData=P,this.noise=z}compute(k){var b,P;return(P=(b=this.noise)==null?void 0:b.sample(k.x*this.xzScale,k.y*this.yScale,k.z*this.xzScale))!=null?P:0}maxValue(){var k,b;return(b=(k=this.noise)==null?void 0:k.maxValue)!=null?b:2}}n.Noise=v;class m extends n{constructor(b){super();_(this,"islandNoise");const P=new at(b!=null?b:BigInt(0));P.consume(17292),this.islandNoise=new pt(P)}getHeightValue(b,P){const z=Math.floor(b/2),Z=Math.floor(P/2),K=b%2,At=P%2;let Mt=yt(100-Math.sqrt(b*b+P*P)*8,-100,80);for(let Et=-12;Et<=12;Et+=1)for(let ut=-12;ut<=12;ut+=1){const ht=z+Et,lt=Z+ut;if(ht*ht+lt*lt<=4096||this.islandNoise.sample2D(ht,lt)>=-.9)continue;const V=(Math.abs(ht)*3439+Math.abs(lt)*147)%13+9,J=K+Et*2,ot=At+ut*2,On=100-Math.sqrt(J*J+ot*ot)*V,Jn=yt(On,-100,80);Mt=Math.max(Mt,Jn)}return Mt}compute({x:b,y:P,z}){return(this.getHeightValue(Math.floor(b/8),Math.floor(z/8))-8)/128}minValue(){return-.84375}maxValue(){return .5625}}n.EndIslands=m;const p=["type_1","type_2"],G=class extends e{constructor(b,P,z,Z){super(b);_(this,"mapper");this.rarityValueMapper=P,this.noiseData=z,this.noise=Z,this.mapper=G.ValueMapper[this.rarityValueMapper]}transform(b,P){if(!this.noise)return 0;const z=this.mapper(P);return z*Math.abs(this.noise.sample(b.x/z,b.y/z,b.z/z))}mapAll(b){return b.map(new G(this.input.mapAll(b),this.rarityValueMapper,this.noiseData,this.noise))}minValue(){return 0}maxValue(){return this.rarityValueMapper==="type_1"?2:3}static rarityValueMapper1(b){return b<-.5?.75:b<0?1:b<.5?1.5:2}static rarityValueMapper2(b){return b<-.75?.5:b<-.5?.75:b<.5?1:b<.75?2:3}};let S=G;_(S,"ValueMapper",{type_1:G.rarityValueMapper1,type_2:G.rarityValueMapper2}),n.WeirdScaledSampler=S;class E extends v{constructor(k,b,P,z,Z,K,At){super(z,Z,K,At),this.shiftX=k,this.shiftY=b,this.shiftZ=P}compute(k){var Z,K;const b=k.x*this.xzScale+this.shiftX.compute(k),P=k.y*this.yScale+this.shiftY.compute(k),z=k.z*this.xzScale+this.shiftZ.compute(k);return(K=(Z=this.noise)==null?void 0:Z.sample(b,P,z))!=null?K:0}mapAll(k){return k.map(new E(this.shiftX.mapAll(k),this.shiftY.mapAll(k),this.shiftZ.mapAll(k),this.xzScale,this.yScale,this.noiseData,this.noise))}}n.ShiftedNoise=E;class y extends n{constructor(k,b,P,z,Z){super(),this.input=k,this.minInclusive=b,this.maxExclusive=P,this.whenInRange=z,this.whenOutOfRange=Z}compute(k){const b=this.input.compute(k);return this.minInclusive<=b&&b<this.maxExclusive?this.whenInRange.compute(k):this.whenOutOfRange.compute(k)}mapAll(k){return k.map(new y(this.input.mapAll(k),this.minInclusive,this.maxExclusive,this.whenInRange.mapAll(k),this.whenOutOfRange.mapAll(k)))}minValue(){return Math.min(this.whenInRange.minValue(),this.whenOutOfRange.minValue())}maxValue(){return Math.max(this.whenInRange.maxValue(),this.whenOutOfRange.maxValue())}}n.RangeChoice=y;class x extends n{constructor(k,b){super(),this.noiseData=k,this.offsetNoise=b}compute(k){var b,P;return((P=(b=this.offsetNoise)==null?void 0:b.sample(k.x*.25,k.y*.25,k.z*.25))!=null?P:0)*4}maxValue(){var k,b;return((b=(k=this.offsetNoise)==null?void 0:k.maxValue)!=null?b:2)*4}}n.ShiftNoise=x;class A extends x{constructor(k,b){super(k,b)}compute(k){return super.compute(n.context(k.x,0,k.z))}withNewNoise(k){return new A(this.noiseData,k)}}n.ShiftA=A;class I extends x{constructor(k,b){super(k,b)}compute(k){return super.compute(n.context(k.z,k.x,0))}withNewNoise(k){return new I(this.noiseData,k)}}n.ShiftB=I;class R extends x{constructor(k,b){super(k,b)}withNewNoise(k){return new R(this.noiseData,k)}}n.Shift=R;class C extends e{constructor(k){super(k)}transform(k,b){return b}mapAll(k){return k.map(new C(this.input.mapAll(k)))}minValue(){return-1/0}maxValue(){return 1/0}}n.BlendDensity=C;class M extends e{constructor(k,b,P){super(k),this.min=b,this.max=P}transform(k,b){return yt(b,this.min,this.max)}mapAll(k){return k.map(new M(this.input.mapAll(k),this.min,this.max))}minValue(){return this.min}maxValue(){return this.max}}n.Clamp=M;const H=class extends e{constructor(b,P,z,Z){super(P);_(this,"transformer");this.type=b,this.min=z,this.max=Z,this.transformer=H.MappedTypes[this.type]}transform(b,P){return this.transformer(P)}mapAll(b){return b.map(new H(this.type,this.input.mapAll(b)))}minValue(){var b;return(b=this.min)!=null?b:-1/0}maxValue(){var b;return(b=this.max)!=null?b:1/0}withMinMax(){const b=this.input.minValue();let P=this.transformer(b),z=this.transformer(this.input.maxValue());return(this.type==="abs"||this.type==="square")&&(z=Math.max(P,z),P=Math.max(0,b)),new H(this.type,this.input,P,z)}};let N=H;_(N,"MappedTypes",{abs:b=>Math.abs(b),square:b=>b*b,cube:b=>b*b*b,half_negative:b=>b>0?b:b*.5,quarter_negative:b=>b>0?b:b*.25,squeeze:b=>{const P=yt(b,-1,1);return P/2-P*P*P/24}}),n.Mapped=N;const L=["add","mul","min","max"];class F extends n{constructor(k,b,P,z,Z){super(),this.type=k,this.argument1=b,this.argument2=P,this.min=z,this.max=Z}compute(k){const b=this.argument1.compute(k);switch(this.type){case"add":return b+this.argument2.compute(k);case"mul":return b===0?0:b*this.argument2.compute(k);case"min":return b<this.argument2.minValue()?b:Math.min(b,this.argument2.compute(k));case"max":return b>this.argument2.maxValue()?b:Math.max(b,this.argument2.compute(k))}}mapAll(k){return k.map(new F(this.type,this.argument1.mapAll(k),this.argument2.mapAll(k)))}minValue(){var k;return(k=this.min)!=null?k:-1/0}maxValue(){var k;return(k=this.max)!=null?k:1/0}withMinMax(){const k=this.argument1.minValue(),b=this.argument2.minValue(),P=this.argument1.maxValue(),z=this.argument2.maxValue();(this.type==="min"||this.type==="max")&&(k>=z||b>=P)&&console.warn(`Creating a ${this.type} function between two non-overlapping inputs`);let Z,K;switch(this.type){case"add":Z=k+b,K=P+z;break;case"mul":Z=k>0&&b>0?k*b||0:P<0&&z<0?P*z||0:Math.min(k*z||0,b*P||0),K=k>0&&b>0?P*z||0:P<0&&z<0?k*b||0:Math.max(k*b||0,P*z||0);break;case"min":Z=Math.min(k,b),K=Math.min(P,z);break;case"max":Z=Math.max(k,b),K=Math.max(P,z);break}return new F(this.type,this.argument1,this.argument2,Z,K)}}n.Ap2=F;class U extends n{constructor(k){super(),this.spline=k}compute(k){return this.spline.compute(k)}mapAll(k){const b=this.spline.mapAll(P=>P instanceof n?P.mapAll(k):P);return b.calculateMinMax(),k.map(new U(b))}minValue(){return this.spline.min()}maxValue(){return this.spline.max()}}n.Spline=U;class T extends n{constructor(k,b,P,z){super(),this.fromY=k,this.toY=b,this.fromValue=P,this.toValue=z}compute(k){return qr(k.y,this.fromY,this.toY,this.fromValue,this.toValue)}minValue(){return Math.min(this.fromValue,this.toValue)}maxValue(){return Math.max(this.fromValue,this.toValue)}}n.YClampedGradient=T})(q||(q={}));class Tn{constructor(t,e){this.level=t,this.type=e}at(t){return t<this.level?this.type:X.AIR}}u.Aquifer=void 0,(n=>{function t(e){return{compute({x:r,y:i,z:s},a){if(!(a>0))return e(r,i,s).at(i)}}}n.createDisabled=t})(u.Aquifer||(u.Aquifer={}));const zt=class{constructor(t,e,r,i,s,a,o){_(this,"minGridX");_(this,"minGridY");_(this,"minGridZ");_(this,"gridSizeX");_(this,"gridSizeZ");_(this,"gridSize");_(this,"aquiferCache");_(this,"aquiferLocationCache");this.noiseChunk=t,this.router=r,this.random=i,this.globalFluidPicker=o,this.minGridX=this.gridX(u.ChunkPos.minBlockX(e))-1,this.gridSizeX=this.gridX(u.ChunkPos.maxBlockX(e))+1-this.minGridX+1,this.minGridY=this.gridY(s)-1,this.minGridZ=this.gridZ(u.ChunkPos.minBlockZ(e))-1,this.gridSizeZ=this.gridZ(u.ChunkPos.maxBlockZ(e))+1-this.minGridZ+1;const g=this.gridY(s+a)+1-this.minGridY+1;this.gridSize=this.gridSizeX*g*this.gridSizeZ,this.aquiferCache=Array(this.gridSize).fill(void 0),this.aquiferLocationCache=Array(this.gridSize).fill(u.BlockPos.ZERO)}compute({x:t,y:e,z:r},i){if(i<=0){if(this.globalFluidPicker(t,e,r).at(e).is(X.LAVA))return X.LAVA;{const s=this.gridX(t-5),a=this.gridY(e+1),o=this.gridZ(r-5);let g=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,h=u.BlockPos.ZERO,d=u.BlockPos.ZERO,f=u.BlockPos.ZERO;for(let x=0;x<=1;x+=1)for(let A=-1;A<=1;A+=1)for(let I=0;I<=1;I+=1){const R=this.getLocation(s+x,a+A,o+I),C=u.BlockPos.magnitude(R);g>=C?(f=d,d=h,h=R,l=c,c=g,g=C):c>=C?(f=d,d=R,l=c,c=C):l>=C&&(f=R,l=C)}const w=this.getStatus(h),v=this.getStatus(d),m=this.getStatus(f),p=zt.similarity(g,c),S=zt.similarity(g,l),E=zt.similarity(c,l);let y;if(w.at(e).is(X.WATER)&&this.globalFluidPicker(t,e-1,r).at(e-1).is(X.LAVA))y=1;else if(p>-1){const x=an(()=>this.router.barrier.compute(q.context(t,e*.5,r))),A=this.calculatePressure(e,w,v,x),I=this.calculatePressure(e,w,m,x),R=this.calculatePressure(e,v,m,x),C=Math.max(A,I*Math.max(0,S),R*Math.max(E));y=Math.max(0,2*Math.max(0,p)*C)}else y=0;if(i+y<=0)return w.at(e)}}}static similarity(t,e){return 1-Math.abs(e-t)/25}calculatePressure(t,e,r,i){const s=e.at(t),a=r.at(t);if(s.is(X.LAVA)&&a.is(X.WATER)||s.is(X.WATER)&&a.is(X.LAVA))return 1;const o=Math.abs(e.level-r.level);if(o===0)return 0;const g=(e.level+r.level)/2,c=t+.5-g,l=o/2-Math.abs(c),h=c>0?l>0?l/1.5:l/2.5:l>-3?(l+3)/3:(l+3)/10;return h<-2||h>2?h:h+i()}getStatus(t){const[e,r,i]=t,s=this.getIndex(this.gridX(e),this.gridY(r),this.gridZ(i)),a=this.aquiferCache[s];if(a!==void 0)return a;const o=this.computeStatus(e,r,i);return this.aquiferCache[s]=o,o}computeStatus(t,e,r){const i=this.globalFluidPicker(t,e,r);let s=Number.MAX_SAFE_INTEGER,a=!1;for(const[w,v]of zt.SURFACE_SAMPLING){const m=t+(v<<4),p=r+(v<<4),S=this.noiseChunk.getPreliminarySurfaceLevel(m,p);s=Math.min(s,S);const E=w===0&&v===0;if(E&&e-12>S+8)return i;if(E||e+12>S+8){const y=this.globalFluidPicker(m,S+8,p);if(!y.at(S+8).is(X.AIR)){if(E)return y;a=!0}}}const o=a?qr(s+8-e,0,64,1,0):0,g=yt(this.router.fluidLevelFloodedness.compute(q.context(t,e*.67,r)),-1,1);if(g>Rn(o,1,0,-.3,.8))return i;if(g<=Rn(o,1,0,-.8,.4))return new Tn(Number.MIN_SAFE_INTEGER,i.type);const c=Math.floor(e/40),l=this.router.fluidLevelSpread.compute(q.context(Math.floor(t/16),c,Math.floor(r/16))),h=c*40+20+Math.floor(l/3)*3,d=Math.min(s,h),f=this.getFluidType(t,e,r,i.type,h);return new Tn(d,f)}getFluidType(t,e,r,i,s){if(s<=-10){const a=this.router.lava.compute(q.context(Math.floor(t/64),Math.floor(e/40),Math.floor(r/64)));if(Math.abs(a)>.3)return X.LAVA}return i}getLocation(t,e,r){const i=this.getIndex(t,e,r),s=this.aquiferLocationCache[i];if(u.BlockPos.equals(s,u.BlockPos.ZERO))return s;const a=this.random.at(t,e,r),o=u.BlockPos.create(t*zt.X_SPACING+a.nextInt(10),e*zt.Y_SPACING+a.nextInt(9),r*zt.Z_SPACING+a.nextInt(10));return this.aquiferLocationCache[i]=o,o}getIndex(t,e,r){const i=t-this.minGridX,s=e-this.minGridY,a=r-this.minGridZ,o=(s*this.gridSizeZ+a)*this.gridSizeX+i;if(o<0||o>=this.gridSize)throw new Error(`Invalid aquifer index at ${t} ${e} ${r}: 0 <= ${o} < ${this.gridSize}`);return o}gridX(t){return Math.floor(t/zt.X_SPACING)}gridY(t){return Math.floor(t/zt.Y_SPACING)}gridZ(t){return Math.floor(t/zt.Z_SPACING)}};let Fe=zt;_(Fe,"X_SPACING",16),_(Fe,"Y_SPACING",12),_(Fe,"Z_SPACING",16),_(Fe,"SURFACE_SAMPLING",[[-2,-1],[-1,-1],[0,-1],[1,-1],[-3,0],[-2,0],[-1,0],[0,0],[1,0],[-2,1],[-1,1],[0,1],[1,1]]),u.HeightProvider=void 0,(n=>{function t(g){var h,d,f;const c=(h=u.Json.readObject(g))!=null?h:{};switch((d=u.Json.readString(c.type))==null?void 0:d.replace(/^minecraft:/,"")){case void 0:return e(u.VerticalAnchor.fromJson(g));case"constant":return e(u.VerticalAnchor.fromJson(c.value));case"uniform":return r(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive));case"biased_to_bottom":return i(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive),u.Json.readInt(c.inner));case"very_biased_to_bottom":return s(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive),u.Json.readInt(c.inner));case"trapezoid":return a(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive),u.Json.readInt(c.plateau));case"weighted_list":return o((f=u.Json.readArray(c.distribution,w=>{var m,p;const v=(m=u.Json.readObject(w))!=null?m:{};return{weight:(p=u.Json.readInt(v.weight))!=null?p:1,data:t(v.data)}}))!=null?f:[])}return()=>0}n.fromJson=t;function e(g){return(c,l)=>g(l)}n.constant=e;function r(g,c){return(l,h)=>{const d=g(h),f=c(h);return d>f?d:l.nextInt(f-d+1)+d}}n.uniform=r;function i(g,c,l=1){return(h,d)=>{const f=g(d),w=c(d);if(w-f-l+1<=0)return f;{const v=h.nextInt(w-f-l+1);return h.nextInt(v+l)+f}}}n.biased_to_bottom=i;function s(g,c,l=1){return(h,d)=>{const f=g(d),w=c(d);if(w-f-l+1<=0)return f;{const v=sr(h,f+l,w),m=sr(h,f,v-1);return sr(h,f,m-1+l)}}}n.very_biased_to_bottom=s;function a(g,c,l=0){return(h,d)=>{const f=g(d),w=c(d);if(f>w)return f;{const v=w-f;if(l>=v)return ir(h,f,w);{const m=(v-l)/2,p=v-m;return f+ir(h,0,p)+ir(h,0,m)}}}}n.trapezoid=a;function o(g){const c=g.reduce((l,h,d)=>l+h.weight,0);return(l,h)=>{let d=l.nextInt(c);for(const f of g)if(d-=f.weight,d<=0)return f.data(l,h);return 0}}n.weighted_list=o})(u.HeightProvider||(u.HeightProvider={})),u.Heightmap=void 0,(n=>{function t(e){if(typeof e=="string"&&(e==="WORLD_SURFACE_WG"||e==="WORLD_SURFACE"||e==="OCEAN_FLOOR_WG"||e==="OCEAN_FLOOR"||e==="MOTION_BLOCKING"||e==="MOTION_BLOCKING_NO_LEAVES"))return e}n.fromJson=t})(u.Heightmap||(u.Heightmap={}));class ai{constructor(t,e,r,i,s,a,o,g,c){_(this,"cellWidth");_(this,"cellHeight");_(this,"firstCellX");_(this,"firstCellZ");_(this,"firstNoiseX");_(this,"firstNoiseZ");_(this,"noiseSizeXZ");_(this,"preliminarySurfaceLevel",new Map);_(this,"aquifer");_(this,"materialRule");_(this,"initialDensity");this.cellCountXZ=t,this.cellCountY=e,this.cellNoiseMinY=r,this.minX=s,this.minZ=a,this.settings=o,this.cellWidth=u.NoiseSettings.cellWidth(o),this.cellHeight=u.NoiseSettings.cellHeight(o),this.firstCellX=Math.floor(s/this.cellWidth),this.firstCellZ=Math.floor(a/this.cellWidth),this.firstNoiseX=s>>2,this.firstNoiseZ=a>>2,this.noiseSizeXZ=t*this.cellWidth>>2,this.aquifer=u.Aquifer.createDisabled(c);const l=i.router.finalDensity;this.materialRule=u.MaterialRule.fromList([h=>this.aquifer.compute(h,l.compute(h))]),this.initialDensity=i.router.initialDensityWithoutJaggedness}getFinalState(t,e,r){return this.materialRule({x:t,y:e,z:r})}getPreliminarySurfaceLevel(t,e){return Ie(this.preliminarySurfaceLevel,u.ChunkPos.asLong(t,e),()=>{const r=t<<2,i=e<<2;for(let s=this.settings.minY+this.settings.height;s>=this.settings.minY;s-=this.cellHeight)if(this.initialDensity.compute(q.context(r,s,i))>.390625)return s;return Number.MAX_SAFE_INTEGER})}}u.MaterialRule=void 0,(n=>{function t(e){return r=>{for(const i of e){const s=i(r);if(s)return s}}}n.fromList=t})(u.MaterialRule||(u.MaterialRule={}));class Qs{constructor(t,e){_(this,"noiseChunkCache");_(this,"globalFluidPicker");this.biomeSource=t,this.settings=e,this.noiseChunkCache=new Map;const r=new Tn(-54,X.LAVA),i=new Tn(e.seaLevel,e.defaultFluid);this.globalFluidPicker=(s,a,o)=>a<Math.min(-54,e.seaLevel)?r:i}getBaseHeight(t,e,r,i){var a;let s;return r==="OCEAN_FLOOR"||r==="OCEAN_FLOOR_WG"?s=o=>o.equals(X.STONE):s=o=>!o.equals(X.AIR),(a=this.iterateNoiseColumn(i,t,e,void 0,s,X.STONE))!=null?a:this.settings.noise.minY}iterateNoiseColumn(t,e,r,i,s,a){var v,m;const o=this.settings.noise.minY,g=u.NoiseSettings.cellHeight(this.settings.noise),c=Math.floor(o/g),l=Math.floor(this.settings.noise.height/g);if(l<=0)return;const h=u.NoiseSettings.cellWidth(this.settings.noise),d=Math.floor(e/h),f=Math.floor(r/h),w=new ai(1,l,c,t,d,f,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker);for(let p=l-1;p>=0;p-=1)for(let S=g-1;S>=0;S-=1){const E=(c+p)*g+S,y=(m=(v=w.getFinalState(e,E,r))!=null?v:a)!=null?m:this.settings.defaultBlock;if(i!==void 0&&(i[E+o]=y),s!==void 0&&s(y))return E+1}}fill(t,e,r=!1){var w;const i=Math.max(e.minY,this.settings.noise.minY),s=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),a=u.NoiseSettings.cellWidth(this.settings.noise),o=u.NoiseSettings.cellHeight(this.settings.noise),g=Math.floor(16/a),c=Math.floor(i/o),l=Math.floor((s-i)/o),h=u.ChunkPos.minBlockX(e.pos),d=u.ChunkPos.minBlockZ(e.pos),f=this.getOrCreateNoiseChunk(t,e);for(let v=0;v<g;v+=1)for(let m=0;m<(r?1:g);m+=1){let p=e.getOrCreateSection(e.sectionsCount-1);for(let S=l-1;S>=0;S-=1)for(let E=o-1;E>=0;E-=1){const y=(c+S)*o+E,x=y&15,A=e.getSectionIndex(y);e.getSectionIndex(p.minBlockY)!==A&&(p=e.getOrCreateSection(A));for(let I=0;I<a;I+=1){const R=h+v*a+I,C=R&15;for(let M=0;M<(r?1:a);M+=1){const N=d+m*a+M,L=N&15,F=(w=f.getFinalState(R,y,N))!=null?w:this.settings.defaultBlock;p.setBlockState(C,x,L,F)}}}}}buildSurface(t,e,r="minecraft:plains"){const i=this.getOrCreateNoiseChunk(t,e),s=this.settings.noise;t.surfaceSystem.buildSurface(e,i,s,()=>r)}computeBiome(t,e,r,i){return this.biomeSource.getBiome(e,r,i,t.sampler)}getOrCreateNoiseChunk(t,e){return Ie(this.noiseChunkCache,u.ChunkPos.toLong(e.pos),()=>{const r=Math.max(e.minY,this.settings.noise.minY),i=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),s=u.NoiseSettings.cellWidth(this.settings.noise),a=u.NoiseSettings.cellHeight(this.settings.noise),o=Math.floor(16/s),g=Math.floor(r/a),c=Math.floor((i-r)/a),l=u.ChunkPos.minBlockX(e.pos),h=u.ChunkPos.minBlockZ(e.pos);return new ai(o,c,g,t,l,h,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker)})}}class dr{constructor(t,e){_(this,"n");if(this.shift=t,this.biomes=e,e.length===0)throw new Error("Cannot create checkerboard biome source without biomes");this.n=e.length}getBiome(t,e,r){const i=(((t>>this.shift)+(r>>this.shift))%this.n+this.n)%this.n;return B.parse(this.biomes[i].toString())}static fromJson(t){var s,a,o;const e=(s=u.Json.readObject(t))!=null?s:{},r=(a=u.Json.readInt(e.scale))!=null?a:2;let i;return typeof e.biomes=="string"?i=[B.parse(e.biomes)]:i=(o=u.Json.readArray(e.biomes,g=>{var c;return B.parse((c=u.Json.readString(g))!=null?c:"")}))!=null?o:[],new dr(r+2,i)}}class tn{constructor(t){this.biome=t}getBiome(){return this.biome}static fromJson(t){var i,s;const e=(i=u.Json.readObject(t))!=null?i:{},r=B.parse((s=u.Json.readString(e.biome))!=null?s:"plains");return new tn(r)}}u.Climate=void 0,(n=>{function e(v,m,p,S,E,y){return new o(v,m,p,S,E,y)}n.target=e;function r(v,m,p,S,E,y,x){return new a(i(v),i(m),i(p),i(S),i(E),i(y),x)}n.parameters=r;function i(v,m){return typeof v=="number"?new s(v,m!=null?m:v):v}n.param=i;class s{constructor(m,p){this.min=m,this.max=p}distance(m){const p=(typeof m=="number"?m:m.min)-this.max,S=this.min-(typeof m=="number"?m:m.max);return p>0?p:Math.max(S,0)}union(m){return new s(Math.min(this.min,m.min),Math.max(this.max,m.max))}static fromJson(m){var E;if(typeof m=="number")return new s(m,m);const[p,S]=(E=u.Json.readArray(m,y=>u.Json.readNumber(y)))!=null?E:[];return new s(p!=null?p:0,S!=null?S:0)}}n.Param=s;class a{constructor(m,p,S,E,y,x,A){this.temperature=m,this.humidity=p,this.continentalness=S,this.erosion=E,this.depth=y,this.weirdness=x,this.offset=A}fittness(m){return ie(this.temperature.distance(m.temperature))+ie(this.humidity.distance(m.humidity))+ie(this.continentalness.distance(m.continentalness))+ie(this.erosion.distance(m.erosion))+ie(this.depth.distance(m.depth))+ie(this.weirdness.distance(m.weirdness))+ie(this.offset-m.offset)}space(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,new s(this.offset,this.offset)]}static fromJson(m){var S,E;const p=(S=u.Json.readObject(m))!=null?S:{};return new a(s.fromJson(p.temperature),s.fromJson(p.humidity),s.fromJson(p.continentalness),s.fromJson(p.erosion),s.fromJson(p.depth),s.fromJson(p.weirdness),(E=u.Json.readNumber(p.offset))!=null?E:0)}}n.ParamPoint=a;class o{constructor(m,p,S,E,y,x){this.temperature=m,this.humidity=p,this.continentalness=S,this.erosion=E,this.depth=y,this.weirdness=x}get offset(){return 0}toArray(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,this.offset]}}n.TargetPoint=o;class g{constructor(m){_(this,"index");this.things=m,this.index=new l(m)}find(m){return this.index.search(m,(p,S)=>p.distance(S))}}n.Parameters=g;class c{constructor(m,p,S,E,y,x){this.temperature=m,this.humidity=p,this.continentalness=S,this.erosion=E,this.depth=y,this.weirdness=x}static fromRouter(m){return new n.Sampler(m.temperature,m.vegetation,m.continents,m.erosion,m.depth,m.ridges)}sample(m,p,S){const E=q.context(m<<2,p<<2,S<<2);return n.target(this.temperature.compute(E),this.humidity.compute(E),this.continentalness.compute(E),this.erosion.compute(E),this.depth.compute(E),this.weirdness.compute(E))}}n.Sampler=c;const w=class{constructor(m){_(this,"root");_(this,"last_leaf",null);if(m.length===0)throw new Error("At least one point is required to build search tree");this.root=w.build(m.map(([p,S])=>new f(p,S)))}static build(m){if(m.length===1)return m[0];if(m.length<=w.CHILDREN_PER_NODE){const y=m.map(x=>{let A=0;for(let I=0;I<7;I+=1){const R=x.space[I];A+=Math.abs((R.min+R.max)/2)}return{key:A,node:x}}).sort((x,A)=>x.key-A.key).map(({node:x})=>x);return new d(y)}let p=1/0,S=-1,E=[];for(let y=0;y<7;++y){m=w.sort(m,y,!1),E=w.bucketize(m);let x=0;for(const A of E)x+=w.area(A.space);p>x&&(p=x,S=y)}return m=w.sort(m,S,!1),E=w.bucketize(m),E=w.sort(E,S,!0),new d(E.map(y=>w.build(y.children)))}static sort(m,p,S){return m.map(E=>{const y=E.space[p],x=(y.min+y.max)/2;return{key:S?Math.abs(x):x,node:E}}).sort((E,y)=>E.key-y.key).map(({node:E})=>E)}static bucketize(m){const p=[];let S=[];const E=Math.pow(10,Math.floor(Math.log(m.length-.01)/Math.log(10)));for(const y of m)S.push(y),!(S.length<E)&&(p.push(new d(S)),S=[]);return S.length!==0&&p.push(new d(S)),p}static area(m){let p=0;for(const S of m)p+=Math.abs(S.max-S.min);return p}search(m,p){const S=this.root.search(m.toArray(),this.last_leaf,p);return this.last_leaf=S,S.thing()}};let l=w;_(l,"CHILDREN_PER_NODE",10),n.RTree=l;class h{constructor(m){this.space=m}distance(m){let p=0;for(let S=0;S<7;S+=1)p+=ie(this.space[S].distance(m[S]));return p}}n.RNode=h;class d extends h{constructor(m){super(d.buildSpace(m)),this.children=m}static buildSpace(m){let p=[...Array(7)].map(()=>new s(1/0,-1/0));for(const S of m)p=[...Array(7)].map((E,y)=>p[y].union(S.space[y]));return p}search(m,p,S){let E=p?S(p,m):1/0,y=p;for(const x of this.children){const A=S(x,m);if(E<=A)continue;const I=x.search(m,y,S);if(I===null)continue;const R=x==I?A:S(I,m);if(R===0)return I;E<=R||(E=R,y=I)}return y}}n.RSubTree=d;class f extends h{constructor(m,p){super(m.space()),this.thing=p}search(){return this}}n.RLeaf=f})(u.Climate||(u.Climate={}));class gr{constructor(t){_(this,"parameters");this.parameters=new u.Climate.Parameters(t)}getBiome(t,e,r,i){const s=i.sample(t,e,r);return this.parameters.find(s)}static fromJson(t){var s,a;const e=(s=u.Json.readObject(t))!=null?s:{},i=((a=u.Json.readArray(e.biomes,o=>{var g;return(c=>{var l;return{biome:B.parse((l=u.Json.readString(c.biome))!=null?l:"plains"),parameters:u.Climate.ParamPoint.fromJson(c.parameters)}})((g=u.Json.readObject(o))!=null?g:{})}))!=null?a:[]).map(o=>[o.parameters,()=>o.biome]);return new gr(i)}}const Se=class{getBiome(t,e,r,i){const s=t<<2,a=e<<2,o=r<<2,g=s>>4,c=o>>4;if(g*g+c*c<=4096)return Se.END;const l=q.context((g*2+1)*8,a,(c*2+1)*8),h=i.erosion.compute(l);return h>.25?Se.HIGHLANDS:h>=-.0625?Se.MIDLANDS:h>=-.21875?Se.BARRENS:Se.ISLANDS}static fromJson(t){return new Se}};let be=Se;_(be,"END",B.create("the_end")),_(be,"HIGHLANDS",B.create("end_highlands")),_(be,"MIDLANDS",B.create("end_midlands")),_(be,"ISLANDS",B.create("small_end_islands")),_(be,"BARRENS",B.create("end_barrens")),u.BiomeSource=void 0,(n=>{function t(r){var a,o;const i=(a=u.Json.readObject(r))!=null?a:{};switch((o=u.Json.readString(i.type))==null?void 0:o.replace(/^minecraft:/,"")){case"fixed":return tn.fromJson(r);case"checkerboard":return dr.fromJson(r);case"multi_noise":return gr.fromJson(r);case"the_end":return be.fromJson(r);default:return new tn(B.create("plains"))}}n.fromJson=t;function e(r,i,s,a,o,g,c,l,h=1,d=!1){if(r instanceof tn)return g(r.getBiome())?d?{pos:u.BlockPos.create(i,s,a),biome:r.getBiome()}:{pos:u.BlockPos.create(i-o+c.nextInt(o*2+1),s,a-o+c.nextInt(o*2+1)),biome:r.getBiome()}:void 0;const f=i>>2,w=a>>2,v=o>>2,m=s>>2;for(var p=void 0,S=0,E=d?0:v,y=E;y<=v;y+=h)for(var x=-y;x<=y;x+=h){const I=Math.abs(x)===y;for(var A=-y;A<=y;A+=h){if(d&&!(Math.abs(A)===y)&&!I)continue;const R=f+A,C=w+x,M=r.getBiome(R,m,C,l);if(g(M)){if((p===void 0||c.nextInt(S+1)<=.5)&&(p={pos:u.BlockPos.create(R<<2,s,C<<2),biome:M},d))return p;S++}}}return p}n.findBiomeHorizontal=e})(u.BiomeSource||(u.BiomeSource={}));class ta{constructor(t,e){_(this,"noiseCache");_(this,"randomCache");_(this,"random");_(this,"aquiferRandom");_(this,"oreRandom");_(this,"surfaceSystem");_(this,"router");_(this,"sampler");this.seed=e,this.noiseCache=new Map,this.randomCache=new Map,this.random=(t.legacyRandomSource?new at(e):rt.create(e)).forkPositional(),this.aquiferRandom=this.random.fromHashOf(B.create("aquifer").toString()).forkPositional(),this.oreRandom=this.random.fromHashOf(B.create("ore").toString()).forkPositional(),this.surfaceSystem=new js(t.surfaceRule,t.defaultBlock,e),this.router=u.NoiseRouter.mapAll(t.noiseRouter,this.createVisitor(t.noise,t.legacyRandomSource)),this.sampler=u.Climate.Sampler.fromRouter(this.router)}createVisitor(t,e){const r=new Map,i=a=>{const o=a.key();if(o===void 0)throw new Error("Cannot create noise without key");if(e){if(o.equals(B.create("temperature")))return new ae(new at(this.seed+BigInt(0)),u.NoiseParameters.create(-7,[1,1]));if(o.equals(B.create("vegetation")))return new ae(new at(this.seed+BigInt(1)),u.NoiseParameters.create(-7,[1,1]));if(o.equals(B.create("offset")))return new ae(this.random.fromHashOf("offset"),u.NoiseParameters.create(0,[0]))}return this.getOrCreateNoise(o)},s={map:a=>{if(a instanceof q.HolderHolder){const o=a.holder.key();if(o!==void 0&&r.has(o.toString()))return r.get(o.toString());{const g=a.holder.value().mapAll(s);return o!==void 0&&r.set(o.toString(),g),g}}if(a instanceof q.Interpolated)return a.withCellSize(u.NoiseSettings.cellWidth(t),u.NoiseSettings.cellHeight(t));if(a instanceof q.ShiftedNoise)return new q.ShiftedNoise(a.shiftX,a.shiftY,a.shiftZ,a.xzScale,a.yScale,a.noiseData,i(a.noiseData));if(a instanceof q.Noise)return new q.Noise(a.xzScale,a.yScale,a.noiseData,i(a.noiseData));if(a instanceof q.ShiftNoise)return a.withNewNoise(i(a.noiseData));if(a instanceof q.WeirdScaledSampler)return new q.WeirdScaledSampler(a.input,a.rarityValueMapper,a.noiseData,i(a.noiseData));if(a instanceof q.OldBlendedNoise){const o=e?new at(this.seed+BigInt(0)):this.random.fromHashOf(B.create("terrain").toString());return new q.OldBlendedNoise(a.xzScale,a.yScale,a.xzFactor,a.yFactor,a.smearScaleMultiplier,new qs(o,a.xzScale,a.yScale,a.xzFactor,a.yFactor,a.smearScaleMultiplier))}return a instanceof q.EndIslands?new q.EndIslands(this.seed):a instanceof q.Mapped||a instanceof q.Ap2?a.withMinMax():a}};return s}getOrCreateNoise(t){const e=Ct.REGISTRY.getOrThrow(B.create("worldgen/noise"));return Ie(this.noiseCache,t.toString(),r=>new ae(this.random.fromHashOf(r),e.getOrThrow(t)))}getOrCreateRandom(t){return Ie(this.randomCache,t.toString(),e=>this.random.fromHashOf(e).forkPositional())}}class Ht{static fromJson(t){var r,i,s,a;const e=(r=u.Json.readObject(t))!=null?r:{};switch((i=u.Json.readString(e.element_type))==null?void 0:i.replace(/^minecraft:/,"")){case"single_pool_element":case"legacy_single_pool_element":const o=B.parse((s=u.Json.readString(e.location))!=null?s:""),g={key:()=>o,value:()=>{var l;return(l=re.REGISTRY.get(o))!=null?l:re.EMPTY}};return new Ht.SinlgePoolElement(g);case"list_pool_element":const c=(a=u.Json.readArray("elements",Ht.fromJson))!=null?a:[];return new Ht.ListPoolElement(c);case"feature_pool_element":return new Ht.FeaturePoolElement;case"empty_pool_element":default:return new Ht.EmptyPoolElement}}}(n=>{class t extends n{getBoundingBox(o,g){throw new Error("Invalid call of EmptyPoolElement")}getShuffledJigsawBlocks(o,g){return[]}toString(){return"[Empty Pool Element]"}}n.EmptyPoolElement=t;class e extends n{constructor(){super();_(this,"defaultJigsawNBT");const g=new Map;g.set("name",new bt("minecraft:bottom")),g.set("final_state",new bt("minecraft:air")),g.set("pool",new bt("minecraft:empty")),g.set("target",new bt("minecraft:empty")),g.set("joint",new bt("rollable")),this.defaultJigsawNBT=new mt(g)}getBoundingBox(g,c){return[g,g]}getShuffledJigsawBlocks(g,c){return[{pos:[0,0,0],state:new X(B.create("jigsaw"),{orientation:"down_south"}),nbt:this.defaultJigsawNBT}]}toString(){return"[Feature Pool Element]"}}n.FeaturePoolElement=e;const s=class extends n{constructor(o){super(),this.template=o}getBoundingBox(o,g){const c=u.BlockPos.offset(this.template.value().getSize(),-1,-1,-1),l=o,h=u.BlockPos.add(re.transform(c,g,u.BlockPos.ZERO),o),d=u.BlockPos.create(Math.min(l[0],h[0]),l[1],Math.min(l[2],h[2])),f=u.BlockPos.create(Math.max(l[0],h[0]),h[1],Math.max(l[2],h[2]));return[d,f]}getShuffledJigsawBlocks(o,g){const c=this.template.value().getBlocks().filter(l=>l.state.getName().equals(s.JIGSAW_ID));return c.forEach(l=>l.pos=re.transform(l.pos,o,u.BlockPos.ZERO)),Us(c,g),c}toString(){return`[Single Pool Element: ${this.template.key()}]`}};let r=s;_(r,"JIGSAW_ID",B.parse("jigsaw")),n.SinlgePoolElement=r;class i extends n{constructor(o){super(),this.elements=o}getBoundingBox(o,g){var c=void 0,l=void 0;for(const h of this.elements){const d=h.getBoundingBox(o,g);!c||!l?(c=d[0],l=d[1]):(c[0]=Math.min(c[0],d[0][0]),c[1]=Math.min(c[1],d[0][1]),c[2]=Math.min(c[2],d[0][2]),l[0]=Math.min(c[0],d[1][0]),l[1]=Math.min(c[1],d[1][1]),l[2]=Math.min(c[2],d[1][2]))}return[c,l]}getShuffledJigsawBlocks(o,g){return this.elements[0].getShuffledJigsawBlocks(o,g)}toString(){return`[List Pool Element: ${"; ".concat(...this.elements.map(o=>o.toString()))}]`}}n.ListPoolElement=i})(Ht||(Ht={}));const $e=class{constructor(t,e){_(this,"totalWeight");this.rawTemplates=t,this.fallback=e,this.totalWeight=t.reduce((r,i)=>r+i.weight,0)}static fromJson(t){var s,a,o;const e=(s=u.Json.readObject(t))!=null?s:{},r=$e.structurePoolParser((a=e.fallback)!=null?a:""),i=(o=u.Json.readArray(e.elements,g=>{var d,f;const c=(d=u.Json.readObject(g))!=null?d:{},l=Ht.fromJson(c.element),h=(f=u.Json.readInt(c.weight))!=null?f:1;return{element:l,weight:h}}))!=null?o:[];return new $e(i,r)}getRandomTemplate(t){var e=t.nextInt(this.totalWeight);for(const r of this.rawTemplates)if(e-=r.weight,e<0)return r.element;return this.rawTemplates[this.rawTemplates.length-1].element}};let Ue=$e;_(Ue,"REGISTRY",Ct.createAndRegister("worldgen/template_pool",$e.fromJson)),_(Ue,"structurePoolParser",u.Holder.parser($e.REGISTRY,$e.fromJson));class mr{constructor(t){this.settings=t}onTopOfChunkCenter(t,e,r,i="WORLD_SURFACE_WG"){const s=(e<<4)+8,a=(r<<4)+8;return[s,t.chunkGenerator.getBaseHeight(s,a,i,t.randomState)-1,a]}getLowestY(t,e,r,i,s){return Math.min(t.chunkGenerator.getBaseHeight(e,r,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e,r+s,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e+i,r,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e+i,r+s,"WORLD_SURFACE_WG",t.randomState)-1)}getLowestYIn5by5BoxOffset7Blocks(t,e,r,i){let s=5,a=5;i===u.Rotation.CLOCKWISE_90?s=-5:i===u.Rotation.CLOCKWISE_180?(s=-5,a=-5):i===u.Rotation.COUNTERCLOCKWISE_90&&(a=-5);const o=(e<<4)+7,g=(r<<4)+7;return u.BlockPos.create(o,this.getLowestY(t,o,g,s,a),g)}tryGenerate(t,e,r){const i=at.fromLargeFeatureSeed(r.seed,t,e),s=this.findGenerationPoint(t,e,i,r);if(s===void 0)return;const a=r.biomeSource.getBiome(s[0]>>2,s[1]>>2,s[2]>>2,r.randomState.sampler);return[...this.settings.validBiomes.getEntries()].findIndex(o=>{var g;return(g=o.key())==null?void 0:g.equals(a)})>=0?s:void 0}}(n=>{n.REGISTRY=Ct.createAndRegister("worldgen/structure",i);class t{constructor(I){this.validBiomes=I}}n.StructureSettings=t;class e{constructor(I,R,C,M){_(this,"chunkGenerator");_(this,"randomState");this.seed=I,this.biomeSource=R,this.settings=C,this.levelHeight=M,this.randomState=new ta(C,I),this.chunkGenerator=new Qs(R,C)}}n.GenerationContext=e;const r=u.Holder.parser(Ue.REGISTRY,Ue.fromJson);function i(A){var N,L,F;const I=_e.parser(u.WorldgenRegistries.BIOME),R=(N=u.Json.readObject(A))!=null?N:{},C=I(R.biomes),M=new t(C.value());switch((L=u.Json.readString(R.type))==null?void 0:L.replace(/^minecraft:/,"")){case"buried_treasure":return new a(M);case"desert_pyramid":return new g(M);case"end_city":return new c(M);case"fortress":return new l(M);case"igloo":return new h(M);case"jigsaw":const U=u.HeightProvider.fromJson(R.start_height),T=r(R.start_pool),O=u.Json.readString(R.start_jigsaw_name),G=O?B.parse(O):void 0,H=u.Heightmap.fromJson(R.project_start_to_heightmap),j=s.DimensionPadding.fromJson(R.dimension_padding);return new s(M,T,U,H,G,j);case"jungle_temple":return new d(M);case"mineshaft":const k=u.Json.readString(R.mineshaft_type)==="mesa"?"mesa":"normal";return new f(M,k);case"nether_fossil":return new l(M);case"ocean_monument":return new v(M);case"ocean_ruin":return new m(M);case"ruined_portal":return new p(M);case"shipwreck":const b=(F=u.Json.readBoolean(R.is_beached))!=null?F:!1;return new S(M,b);case"stronghold":return new E(M);case"swamp_hut":return new y(M);case"woodland_mansion":return new x(M)}return new a(M)}n.fromJson=i;class s extends n{constructor(I,R,C,M,N,L){super(I),this.startingPoolHolder=R,this.startHeight=C,this.projectStartToHeightmap=M,this.startJigsawName=N,this.dimensionPadding=L}findGenerationPoint(I,R,C,M){var N=this.startHeight(C,M.settings.noise);const L=u.BlockPos.create(I<<4,N,R<<4),F=u.Rotation.getRandom(C),T=this.startingPoolHolder.value().getRandomTemplate(C);if(!(T instanceof Ht.EmptyPoolElement)){var O;if(this.startJigsawName){const z=s.getRandomNamedJigsaw(T,this.startJigsawName,F,C);if(z===void 0)return;O=z}else O=u.BlockPos.ZERO;const G=u.BlockPos.subtract(L,O),H=T.getBoundingBox(G,F),j=(H[1][0]+H[0][0])/2^0,k=(H[1][2]+H[0][2])/2^0;var N;return this.projectStartToHeightmap?N=L[1]+M.chunkGenerator.getBaseHeight(j,k,this.projectStartToHeightmap,M.randomState):N=G[1],H.forEach(z=>z[1]+=N-H[0][1]-1),s.isStartTooCloseToWorldHeightLimits(this.dimensionPadding,H,M.levelHeight)?void 0:u.BlockPos.create(j,N+O[1],k)}}static isStartTooCloseToWorldHeightLimits(I,R,C){if(I===s.DimensionPadding.ZERO)return!1;const M=C.minY+I.bottom,N=C.minY+C.height-I.top;return R[0][1]<M||R[1][1]>N}static getRandomNamedJigsaw(I,R,C,M){var L,F;const N=I.getShuffledJigsawBlocks(C,M);for(const U of N)if(B.parse((F=(L=U.nbt)==null?void 0:L.getString("name"))!=null?F:"minecraft:empty").equals(R))return U.pos}}n.JigsawStructure=s,(A=>{const R=class{constructor(M,N){this.top=M,this.bottom=N}static fromJson(M){var L,F,U;if(M===void 0)return R.ZERO;if(typeof M=="number")return new R(M,M);const N=(L=u.Json.readObject(M))!=null?L:{};return new R((F=u.Json.readInt(N.top))!=null?F:0,(U=u.Json.readInt(N.bottom))!=null?U:0)}};let I=R;_(I,"ZERO",new R(0,0)),A.DimensionPadding=I})(s=n.JigsawStructure||(n.JigsawStructure={}));class a extends n{findGenerationPoint(I,R,C,M){return this.onTopOfChunkCenter(M,I,R,"OCEAN_FLOOR_WG")}}n.BuriedTreasureStructure=a;class o extends n{constructor(I,R,C){super(I),this.width=R,this.depth=C}findGenerationPoint(I,R,C,M){if(!(this.getLowestY(M,I<<4,R<<4,this.width,this.depth)<M.settings.seaLevel))return this.onTopOfChunkCenter(M,I,R)}}class g extends o{constructor(I){super(I,21,21)}}n.DesertPyramidStructure=g;class c extends n{findGenerationPoint(I,R,C,M){const N=u.Rotation.getRandom(C),L=this.getLowestYIn5by5BoxOffset7Blocks(M,I,R,N);if(!(L[1]<60))return L}}n.EndCityStructure=c;class l extends n{findGenerationPoint(I,R){return u.BlockPos.create(I<<4,64,R<<4)}}n.NetherFortressStructure=l;class h extends n{findGenerationPoint(I,R,C,M){return this.onTopOfChunkCenter(M,I,R)}}n.IglooStructure=h;class d extends o{constructor(I){super(I,12,15)}}n.JungleTempleStructure=d;class f extends n{constructor(I,R){super(I),this.type=R}findGenerationPoint(I,R,C,M){throw new Error("Method not implemented.")}}n.MineshaftStructure=f;class w extends n{constructor(I,R){super(I),this.height=R}findGenerationPoint(I,R){throw new Error("Method not implemented.")}}n.NetherFossilStructure=w;class v extends n{findGenerationPoint(I,R){throw new Error("Method not implemented.")}}n.OceanMonumentStructure=v;class m extends n{findGenerationPoint(I,R,C,M){return this.onTopOfChunkCenter(M,I,R,"OCEAN_FLOOR_WG")}}n.OceanRuinStructure=m;class p extends n{findGenerationPoint(I,R){throw new Error("Method not implemented.")}}n.RuinedPortalStructure=p;class S extends n{constructor(I,R){super(I),this.isBeached=R}findGenerationPoint(I,R,C,M){return this.onTopOfChunkCenter(M,I,R,this.isBeached?"WORLD_SURFACE_WG":"OCEAN_FLOOR_WG")}}n.ShipwreckStructure=S;class E extends n{findGenerationPoint(I,R){return u.BlockPos.create(I<<4,0,R<<4)}}n.StrongholdStructure=E;class y extends n{findGenerationPoint(I,R,C,M){return this.onTopOfChunkCenter(M,I,R)}}n.SwampHutStructure=y;class x extends n{findGenerationPoint(I,R,C,M){const N=u.Rotation.getRandom(C),L=this.getLowestYIn5by5BoxOffset7Blocks(M,I,R,N);if(!(L[1]<60))return L}}n.WoodlandMansionStructure=x})(mr||(mr={}));const Pn=class{constructor(t,e){this.structures=t,this.placement=e}static fromJson(t){var s,a;const e=(s=u.Json.readObject(t))!=null?s:{},r=(a=u.Json.readArray(e.structures,Pn.StructureSelectionEntry.fromJson))!=null?a:[],i=Jt.fromJson(e.placement);return new Pn(r,i)}getStructureInChunk(t,e,r){if(this.placement.prepare(r.biomeSource,r.randomState.sampler,r.seed),!!this.placement.isStructureChunk(r.seed,t,e)&&this.structures.length!==0)if(this.structures.length===1){const i=this.structures[0].structure.value().tryGenerate(t,e,r);if(i!==void 0)return{id:this.structures[0].structure.key(),pos:i}}else{const i=at.fromLargeFeatureSeed(r.seed,t,e),s=Object.assign([],this.structures);let a=s.reduce((o,g,c)=>o+g.weight,0);for(;s.length>0;){let o=i.nextInt(a),g,c;for([g,c]of s.entries())if(o-=c.weight,o<0)break;const l=c.structure.value().tryGenerate(t,e,r);if(l!==void 0)return{id:c.structure.key(),pos:l};s.splice(g,1),a-=c.weight}}}};let He=Pn;_(He,"REGISTRY",Ct.createAndRegister("worldgen/structure_set",Pn.fromJson)),(n=>{class t{constructor(r,i){this.structure=r,this.weight=i}static fromJson(r){var s,a,o;const i=(s=u.Json.readObject(r))!=null?s:{};return new t(u.Holder.reference(mr.REGISTRY,B.parse((a=u.Json.readString(i.structure))!=null?a:"minecraft:empty")),(o=u.Json.readInt(i.weight))!=null?o:1)}}n.StructureSelectionEntry=t})(He||(He={}));class Jt{constructor(t,e,r,i,s){this.locateOffset=t,this.frequencyReductionMethod=e,this.frequency=r,this.salt=i,this.exclusionZone=s}static fromJson(t){var c,l,h,d,f,w,v,m,p,S;const e=(c=u.Json.readObject(t))!=null?c:{},r=(l=u.Json.readString(e.type))==null?void 0:l.replace(/^minecraft:/,""),i=u.BlockPos.fromJson(e.locate_offset),s=Jt.FrequencyReducer.fromType((h=u.Json.readString(e.frequency_reduction_method))!=null?h:"default"),a=(d=u.Json.readNumber(e.frequency))!=null?d:1,o=(f=u.Json.readInt(e.salt))!=null?f:0,g="exclusion_zone"in e?Jt.ExclusionZone.fromJson(e.exclusion_zone):void 0;switch(r){case"random_spread":const E=(w=u.Json.readInt(e.spacing))!=null?w:1,y=(v=u.Json.readInt(e.separation))!=null?v:1,x=Jt.SpreadType.fromJson(e.spread_type);return new Jt.RandomSpreadStructurePlacement(i,s,a,o,g,E,y,x);case"concentric_rings":const A=(m=u.Json.readInt(e.distance))!=null?m:1,I=(p=u.Json.readInt(e.spread))!=null?p:1,R=(S=u.Json.readInt(e.count))!=null?S:1,C=_e.parser(u.WorldgenRegistries.BIOME)(e.preferred_biomes);return new Jt.ConcentricRingsStructurePlacement(i,s,a,o,g,A,I,R,C)}return new Jt.RandomSpreadStructurePlacement([0,0,0],Jt.FrequencyReducer.ProbabilityReducer,1,0,void 0,1,1,"linear")}isStructureChunk(t,e,r){return this.isPlacementChunk(t,e,r)?this.frequency<1&&!this.frequencyReductionMethod(t,this.salt,e,r,this.frequency)?!1:!(this.exclusionZone&&this.exclusionZone.isPlacementForbidden(t,e,r)):!1}prepare(t,e,r){}}(n=>{(s=>{function a(h){switch(h){case"legacy_type_1":return l;case"legacy_type_2":return c;case"legacy_type_3":return g;case"default":default:return o}}s.fromType=a;function o(h,d,f,w,v){return at.fromLargeFeatureWithSalt(h,d,f,w).nextFloat()<v}s.ProbabilityReducer=o;function g(h,d,f,w,v){return at.fromLargeFeatureSeed(h,f,w).nextDouble()<v}s.LegacyProbabilityReducerWithDouble=g;function c(h,d,f,w,v){return at.fromLargeFeatureWithSalt(h,f,w,10387320).nextFloat()<v}s.LegacyArbitrarySaltProbabilityReducer=c;function l(h,d,f,w,v){const m=f>>4,p=w>>4,S=new at(BigInt(m^p<<4)^h);return S.nextInt(),S.nextInt(Math.floor(1/v))===0}s.LegacyPillagerOutpostReducer=l})(n.FrequencyReducer||(n.FrequencyReducer={}));class t{constructor(a,o){this.otherSet=a,this.chunkCount=o}static fromJson(a){var g,c,l;const o=(g=u.Json.readObject(a))!=null?g:{};return new t(u.Holder.reference(He.REGISTRY,B.parse((c=u.Json.readString(o.other_set))!=null?c:"")),(l=u.Json.readInt(o.chunk_count))!=null?l:1)}isPlacementForbidden(a,o,g){const c=this.otherSet.value().placement;return c.getPotentialStructureChunks(a,o-this.chunkCount,g-this.chunkCount,o+this.chunkCount,g+this.chunkCount).findIndex(l=>Math.abs(l[0]-o)<=this.chunkCount&&Math.abs(l[1]-g)<=this.chunkCount&&c.isStructureChunk(a,l[0],l[1]))>=0}}n.ExclusionZone=t,(s=>{function a(o){var c;return((c=u.Json.readString(o))!=null?c:"linear")==="triangular"?"triangular":"linear"}s.fromJson=a})(n.SpreadType||(n.SpreadType={}));class e extends n{constructor(a,o,g,c,l,h,d,f){super(a,o,g,c,l),this.spacing=h,this.separation=d,this.spreadType=f}evaluateSpread(a,o){switch(this.spreadType){case"linear":return a.nextInt(o);case"triangular":return Math.floor((a.nextInt(o)+a.nextInt(o))/2)}}getPotentialStructureChunk(a,o,g){const c=Math.floor(o/this.spacing),l=Math.floor(g/this.spacing),h=at.fromLargeFeatureWithSalt(a,c,l,this.salt),d=this.spacing-this.separation,f=this.evaluateSpread(h,d),w=this.evaluateSpread(h,d);return[c*this.spacing+f,l*this.spacing+w]}isPlacementChunk(a,o,g){const[c,l]=this.getPotentialStructureChunk(a,o,g);return c===o&&l===g}getPotentialStructureChunks(a,o,g,c,l){const h=[];for(let d=Math.floor(o/this.spacing)*this.spacing;d<=c;d+=this.spacing)for(let f=Math.floor(g/this.spacing)*this.spacing;f<=l;f+=this.spacing)h.push(this.getPotentialStructureChunk(a,d,f));return h}}n.RandomSpreadStructurePlacement=e;const r=112;class i extends n{constructor(o,g,c,l,h,d,f,w,v){super(o,g,c,l,h);_(this,"positions");this.distance=d,this.spread=f,this.count=w,this.preferredBiomes=v}prepare(o,g,c){if(this.positions!==void 0||(this.positions=[],this.count===0))return;const l=new at(c);var h=l.nextDouble()*Math.PI*2,d=this.spread,f=0,w=0;const v=[...this.preferredBiomes.value().getEntries()].flatMap(p=>{var S;return(S=p.key())!=null?S:[]});for(var m=0;m<this.count;m++){const p=4*this.distance+this.distance*f*6+(l.nextDouble()-.5)*this.distance*2.5,S=Math.round(Math.cos(h)*p),E=Math.round(Math.sin(h)*p),y=(S<<4)+8,x=(E<<4)+8,A=l.fork(),I=()=>{const R=u.BiomeSource.findBiomeHorizontal(o,y,0,x,r,C=>v.findIndex(M=>M.equals(C))>=0,A,g);return R?[R.pos[0]>>4,R.pos[2]>>4]:[S,E]};this.positions.push({center:[S,E],real:I}),h+=Math.PI*2/d,w++,w==d&&(f++,w=0,d+=2*d/(f+1),d=Math.min(d,this.count-m),h+=l.nextDouble()*Math.PI*2)}}isPlacementChunk(o,g,c){return this.positions===void 0?(console.warn("trying to access concentric rings placement before position calculation"),!1):this.getPotentialStructureChunks(o,g,c,g,c).findIndex(l=>l[0]===g&&l[1]===c)>=0}getPotentialStructureChunks(o,g,c,l,h){if(this.positions===void 0)return console.warn("trying to access concentric rings placement before position calculation"),[];const d=[];for(const f of this.positions)f.center[0]<g-(r>>4)||f.center[0]>l+(r>>4)||f.center[1]<c-(r>>4)||f.center[1]>h+(r>>4)||(f.real instanceof Function&&(f.real=f.real()),d.push(f.real));return d}}n.ConcentricRingsStructurePlacement=i})(Jt||(Jt={})),u.BlendedNoise=qs,u.BlockColors=Je,u.BlockDefinition=ri,u.BlockModel=ct,u.BlockState=X,u.CheckerboardBiomeSource=dr,u.Chunk=il,u.ChunkBuilder=Ws,u.ChunkSection=je,u.DensityFunction=q,u.EFFECT_COLORS=Ls,u.FixedBiomeSource=tn,u.FluidStatus=Tn,u.HolderSet=_e,u.Identifier=B,u.ImprovedNoise=ni,u.ItemRenderer=fr,u.ItemStack=qt,u.LegacyPositionalRandom=Vs,u.LegacyRandom=at,u.Line=ur,u.Matrix3=Cn,u.Matrix4=or,u.Mesh=it,u.MultiNoiseBiomeSource=gr,u.NbtAbstractList=kn,u.NbtByte=Pt,u.NbtByteArray=me,u.NbtChunk=ee,u.NbtCompound=mt,u.NbtDouble=ne,u.NbtEnd=An,u.NbtFile=Yt,u.NbtFloat=Te,u.NbtInt=Ft,u.NbtIntArray=we,u.NbtList=xt,u.NbtLong=Le,u.NbtLongArray=pe,u.NbtRegion=ve,u.NbtShort=Pe,u.NbtString=bt,u.NbtTag=et,u.NbtType=D,u.NoiseAquifer=Fe,u.NoiseChunk=ai,u.NoiseChunkGenerator=Qs,u.NormalNoise=ae,u.POTION_EFFECTS=Ps,u.PalettedContainer=Ts,u.PerlinNoise=_t,u.PerlinSimplexNoise=Yl,u.Quad=Xt,u.RandomState=ta,u.RawDataInput=ui,u.RawDataOutput=hi,u.Registry=Ct,u.Renderer=hr,u.ShaderProgram=Nn,u.SimplexNoise=pt,u.StringReader=It,u.Structure=re,u.StructurePlacement=Jt,u.StructurePoolElement=Ht,u.StructureRenderer=Eu,u.StructureSet=He,u.StructureTemplatePool=Ue,u.SurfaceContext=Ks,u.SurfaceSystem=js,u.TextureAtlas=Bn,u.Vector=Y,u.Vertex=Ot,u.VoxelRenderer=Au,u.WorldgenStructure=mr,u.XoroshiroPositionalRandom=Ys,u.XoroshiroRandom=rt,u.binarySearch=Ds,u.clamp=yt,u.clampedLerp=er,u.clampedMap=qr,u.computeIfAbsent=Ie,u.floatLerp=$r,u.getSeed=Wr,u.intFloor=Wt,u.inverseLerp=Yr,u.isPowerOfTwo=Xr,u.jsonToNbt=Gr,u.lazy=an,u.lazyLerp=Mn,u.lazyLerp2=Vr,u.lazyLerp3=Js,u.lerp=Oe,u.lerp2=tr,u.lerp3=Os,u.longFloor=zs,u.longfromBytes=rr,u.map=Rn,u.mutateWithDefault=vr,u.nextInt=sr,u.randomBetweenInclusive=ir,u.shuffle=Us,u.smoothstep=nr,u.square=ie,u.upperPowerOfTwo=Fs,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
